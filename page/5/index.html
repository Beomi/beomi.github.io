<!DOCTYPE html>
<html  lang="ko">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Beomi&#39;s Tech blog</title>








<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89162642-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-89162642-1');
</script>

    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    


<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="is-3-column">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                Beomi&#39;s Tech Blog
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="https://junbuml.ee">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/29/HowToMakeWebCrawler-ImplicitWait-vs-ExplicitWait/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/Selenium_Implicitly_wait_vs_Explicitly_wait.png" alt="Selenium Implicitly wait vs Explicitly wait">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-28T15:00:00.000Z">2017-10-29</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/howtomakewebcrawler/">howtomakewebcrawler</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/29/HowToMakeWebCrawler-ImplicitWait-vs-ExplicitWait/">Selenium Implicitly wait vs Explicitly wait</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>좀 더 보기 편한 <a href="https://beomi.github.io/gb-crawling/">깃북 버전의 나만의 웹 크롤러 만들기</a>가 나왔습니다!</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>Selenium WebDriver를 이용해 실제 브라우저를 동작시켜 크롤링을 진행할 때 가끔가다보면 <code>NoSuchElementException</code>라는 에러가 나는 경우를 볼 수 있습니다.</p>
<p>가장 대표적인 사례가 바로 JS를 통해 동적으로 HTML 구조가 변하는 경우인데요, 만약 사이트를 로딩한 직후에(JS처리가 끝나지 않은 상태에서) JS로 그려지는 HTML 엘리먼트를 가져오려고 하는 경우가 대표적인 사례입니다. (즉, 아직 그리지도 않은 요소를 가져오려고 했기 때문에 생기는 문제인 것이죠.)</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-10-22%2023.39.57.png" alt=""></p>
<p>그래서 크롤링 코드를 작성할 때 크게 두가지 방법으로 브라우저가 HTML Element를 기다리도록 만들어 줄 수 있습니다.</p>
<h2 id="Implicitly-wait"><a href="#Implicitly-wait" class="headerlink" title="Implicitly wait"></a>Implicitly wait</h2><p>Selenium에서 브라우저 자체가 웹 요소들을 기다리도록 만들어주는 옵션이 <code>Implicitly Wait</code>입니다.</p>
<p>아래와 같은 형태로 카카오뱅크 타이틀을 한번 가져와 봅시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># driver를 만든 후 implicitly_wait 값(초단위)을 넣어주세요.</span></span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'https://www.kakaobank.com/'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 하나만 찾기</span></span><br><span class="line">title = driver.find_element_by_css_selector(<span class="string">'div.intro_main &gt; h3'</span>)</span><br><span class="line"><span class="comment"># 여러개 찾기</span></span><br><span class="line">small_titles = driver.find_elements_by_css_selector(<span class="string">'div.cont_txt &gt; h3'</span>)</span><br><span class="line"></span><br><span class="line">print(title.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> small_titles:</span><br><span class="line">    print(t.text)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>위 코드를 실행하면 여러분이 <code>.get()</code>으로 지정해준 URL을 가져올 때 각 HTML요소(Element)가 나타날 때 까지 최대 3초까지 ‘관용있게’ 기다려 줍니다.</p>
<p>즉, 여러분이 <code>find_element_by_css_selector</code>와 같은 방식으로 HTML엘리먼트를 찾을 때 만약 요소가 없다면 요소가 없다는 <code>No Such Element</code>와 같은 Exception을 발생시키기 전 모든 시도에서 3초를 기다려 주는 것이죠.</p>
<p>하지만 이런 방식은 만약 여러분이 크롤링하려는 웹이 ajax를 통해 HTML 구조를 동적으로 바꾸고 있다면 과연 ‘3초’가 적절한 값일지에 대해 고민을 하게 만듭니다.(모든 ajax가 진짜로 3초 안에 이루어질까요?)</p>
<p>그래서 우리는 조금 더 발전된 기다리는 방식인 Explicitly wait을 사용하게 됩니다.</p>
<blockquote>
<p>NOTE: 기본적으로 Implicitly wait의 값은 0초입니다. 즉, 요소를 찾는 코드를 실행시킨 때 요소가 없다면 전혀 기다리지 않고 Exception을 raise하는 것이죠.</p>
</blockquote>
<h2 id="Explicitly-wait"><a href="#Explicitly-wait" class="headerlink" title="Explicitly wait"></a>Explicitly wait</h2><p>자, 여러분이 인터넷 웹 사이트를 크롤링하는데 ajax를 통해 HTML 구조가 변하는 상황이고, 각 요소가 들어오는 시간은 몇 초가 될지는 예상할 수 없다고 가정해 봅시다.</p>
<p>위에서 설정해 준 대로 implicitly_wait을 이용했다면 어떤 특정한 상황(인터넷이 유독 느렸음)으로 인해 느려진 경우 우리가 평소에 기대했던 3초(n초)를 넘어간 경우 Exception이 발생할 것이고 이로 인해 반복적인 크롤링 작업을 진행할 때 문제가 생길 수 있습니다.</p>
<p>따라서 우리는 명확하게 특정 Element가 나타날 때 까지 기다려주는 방식인 Explicitly Wait을 사용할 수 있습니다.</p>
<p>아래 코드는 위에서 Implicitly wait을 통해 사용했던 암묵적 대기(<code>get_element_by_id</code> 등)을 사용한 대신 명시적으로 <code>div.intro_main &gt; h3</code>라는 CSS Selector로 가져오는 부분입니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="comment"># 아래 코드들을 import 해 줍시다.</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="comment"># WebDriverWait는 Selenium 2.4.0 이후 부터 사용 가능합니다.</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="comment"># expected_conditions는 Selenium 2.26.0 이후 부터 사용 가능합니다.</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'https://www.kakaobank.com/'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># WebDriverWait와 .until 옵션을 통해 우리가 찾고자 하는 HTML 요소를</span></span><br><span class="line">    <span class="comment"># 기다려 줄 수 있습니다.</span></span><br><span class="line">    title = WebDriverWait(driver, <span class="number">10</span>) \</span><br><span class="line">        .until(EC.presence_of_element_located((By.CSS_SELECTOR, <span class="string">"div.intro_main &gt; h3"</span>)))</span><br><span class="line">    print(title.text)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>

<p>위 코드를 사용하면 우리가 찾으려는 대상을 driver가 명시적으로 ‘10초’를 기다리도록 만들어 줄 수 있습니다.</p>
<h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><p>만약 여러분이 ajax를 사용하지 않는 웹 사이트에서 단순하게 DOM구조만 변경되는 상황이라면 사실 Explicitly wait을 사용하지 않아도 괜찮을 가능성이 높습니다. (DOM API처리속도는 굉장히 빠릅니다.)</p>
<p>하지만 최신 웹 사이트들은 대부분 ajax요청을 통해 웹 구조를 바꾸는 SPA(Single Page App)이 많기 때문에 크롤링을 진행할 때 Explicitly wait을 이용하는 것이 좋습니다.</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/21/SQLAlchemy-Query-to-Pandas-DataFrame/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-10-21-SQLAlchemy-Query-to-Pandas-DataFrame.png" alt="SQLAlchemy Query를 Pandas DataFrame로 만들기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-20T15:00:00.000Z">2017-10-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/flask/">flask</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/flask/sqlalchemy/">sqlalchemy</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/flask/sqlalchemy/pandas/">pandas</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/flask/sqlalchemy/pandas/tips/">tips</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/21/SQLAlchemy-Query-to-Pandas-DataFrame/">SQLAlchemy Query를 Pandas DataFrame로 만들기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 글은 <a href="/2017/10/20/DB-To-SQLAlchemy-Model/">기존 DB를 Flask-SQLAlchemy ORM Model로 사용하기</a>를 보고 오시면 좀더 빠르게 실 프로젝트에 적용이 가능합니다.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><blockquote>
<p>전체 예시를 보시려면 <a href="#tldr">TL;DR</a>를 참고하세요.</p>
</blockquote>
<p>DB에 있는 정보를 파이썬 코드 속에서 SQL raw Query를 통해 정보를 가져오는 아래와 같은 코드의 형태는 대다수의 언어에서 지원합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 굳이 sqlite3이 아닌 다른 MySQL와 같은 DB의 connect를 이뤄도 상관없습니다.</span></span><br><span class="line"><span class="comment"># 여기서는 파이썬 파일과 같은 위치에 blog.sqlite3 파일이 있다고 가정합니다.</span></span><br><span class="line">conn = sqlite3.connect(<span class="string">"blog.sqlite3"</span>) </span><br><span class="line">cur = conn.cursor()</span><br><span class="line">cur.execute(<span class="string">"select * from post where id &lt; 10;"</span>)</span><br></pre></td></tr></table></figure>

<p>위와 같은 형식으로 코드를 사용할 경우 웹이 이루어지는 과정 중 2~3번째 과정인 “SQL쿼리 요청하기”와 “데이터 받기”라는 부분을 수동으로 처리해 줘야 하는 부분이 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/noun/how_web_works_DB_SQL.jpeg" alt=""></p>
<p>이런 경우 파이썬 파일이더라도 한 파일 안에 두개의 언어를 사용하게 되는 셈입니다. (python와 SQL)</p>
<p>만약 여러분이 Pandas DataFrame객체를 DB에서 가져와 만들려면 이런 문제가 생깁니다.</p>
<ul>
<li>DB에 연결을 구성해야 함</li>
<li>가져온 데이터를 데이터 타입에 맞춰 파이썬이 이해하는 형태로 변환</li>
<li>정리한 데이터를 Pandas로 불러오기</li>
</ul>
<p>음, 보기만 해도 상당히 귀찮네요.</p>
<h2 id="설치하기"><a href="#설치하기" class="headerlink" title="설치하기"></a>설치하기</h2><p>우선 필요한 패키지들을 먼저 설치해 줍시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install flask</span><br><span class="line">pip install Flask-SQLAlchemy</span><br><span class="line">pip install pandas</span><br></pre></td></tr></table></figure>

<h2 id="Pandas로-SQL요청하기"><a href="#Pandas로-SQL요청하기" class="headerlink" title="Pandas로 SQL요청하기"></a>Pandas로 SQL요청하기</h2><p>Pandas에서는 이런 귀찮은 점을 보완해 주기 위해 <code>read_sql_query</code>라는 함수를 제공합니다. 위 코드를 조금 바꿔봅시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># NoQA</span></span><br><span class="line"></span><br><span class="line">conn = sqlite3.connect(<span class="string">"blog.sqlite3"</span>)</span><br><span class="line"><span class="comment"># 이 부분을 삭제</span></span><br><span class="line"><span class="comment"># cur = conn.cursor()</span></span><br><span class="line"><span class="comment"># cur.execute("select * from post where id &lt; 10;")</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 아래 부분을 추가</span></span><br><span class="line">df = pd.read_sql_query(<span class="string">"select * from post where id &lt; 10;"</span>, conn)</span><br><span class="line"><span class="comment"># df는 이제 Pandas Dataframe 객체</span></span><br></pre></td></tr></table></figure>

<p>단순하게 DB 커넥션, 그리고 <code>read_sql_query</code>만으로 SQL Query를 바로 Pandas DataFrame 객체로 받아왔습니다. 이제 데이터를 수정하고 가공하는 처리는 Pandas에게 맡기면 되겠군요!</p>
<p>하지만, 여전히 우리는 SQL을 짜고있어요. 복잡한 쿼리라면 몰라도, 단순한 쿼리를 이렇게까지 할 필요가 있을까요?</p>
<h2 id="SQLAlchemy-모델-이용하기"><a href="#SQLAlchemy-모델-이용하기" class="headerlink" title="SQLAlchemy 모델 이용하기"></a>SQLAlchemy 모델 이용하기</h2><p>Flask를 사용할때 많이 쓰는 SQLAlchemy는 ORM으로 수많은 DB를 파이썬만으로 제어하도록 도와줍니다. 그리고 이 점이 우리가 SQL을 SQLAlchemy를 통해 바로 만들 수 있도록 도와줍니다.</p>
<blockquote>
<p>NOTE: 이번 글에서는 Flask-SQLAlchemy 패키지를 사용합니다. SQLAlchemy와는 약간 다르게 동작할 수도 있습니다.</p>
</blockquote>
<h3 id="모델-클래스-만들기"><a href="#모델-클래스-만들기" class="headerlink" title="모델 클래스 만들기"></a>모델 클래스 만들기</h3><p>모델 클래스를 기존 DB를 참조해 만드는 것은 <a href="/2017/10/20/DB-To-SQLAlchemy-Model/">기존 DB를 Flask-SQLAlchemy ORM Model로 사용하기</a> 를 참고하세요.</p>
<h3 id="예제-모델-Post"><a href="#예제-모델-Post" class="headerlink" title="예제 모델: Post"></a>예제 모델: Post</h3><p>블로그에서 자주 쓸 법한 <code>Post</code>라는 이름의 모델 클래스를 하나 만들어 봅시다.</p>
<p>우선 <code>SQLAlchemy</code>를 <code>flask_sqlalchemy</code>에서 import 해옵시다. 그리고 Flask도 가져와 <code>app</code>을 만들어 줍시다. 그리고 <code>db</code>객체를 만들어줍시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, jsonify</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># 현재 경로의 blog.sqlite3을 불러오기</span></span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///blog.sqlite3'</span></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    content = db.Column(db.Text)</span><br><span class="line">    pub_date = db.Column(db.DateTime, nullable=<span class="literal">False</span>, default=datetime.utcnow)</span><br></pre></td></tr></table></figure>

<p>자, 이제 여러분은 <code>blog.sqlite3</code>파일 안에 <code>post</code>라는 테이블에 값들을 넣거나 뺄 수 있게 되었습니다.</p>
<h3 id="루트-View-만들기"><a href="#루트-View-만들기" class="headerlink" title="루트 View 만들기"></a>루트 View 만들기</h3><p>여러분이 app.run( ) 으로 Flask 개발 서버를 띄웠을 때 첫 화면(‘/‘ URL에서) 실행될 View 함수(<code>post_all</code>)를 만들어줍시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, jsonify</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///blog.sqlite3'</span></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    content = db.Column(db.Text)</span><br><span class="line">    pub_date = db.Column(db.DateTime, nullable=<span class="literal">False</span>, default=datetime.utcnow)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 아래 줄을 추가해 줍시다.</span></span><br><span class="line"><span class="comment"># List post which id is less then 10</span></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_all</span><span class="params">()</span>:</span></span><br><span class="line">    df = pd.read_sql_query(<span class="string">"select * from post where id &lt; 10;"</span>, db.session.bind).to_json()</span><br><span class="line">    <span class="keyword">return</span> jsonify(json.loads(df))</span><br></pre></td></tr></table></figure>

<p>자, 분명히 ORM을 쓰는데도 아직 SQL 쿼리를 쓰고있네요! SQL쿼리문을 지워버립시다!</p>
<h3 id="queryset-객체를-만들기"><a href="#queryset-객체를-만들기" class="headerlink" title="queryset 객체를 만들기"></a>queryset 객체를 만들기</h3><p>우리는 <code>Post</code>라는 모델을 만들어줬으니 이제 <code>Post</code>객체의 <code>.query</code>와 <code>.filter()</code>를 통해 객체들을 가져와 봅시다.</p>
<p>우선 <code>queryset</code>라는 이름에 넣어줍시다. 그리고 Pandas의 <code>read_sql</code>(유의: <code>read_sql_query</code>가 아닙니다.)에 <code>queryset</code>의 내용과 세션을 넘겨줘 DataFrame 객체로 만들어줍시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, jsonify</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///blog.sqlite3'</span></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    content = db.Column(db.Text)</span><br><span class="line">    pub_date = db.Column(db.DateTime, nullable=<span class="literal">False</span>, default=datetime.utcnow)</span><br><span class="line"></span><br><span class="line"><span class="comment"># List post which id is less then 10</span></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_all</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 이 줄은 지우고,</span></span><br><span class="line">    <span class="comment"># df = pd.read_sql_query("select * from post where id &lt; 10;", db.session.bind).to_json()</span></span><br><span class="line">    <span class="comment"># 아래 두줄을 추가해주세요.</span></span><br><span class="line">    queryset = Post.query.filter(Post.id &lt; <span class="number">10</span>)  <span class="comment"># SQLAlchemy가 만들어준 쿼리, 하지만 .all()이 없어 실행되지는 않음</span></span><br><span class="line">    df = pd.read_sql(queryset.statement, queryset.session.bind)  <span class="comment"># 진짜로 쿼리가 실행되고 DataFrame이 만들어짐</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(json.loads(df).to_json())</span><br></pre></td></tr></table></figure>

<p>자, 위와 같이 코드를 짜 주면 이제 SQLAlchemy ORM와 Pandas의 <code>read_sql</code>을 통해 <code>df</code>이 DataFrame 객체로 자연스럽게 가져오게 됩니다.</p>
<h2 id="정리하기"><a href="#정리하기" class="headerlink" title="정리하기"></a>정리하기</h2><p>여러분이 Pandas를 사용해 데이터를 분석하거나 정제하려 할 때 웹앱으로 Flask를 사용하고 ORM을 이용한다면, 굳이 SQL Query를 직접 만드는 대신 이처럼 Pandas와 SQLAlchemy의 강력한 조합을 이용해 보세요. 조금 더 효율적인 시스템 활용을 고려한 파이썬 프로그램이 나올거에요!</p>
<h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a><a name="tldr"></a>TL;DR</h2><p>아래 코드와 같이 모델을 만들고 <code>db</code> 객체를 만든 뒤 pandas의 <code>read_sql</code>을 사용하면 됩니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, jsonify</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">'sqlite:///blog.sqlite3'</span></span><br><span class="line">db = SQLAlchemy(app)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'post'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    content = db.Column(db.Text)</span><br><span class="line">    pub_date = db.Column(db.DateTime, nullable=<span class="literal">False</span>, default=datetime.utcnow)</span><br><span class="line"></span><br><span class="line"><span class="comment"># List post which id is less then 10</span></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post_all</span><span class="params">()</span>:</span></span><br><span class="line">    queryset = Post.query.filter(Post.id &lt; <span class="number">10</span>)  <span class="comment"># SQLAlchemy가 만들어준 쿼리, 하지만 .all()이 없어 실행되지는 않음</span></span><br><span class="line">    df = pd.read_sql(queryset.statement, queryset.session.bind)  <span class="comment"># 진짜로 쿼리가 실행되고 DataFrame이 만들어짐</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(json.loads(df).to_json())</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/20/DB-To-SQLAlchemy-Model/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-10-20-DB-To-SQLAlchemy-Model.jpeg" alt="기존 DB를 Flask-SQLAlchemy ORM Model로 사용하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-19T15:00:00.000Z">2017-10-20</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/flask/">flask</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/flask/sqlalchemy/">sqlalchemy</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/20/DB-To-SQLAlchemy-Model/">기존 DB를 Flask-SQLAlchemy ORM Model로 사용하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>본 게시글에서는 MySQL/Sqlite을 예제로 하고있지만, Flask-SQLAlchemy가 지원하는 다른 DB에서도 사용 가능합니다.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>Flask로 웹 개발 진행 시 SQLAlchemy(Flask-SQLAlchemy)를 사용해 ORM구조를 구성할 때 데이터를 저장할 DB의 구조를 직접 확인하며 진행하는 것은 상당히 귀찮고 어려운 일입니다.</p>
<p>Django에는 내장된 <code>inspectdb</code>라는 명령어를 통해 Django와 일치하는 DB Model구조를 만들어주지만 SQLAlchemy 자체에 내장된 <code>automap</code>은 우리가 상상하는 모델 구조를 바로 만들어주지는 않습니다.</p>
<p>따라서 다른 패키지를 고려해볼 필요가 있습니다.</p>
<h2 id="flask-sqlacodegen"><a href="#flask-sqlacodegen" class="headerlink" title="flask-sqlacodegen"></a>flask-sqlacodegen</h2><p><code>flask-sqlacodegen</code>은 기존 DB를 Flask-SQLAlchemy에서 사용하는 Model 형식으로 변환해 보여주는 패키지입니다. 기존 <code>sqlacodegen</code>에서 포크해 Flask-SQLAlchemy에 맞게 기본 설정이 갖추어져있어 편리합니다.</p>
<h2 id="설치하기"><a href="#설치하기" class="headerlink" title="설치하기"></a>설치하기</h2><p>설치는 <code>pip</code>로 간단하게 진행해 주세요.</p>
<blockquote>
<p>글쓰는 시점 최신버전은 1.1.6.1입니다.</p>
</blockquote>
<blockquote>
<p>글쓴것과 같은 버전으로 설치하려면 flask-sqlacodegen==1.1.6.1 로 설치해 주세요.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 최신 버전 설치하기</span></span><br><span class="line">pip install flask-sqlacodegen</span><br><span class="line"><span class="comment"># 글쓴 시점과 같게 설치하려면</span></span><br><span class="line"><span class="comment"># pip install flask-sqlacodegen==1.1.6.1</span></span><br></pre></td></tr></table></figure>

<p>설치가 완료되면 명령줄에서 <code>flask-sqlacodegen</code>라는 명령어를 사용할 수 있습니다.</p>
<blockquote>
<p>주의: <code>sqlacodegen</code>이 이미 깔려있다면 다른 가상환경(virtuale / venv)를 만드시고 진행해 주세요. <code>sqlacodegen</code>이 깔려있으면 <code>--flask</code>이 동작하지 않습니다.</p>
</blockquote>
<h2 id="DB-구조-뜯어내기"><a href="#DB-구조-뜯어내기" class="headerlink" title="DB 구조 뜯어내기"></a>DB 구조 뜯어내기</h2><p><code>flask-sqlacodegen</code>는 <code>sqlacodegen</code>과 거의 동일한 문법을 사용합니다.(포크를 뜬 프로젝트니까요!)</p>
<p><code>flask-sqlacodegen</code> 명령어로 DB를 지정하면 구조를 알 수 있습니다.</p>
<h3 id="SQLite의-경우"><a href="#SQLite의-경우" class="headerlink" title="SQLite의 경우"></a>SQLite의 경우</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-sqlacodegen <span class="string">"sqlite:///db.sqlite3"</span> --flask &gt; models.py <span class="comment"># 상대경로, 현재 위치의 db.sqlite3파일</span></span><br></pre></td></tr></table></figure>

<p>SQLite는 로컬에 있는 DB의 위치를 지정하면 됩니다.</p>
<p>위 명령어를 실행하면 <code>models.py</code>파일 안에 <code>db.sqlite3</code> DB의 모델이 정리됩니다.</p>
<blockquote>
<p>NOTE: Sqlite의 파일을 지정할 경우 “sqlite://“가 아닌 “sqlite:///“ 로 <code>/</code>를 3번 써주셔야 상대경로로 지정 가능하며, “sqlite:////“로 <code>/</code>를 4번 써주셔야 절대경로로 지정이 가능합니다.</p>
</blockquote>
<h3 id="mysql-서버의-경우"><a href="#mysql-서버의-경우" class="headerlink" title="mysql 서버의 경우"></a>mysql 서버의 경우</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-sqlacodegen <span class="string">"mysql://username:password@DB_IP/DB_NAME"</span> --flask &gt; models.py</span><br></pre></td></tr></table></figure>

<p>MySQL의 경우 mysql에 접속하는 방식 그대로 사용자 이름, 비밀번호, IP(혹은 HOST도메인), DB이름을 넣어준 뒤 진행해주면 됩니다.</p>
<blockquote>
<p>NOTE: mysql은 “mydql://“ 로 <code>/</code>가 2번입니다.</p>
</blockquote>
<blockquote>
<p>NOTE: mysql에 연결하려면 pip패키지 중 <code>mysqlclient</code>가 설치되어있어야 합니다.<br>설치가 되어있지 않으면 아래와 같이 <code>ModuleNotFoundError</code>가 발생합니다.<br><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-20%2012.21.08.png?dl=1" alt=""></p>
</blockquote>
<blockquote>
<p>MAC에서 진행 중 혹시 <code>mysqlclient</code>설치 중 아래와 같은 에러가 발생한다면<br><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-20%2012.23.07.png?dl=1" alt=""></p>
</blockquote>
<blockquote>
<p>아래 명령어를 실행해 <code>xcode cli developer tool</code>와 <code>openssl</code>을 설치해주신 후 <code>mysqlclient</code>를 설치해 주세요.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xcode-select --install</span><br><span class="line">brew install openssl</span><br><span class="line"><span class="built_in">export</span> LIBRARY_PATH=<span class="variable">$LIBRARY_PATH</span>:/usr/<span class="built_in">local</span>/opt/openssl/lib/</span><br><span class="line">pip install mysqlclient</span><br></pre></td></tr></table></figure>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-20%2012.25.22.png?dl=1" alt=""></p>
<h2 id="실행결과"><a href="#실행결과" class="headerlink" title="실행결과"></a>실행결과</h2><p>아래 결과는 장고 프로젝트를 생성하고 첫 <code>migrate</code>를 진행할 때 생기는 예시 <code>db.sqlite3</code>파일을     <code>flask-sqlacodegen</code>을 사용한 결과입니다.</p>
<p>Index, PK등을 잘 잡아주고 있는 모습을 볼 수 있습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># models.py 파일</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Boolean, Column, DateTime, ForeignKey, Index, Integer, String, Table, Text</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> relationship</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.sql.sqltypes <span class="keyword">import</span> NullType</span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">db = SQLAlchemy()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthGroup</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_group'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">80</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthGroupPermission</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_group_permissions'</span></span><br><span class="line">    __table_args__ = (</span><br><span class="line">        db.Index(<span class="string">'auth_group_permissions_group_id_permission_id_0cd325b0_uniq'</span>, <span class="string">'group_id'</span>, <span class="string">'permission_id'</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    group_id = db.Column(db.ForeignKey(<span class="string">'auth_group.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line">    permission_id = db.Column(db.ForeignKey(<span class="string">'auth_permission.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    group = db.relationship(<span class="string">'AuthGroup'</span>, primaryjoin=<span class="string">'AuthGroupPermission.group_id == AuthGroup.id'</span>, backref=<span class="string">'auth_group_permissions'</span>)</span><br><span class="line">    permission = db.relationship(<span class="string">'AuthPermission'</span>, primaryjoin=<span class="string">'AuthGroupPermission.permission_id == AuthPermission.id'</span>, backref=<span class="string">'auth_group_permissions'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthPermission</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_permission'</span></span><br><span class="line">    __table_args__ = (</span><br><span class="line">        db.Index(<span class="string">'auth_permission_content_type_id_codename_01ab375a_uniq'</span>, <span class="string">'content_type_id'</span>, <span class="string">'codename'</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    content_type_id = db.Column(db.ForeignKey(<span class="string">'django_content_type.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line">    codename = db.Column(db.String(<span class="number">100</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">255</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    content_type = db.relationship(<span class="string">'DjangoContentType'</span>, primaryjoin=<span class="string">'AuthPermission.content_type_id == DjangoContentType.id'</span>, backref=<span class="string">'auth_permissions'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthUser</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_user'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    password = db.Column(db.String(<span class="number">128</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    last_login = db.Column(db.DateTime)</span><br><span class="line">    is_superuser = db.Column(db.Boolean, nullable=<span class="literal">False</span>)</span><br><span class="line">    first_name = db.Column(db.String(<span class="number">30</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    last_name = db.Column(db.String(<span class="number">30</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    email = db.Column(db.String(<span class="number">254</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    is_staff = db.Column(db.Boolean, nullable=<span class="literal">False</span>)</span><br><span class="line">    is_active = db.Column(db.Boolean, nullable=<span class="literal">False</span>)</span><br><span class="line">    date_joined = db.Column(db.DateTime, nullable=<span class="literal">False</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">150</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthUserGroup</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_user_groups'</span></span><br><span class="line">    __table_args__ = (</span><br><span class="line">        db.Index(<span class="string">'auth_user_groups_user_id_group_id_94350c0c_uniq'</span>, <span class="string">'user_id'</span>, <span class="string">'group_id'</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    user_id = db.Column(db.ForeignKey(<span class="string">'auth_user.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line">    group_id = db.Column(db.ForeignKey(<span class="string">'auth_group.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    group = db.relationship(<span class="string">'AuthGroup'</span>, primaryjoin=<span class="string">'AuthUserGroup.group_id == AuthGroup.id'</span>, backref=<span class="string">'auth_user_groups'</span>)</span><br><span class="line">    user = db.relationship(<span class="string">'AuthUser'</span>, primaryjoin=<span class="string">'AuthUserGroup.user_id == AuthUser.id'</span>, backref=<span class="string">'auth_user_groups'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthUserUserPermission</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'auth_user_user_permissions'</span></span><br><span class="line">    __table_args__ = (</span><br><span class="line">        db.Index(<span class="string">'auth_user_user_permissions_user_id_permission_id_14a6b632_uniq'</span>, <span class="string">'user_id'</span>, <span class="string">'permission_id'</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    user_id = db.Column(db.ForeignKey(<span class="string">'auth_user.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line">    permission_id = db.Column(db.ForeignKey(<span class="string">'auth_permission.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    permission = db.relationship(<span class="string">'AuthPermission'</span>, primaryjoin=<span class="string">'AuthUserUserPermission.permission_id == AuthPermission.id'</span>, backref=<span class="string">'auth_user_user_permissions'</span>)</span><br><span class="line">    user = db.relationship(<span class="string">'AuthUser'</span>, primaryjoin=<span class="string">'AuthUserUserPermission.user_id == AuthUser.id'</span>, backref=<span class="string">'auth_user_user_permissions'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DjangoAdminLog</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'django_admin_log'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    object_id = db.Column(db.Text)</span><br><span class="line">    object_repr = db.Column(db.String(<span class="number">200</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    action_flag = db.Column(db.Integer, nullable=<span class="literal">False</span>)</span><br><span class="line">    change_message = db.Column(db.Text, nullable=<span class="literal">False</span>)</span><br><span class="line">    content_type_id = db.Column(db.ForeignKey(<span class="string">'django_content_type.id'</span>), index=<span class="literal">True</span>)</span><br><span class="line">    user_id = db.Column(db.ForeignKey(<span class="string">'auth_user.id'</span>), nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line">    action_time = db.Column(db.DateTime, nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    content_type = db.relationship(<span class="string">'DjangoContentType'</span>, primaryjoin=<span class="string">'DjangoAdminLog.content_type_id == DjangoContentType.id'</span>, backref=<span class="string">'django_admin_logs'</span>)</span><br><span class="line">    user = db.relationship(<span class="string">'AuthUser'</span>, primaryjoin=<span class="string">'DjangoAdminLog.user_id == AuthUser.id'</span>, backref=<span class="string">'django_admin_logs'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DjangoContentType</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'django_content_type'</span></span><br><span class="line">    __table_args__ = (</span><br><span class="line">        db.Index(<span class="string">'django_content_type_app_label_model_76bd3d3b_uniq'</span>, <span class="string">'app_label'</span>, <span class="string">'model'</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    app_label = db.Column(db.String(<span class="number">100</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    model = db.Column(db.String(<span class="number">100</span>), nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DjangoMigration</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'django_migrations'</span></span><br><span class="line"></span><br><span class="line">    id = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    app = db.Column(db.String(<span class="number">255</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">255</span>), nullable=<span class="literal">False</span>)</span><br><span class="line">    applied = db.Column(db.DateTime, nullable=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DjangoSession</span><span class="params">(db.Model)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'django_session'</span></span><br><span class="line"></span><br><span class="line">    session_key = db.Column(db.String(<span class="number">40</span>), primary_key=<span class="literal">True</span>)</span><br><span class="line">    session_data = db.Column(db.Text, nullable=<span class="literal">False</span>)</span><br><span class="line">    expire_date = db.Column(db.DateTime, nullable=<span class="literal">False</span>, index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t_sqlite_sequence = db.Table(</span><br><span class="line">    <span class="string">'sqlite_sequence'</span>,</span><br><span class="line">    db.Column(<span class="string">'name'</span>, db.NullType),</span><br><span class="line">    db.Column(<span class="string">'seq'</span>, db.NullType)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Flask의-app에-덧붙이기"><a href="#Flask의-app에-덧붙이기" class="headerlink" title="Flask의 app에 덧붙이기"></a>Flask의 app에 덧붙이기</h2><p>이렇게 만들어진 model은 다른 Extension과 동일하게 Flask app에 붙일 수 있습니다.</p>
<p><code>app.py</code>라는 파일을 하나 만들고 아래 내용으로 채워주세요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py (models.py와 같은 위치)</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> models <span class="comment"># models.py파일을 가져옵시다.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_app</span><span class="params">()</span>:</span></span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    app.config[<span class="string">'SQLALCHEMY_DATABASE_URI'</span>] = <span class="string">"mysql://username:password@DB_IP/DB_NAME"</span></span><br><span class="line">    models.db.init_app(app)</span><br><span class="line">    <span class="keyword">return</span> app</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    app = create_app()</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>

<p>앞서 만들어준 <code>models.py</code>파일을 가져와 <code>create_app</code> 함수를 통해 <code>app</code>을 lazy_loading해주는 과정을 통해 진행해 줄 수 있습니다.</p>
<h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><p>기존에 사용하던 DB를 Flask와 SqlAlchemy를 통해 ORM으로 이용해 좀 더 빠른 개발이 가능하다는 것은 큰 이점입니다. ORM에서 DB 생성을 하지 않더라도 이미 있는 DB를 ORM으로 관리하고 Flask 프로젝트에 바로 가져다 쓸 수 있다는 점이 좀 더 빠른 프로젝트 진행에 도움이 될거랍니다.</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/18/Setup-Babel-with-webpack/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/webpack-with-babel.jpg" alt="Webpack과 Babel로 최신 JavaScript 웹프론트 개발환경 만들기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-17T15:00:00.000Z">2017-10-18</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/javascript/">javascript</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/javascript/webpack/">webpack</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/18/Setup-Babel-with-webpack/">Webpack과 Babel로 최신 JavaScript 웹프론트 개발환경 만들기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 포스팅에서는 nodejs8.5.0, npm5.3.0 버전을 사용합니다.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>파이썬의 버전 2와 3이 다른 것은 누구나 알고 2017년인 오늘은 대부분 Python3버전을 이용해 프로젝트를 진행합니다. 하지만 자바스크립트에 버전이 있고 새로운 기능이 나온다 하더라도 이 기능을 바로 사용하는 경우는 드뭅니다. 물론 <code>node.js</code>를 이용한다면 자바스크립트의 새로운 버전의 기능을 바로바로 이용해볼 수 있지만 프론트엔드 웹 개발을 할 경우 새로 만들어진 자바스크립트의 기능을 사용하는 것은 상당히 어렵습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 이런 문법은 사용하지 못합니다.</span></span><br><span class="line"><span class="keyword">const</span> hello = <span class="string">'world'</span></span><br><span class="line"><span class="keyword">const</span> printHelloWorld = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(e)</span><br><span class="line">&#125;</span><br><span class="line">printHelloWorld(hello)</span><br></pre></td></tr></table></figure>

<p>가장 큰 차이는 실행 환경의 문제인데요, 우리가 자주 사용하는 크롬브라우저의 경우에는 자동업데이트 기능이 내장되어있어 일반 사용자가 크롬브라우저를 실행만 해도 최신 버전을 이용하지만, 인터넷 익스플로러나 사파리와 같은 경우에는 많은 사용자가 OS에 설치되어있던 버전 그대로를 이용합니다. 물론 이렇게 사용하는 것도 심각한 문제를 가져오지는 않지만, 구형 브라우저들은 새로운 자바스크립트를 이해하지 못하기 때문에 이 브라우저를 사용하는 사용자들은 새로운 자바스크립트로 개발된 웹 사이트를 접속할 경우 전혀 다르게 혹은 완전히 동작하지 않는 페이지를 볼 수 있기 때문에 많은 일반 사용자를 대상으로 하는 서비스의 경우 새 버전의 자바스크립트를 사용해 개발한다는 것이 상당히 모험적인 성향이 강합니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/es2017.png" alt="es2017"></p>
<p>글쓴 시점인 2017년 10월 최신 자바스크립트 버전은 <code>ES2017</code>로 <code>ES8</code>이라 불리는 버전입니다. 하지만 이건 정말 최신 버전의 자바스크립트이고, 중요한 변화가 등장한 버전이 2015년도에 발표된 <code>ES2015</code>, 다른 말로는 <code>ES6</code>이라고 불리는 자바스크립트입니다. 하지만 인터넷익스플로러를 포함한 대부분의 브라우저들이 지원하는 자바스크립트의 버전은 <code>ES5</code>로 이보다 한단계 낮은 버전을 사용합니다. 따라서 우리는 <code>ES6</code>혹은 그 이상 버전의 자바스크립트 코드들을 <code>ES5</code>의 아래 버전 자바스크립트로 변환해 사용하는 방법을 사용할 수 있습니다.</p>
<h2 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h2><p>여기서 바로 Babel이 등장합니다. Babel은 최신 자바스크립트를 <code>ES5</code>버전에서도 돌아갈 수 있도록 변환(Transpiling)해줍니다. 우리가 자바스크립트 최신 버전의 멋진 기능을 이용하는 동안, Babel이 다른 브라우저에서도 돌아갈 수 있도록 처리를 모두 해주는 것이죠!</p>
<blockquote>
<p>물론, Babel이 마법의 요술도구처럼 모든 최신 기능을 변환해주지는 못합니다. 하지만 아래 사진처럼 다양한 브라우저에 따라 최신 JavaScript문법 중 어떠 부분까지가 실행 가능한 범위인지 알려줍니다. <img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/babel_coverage.png" alt="Babel coverage"></p>
</blockquote>
<h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2><p><code>ES6</code>에서 새로 등장한 것 중 유용한 문법이 바로 <code>import .. from ..</code>구문입니다. 다른 언어에서의 <code>import</code>와 유사하게 경로(상대경로 혹은 절대경로)에서 js파일을 불러오는 방식으로 동작합니다.</p>
<p>예를들어 어떤 폴더 안에 <code>Profile.js</code>와 <code>index.js</code>파일이 있다고 생각해 봅시다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Profile</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name, email) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name</span><br><span class="line">        <span class="keyword">this</span>.email = email</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    hello() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Hello, <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>(<span class="subst">$&#123;<span class="keyword">this</span>.email&#125;</span>)`</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>하는일이라고는 <code>name</code>, <code>email</code>을 받는 것, 그리고 <code>hello</code>하는 함수밖에 없지만 우선 <code>Profile</code>이라는 class를 하나 만들었습니다.</p>
<p>여기서 <code>Profile</code> 클래스 앞에 <code>export</code>를 해 주었는데, <code>export</code>를 해 줘야 다른 파일에서 <code>import</code>가 가능합니다.</p>
<p>자, 아래와 같이 index.js파일을 하나 만들어 봅시다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; Profile &#125; <span class="keyword">from</span> <span class="string">'./Profile'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pf = <span class="keyword">new</span> Profile(<span class="string">'Beomi'</span>, <span class="string">'jun@beomi.net'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(pf.hello())</span><br></pre></td></tr></table></figure>

<p>이 파일은 현재 경로의 <code>Profile.js</code>파일 중 <code>Profile</code> 클래스를 import해와 새로운 인스턴스를 만들어 사용합니다.</p>
<p>하지만 안타깝게도 이 <code>index.js</code>파일은 실행되지 않습니다. 아직 <code>webpack</code>으로 처리를 해주지 않았기 때문이죠!</p>
<h2 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h2><p>webpack은 파일을 모아 하나의 js파일로 만들어줍니다.(보통 <code>bundle.js</code>라는 이름을 많이 씁니다.) 하지만 실제 개발중 js파일을 수정할 때마다 Webpack을 실행해 번들작업을 해준다면 시간도 많이 걸리고 매우 귀찮습니다. 이를 보완해 주는 패키지가 바로 <code>webpack-dev-server</code> 인데요, 이 패키지를 사용하면 여러분이 실제 빌드를 해 <code>bundle.js</code>파일을 만들지 않아도 메모리 상에 가상의 <code>bundle.js</code>파일을 만들어 여러분이 웹 사이트를 띄울때 자동으로 번들된 js파일을 띄워줍니다. 그리고 소스가 수정될 때 마다 업데이트된(번들링된) <code>bundle.js</code>파일로 띄워주고 화면도 새로고침해줍니다!</p>
<blockquote>
<p>NOTE: webpack-dev-server는 <code>build</code>를 자동으로 해주는 것은 아닙니다. 단지 미리 지정해둔 경로로 접근할 경우 (실제로는 파일이 없지만) <code>bundle.js</code>파일이 있는 것처럼 파일을 보내주는 역할을 맡습니다. 개발이 끝나고 실제 서버에 배포할때는 이 패키지 대신 실제 webpack을 통해 빌드 작업을 거친 최종 결과물을 서버에 올려야 합니다.</p>
</blockquote>
<h2 id="설치하기"><a href="#설치하기" class="headerlink" title="설치하기"></a>설치하기</h2><p>우선 <code>npm</code>프로젝트를 생성해야 합니다. <code>index.js</code>파일을 만든 곳(어떤 폴더) 안에서 다음 명령어로 “이 폴더는 npm프로젝트를 이용하는 프로젝트다” 라는걸 알려주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -y 인자를 붙이면 모든 설정이 기본값으로 됩니다.</span></span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2010.23.18.png?dl=1" alt=""></p>
<p>이 명령어를 치면 폴더 안에 <code>package.json</code>파일이 생성되었을 거에요.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2010.23.52.png?dl=1" alt=""></p>
<p>이제 다음 명령어로 Babel과 webpack등을 설치해 봅시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># babel과 webpack은 개발환경에서 필요하기 때문에 --save-dev로 사용합니다.</span></span><br><span class="line">npm install --save-dev babel-loader babel-core babel-preset-env</span><br><span class="line">npm install --save-dev webpack webpack-dev-server</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2010.25.30.png?dl=1" alt=""></p>
<p><code>babel-loader</code>는 <code>webpack</code>이 .js 파일들에 대해 babel을 실행하도록 만들어주고, <code>babel-core</code>는 babel이 실제 동작하는 코드이고, <code>babel-preset-env</code>는 babel이 동작할 때 지원범위가 어느정도까지 되어야 하는지에 대해 지정하도록 만들어주는 패키지입니다.</p>
<p>이렇게 설치를 진행하고 나면 Babel과 Webpack을 사용할 준비를 마친셈입니다.</p>
<blockquote>
<p>NOTE: <code>package.json</code>뿐 아니라 <code>package-lock.json</code>파일도 함께 생길수 있습니다. 이 파일은 npm패키지들이 각각 수많은 의존성을 가지고 있기 때문에 의존성 패키지들을 다운받는 URL을 미리 모아둬 다른 컴퓨터에서 <code>package.json</code>을 통해 <code>npm install</code>로 패키지들을 설치시 훨씬 빠른 속도로 패키지를 받을 수 있도록 도와줍니다.</p>
</blockquote>
<p>이제 설정파일 몇개를 만들고 수정해줘야 해요.</p>
<h2 id="설정파일-건드리기"><a href="#설정파일-건드리기" class="headerlink" title="설정파일 건드리기"></a>설정파일 건드리기</h2><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><p><code>package.json</code>파일은 파이썬 pip의 <code>requirements.txt</code>처럼 패키지버전 관리만 해주는 것이 아니라 npm와 결합해 특정 명령어를 실행하거나 npm 프로젝트의 환경을 담는 파일입니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run 명령어이름</span><br></pre></td></tr></table></figure>

<p>위와 같은 명령어를 사용할 수 있도록 만들어 주기도 합니다.</p>
<p>현재 <code>package.json</code>파일은 아래와 같은 형태로 되어있을거에요.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"npm_blog"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"babel-core"</span>: <span class="string">"^6.26.0"</span>,</span><br><span class="line">    <span class="attr">"babel-loader"</span>: <span class="string">"^7.1.2"</span>,</span><br><span class="line">    <span class="attr">"babel-preset-env"</span>: <span class="string">"^1.6.1"</span>,</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^3.8.1"</span>,</span><br><span class="line">	<span class="attr">"webpack-dev-server"</span>: <span class="string">"^2.9.2"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이제 <code>package.json</code>파일을 열어 <code>&quot;scripts&quot;</code>부분을 다음과 같이 <code>build</code>와 <code>devserver</code>명령어를 추가해 줍시다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"npm_blog"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack"</span>,</span><br><span class="line">    <span class="attr">"devserver"</span>: <span class="string">"webpack-dev-server --open --progress"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"babel-core"</span>: <span class="string">"^6.26.0"</span>,</span><br><span class="line">    <span class="attr">"babel-loader"</span>: <span class="string">"^7.1.2"</span>,</span><br><span class="line">    <span class="attr">"babel-preset-env"</span>: <span class="string">"^1.6.1"</span>,</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^3.8.1"</span>,</span><br><span class="line">    <span class="attr">"webpack-dev-server"</span>: <span class="string">"^2.9.2"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이제 여러분이 <code>npm run build</code>를 할 때는 <code>webpack</code>이 실행되고, <code>npm run devserver</code>를 할 때는 개발용 서버가 띄워질거에요.</p>
<h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><p><code>webpack.config.js</code> 파일은 앞서 설치해준 <code>webpack</code>을 실행 시 어떤 옵션을 사용할지 지정해주는 js파일입니다.</p>
<p>우리 프로젝트 폴더에는 아직 <code>webpack.config.js</code> 파일이 없을거에요. <code>package.json</code>와 같은 위치에 <code>webpack.config.js</code>파일을 새로 만들어 아래 내용으로 채워줍시다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        publicPath: <span class="string">'/dist/'</span>,</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                include: path.join(__dirname),</span><br><span class="line">                exclude: <span class="regexp">/(node_modules)|(dist)/</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        presets: [<span class="string">'env'</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>위 파일은 <code>entry</code>에 현재 위치의 <code>index.js</code>파일을 들어가 모든 <code>import</code>를 찾아오고, <code>module -&gt; rules -&gt; include</code>에 있는 <code>.js</code>로 된 모든 파일을 babel로 처리해줍니다.(<code>exclue</code>에 있는 부분인 <code>node_modules</code>폴더와 <code>dist</code>폴더는 제외합니다.)</p>
<h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><p>사실 우리는 아직 번들링된 js파일을 보여줄 HTML파일이 없습니다! 우선 <code>bundle.js</code>를 보여주기만 할 단순한 HTML파일을 하나 만들어 봅시다.(<code>index.js</code>와 같은 위치)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>NPM Webpack<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    Webpack용 HTML</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/dist/bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>webpack을 사용하지 않았다면 HTML파일 아래 <code>script</code>태그의 src에 index.js를 넣어야 하지만, 우리는 webpack과 webpack-dev-server를 사용하기때문에 번들링된 파일의 위치인 <code>/dist/bundle.js</code>을 넣어줍니다.</p>
<h2 id="devserver-띄우기"><a href="#devserver-띄우기" class="headerlink" title="devserver 띄우기"></a>devserver 띄우기</h2><p>자, 이제 아래 명령어로 devserver를 띄워봅시다!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run devserver</span><br></pre></td></tr></table></figure>

<p>브라우저의 개발자 도구를 열어보면 아래와 같이 로그가 잘 찍힌걸 확인해 볼 수 있을거에요.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2010.56.16.png?dl=1" alt=""></p>
<p>이제 여러분이 <code>index.js</code>파일이나 <code>Profile.js</code>등을 수정하면 곧바로 새로고침되고 새로운 <code>bundle.js</code>를 라이브로 불러올거에요.</p>
<h2 id="배포용으로-만들기"><a href="#배포용으로-만들기" class="headerlink" title="배포용으로 만들기"></a>배포용으로 만들기</h2><p>여러분이 프로젝트 개발을 끝내고 실제 서버에 배포할 때는 devserver가 아니라 실제로 번들링된 파일인 <code>bundle.js</code>를 만들어야 합니다.</p>
<p>아래 명령어로 현재 위치의 <code>dist</code>폴더 안에 <code>bundle.js</code> 파일을 만들어 줍시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2010.59.35.png?dl=1" alt=""></p>
<p>위와 같이 나온다면 성공적으로 webpack이 마쳐진 것이랍니다! 그리고 여러분 프로젝트 폴더 안에 <code>dist</code>폴더가 생기고 그 안에 <code>bundle.js</code>파일이 생겼을 거에요.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-10-19%2011.00.42.png?dl=1" alt=""></p>
<p>이제 여러분은 <code>index.html</code>파일과 <code>dist</code>폴더를 묶어 서버에 올리면 페이지가 잘 동작하는것을 확인할 수 있을거에요!</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/17/Deploy-Flask-with-Fabric/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/deploy_flask_with_fabric.jpeg" alt="Fabric으로 Flask 자동 배포하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-10-16T15:00:00.000Z">2017-10-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/flask/">flask</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/flask/fabric/">fabric</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/17/Deploy-Flask-with-Fabric/">Fabric으로 Flask 자동 배포하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 글은 Ubuntu16.04 LTS / Python3 / Apache2.4 서버 환경으로 진행합니다.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>플라스크를 서버에 배포하는 것은 장고 배포와는 약간 다릅니다. 기본적으로 Apache2를 사용하기 때문에 <code>mod_wsgi</code>를 사용하는 것은 동일하지만, 그 외 다른 점이 조금 있습니다.</p>
<p>우선 간단한 플라스크 앱 하나가 있다고 생각을 해봅시다. 가장 단순한 형태는 아래와 같이 루트로 접속시 <code>Hello world!</code>를 보여주는 것이죠.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__file__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hello world!"</span></span><br></pre></td></tr></table></figure>

<p>물론 여러분이 실제로 만들고 썼을 프로젝트는 이것보다 훨씬 복잡하겠지만, 일단은 이걸로 시작은 할 수 있답니다.</p>
<h2 id="wsgi-py-파일-만들기"><a href="#wsgi-py-파일-만들기" class="headerlink" title="wsgi.py 파일 만들기"></a>wsgi.py 파일 만들기</h2><p>로컬에서 <code>app.run()</code> 을 통해 실행했던 테스트서버와는 달리 실 배포 상황에서는 Apache나 NginX와 같은 웹서버를 거쳐 웹을 구동하고, 따라서 <code>app.run()</code>의 방식은 더이상 사용할 수 없습니다. 대신 여러가지 웹서버와 Flask를 연결시켜주는 방법이 있는데, 이번엔 그 중 <code>wsgi</code>를 통해 Apache서버가 Flask 앱을 실행하도록 만들어줄 것이랍니다.</p>
<p>우선 <code>wsgi.py</code>파일을 하나 만들어야 합니다. 이 파일은 나중에 Apache서버가 이 파일을 실행시켜 Flask서버를 구동하게 됩니다. 그리고 이 파일은 위에서 만든 변수인 <code>app = Flask(__file__)</code>, 즉 <code>app</code>변수를 import할 수 있는 위치에 있어야 합니다. (<code>app.py</code>파일과 동일한 위치에 두면 무방합니다.)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wsgi.py # app.py와 같은 위치</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">CURRENT_DIR = os.getcwd()</span><br><span class="line"></span><br><span class="line">sys.stdout = sys.stderr</span><br><span class="line">sys.path.insert(<span class="number">0</span>, CURRENT_DIR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app <span class="keyword">as</span> application</span><br></pre></td></tr></table></figure>

<p>우리가 <code>wsgi</code>를 통해 실행할 경우 프로그램은 <code>application</code>이라는 변수를 찾아 <code>run()</code>와 비슷한 명령을 실행해 서버를 구동합니다. 따라서 우리는 <code>wsgi.py</code>파일 내 <code>application</code>이라는 변수를 만들어줘야 하는데, 이 변수는 바로 <code>app.py</code>내의 <code>app</code>변수입니다. </p>
<p>위 코드를 보시면 <code>sys</code>모듈과 <code>os</code>모듈을 사용합니다. <code>os</code>모듈의 <code>getcwd()</code>함수를 통해 현재 파일의 위치를 시스템의 <code>PATH</code> 경로에 넣어줍니다. 이 줄을 통해 바로 아래에 있는 <code>from app import app</code>이라는 구문에서 <code>from app</code> 부분이 현재 <code>wsgi.py</code>파일의 경로에서 <code>app.py</code>를 import할 수 있게 되는 것이죠. 만약 이 줄이 빠져있다면 <code>ImportError</code>가 발생하며 <code>app</code>이라는 모듈을 찾을 수 없다는 익셉션이 발생합니다.</p>
<h2 id="Fabric3-설치하기"><a href="#Fabric3-설치하기" class="headerlink" title="Fabric3 설치하기"></a>Fabric3 설치하기</h2><p>Fabric3은 Python2만 지원하던 <code>fabric</code>프로젝트를 포크해 Python3을 지원하도록 업데이트한 패키지입니다. 우선 pip로 패키지를 설치해 줍시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install fabric3</span><br><span class="line"><span class="comment"># 맥/리눅스라면 pip3 install fabric3</span></span><br></pre></td></tr></table></figure>

<p>이제 우리는 <code>fab</code>이라는 명령어를 사용할 수 있습니다. 이 명령어를 통해 <code>fabfile.py</code> 파일 내의 함수를 실행할 수 있게 됩니다.</p>
<h2 id="fabfile-py-파일-만들기"><a href="#fabfile-py-파일-만들기" class="headerlink" title="fabfile.py 파일 만들기"></a>fabfile.py 파일 만들기</h2><p>Fabric은 그 자체로는 하는 일이 없습니다. 사실 fabric은 우리가 서버에 들어가서 ‘Git으로 소스를 받고’, ‘DB를 업데이트하고’, ‘Static파일을 정리하며’, ‘웹서버 설정을 업데이트’해주는 일들을 하나의 마치 배치파일처럼 자동으로 실행할 수 있도록 도와주는 도구입니다.</p>
<p>하지만 이 도구를 사용하려면 우선 <code>fabfile.py</code>라는 파일이 있어야 fabric이 이 파일을 읽고 파일 속의 함수를 실행할 수 있게 됩니다.</p>
<p><code>fabfile</code>을 만들기 전 <code>deploy.json</code>이라는 이름의 json파일을 만들어 아래와 같이 설정을 담아줍시다.</p>
<p>우선 <code>REPO_URL</code>을 적어줍시다. 이 REPO에서 소스코드를 받아 처리해줄 예정이기 때문이죠. 그리고 <code>PROJECT_NAME</code>을 설정해 주세요. 일반적인 상황이라면 REPO의 이름과 같에 넣어주면 됩니다. 그리고 <code>REMOTE_HOST</code>는 서버의 주소가 됩니다. http등을 제외한 ‘도메인’부분만 넣어주세요. 그리고 서버에 SSH로 접속할 수 있는 IP를 <code>REMOTE_HOST_SSH</code>에 넣어주고, 마지막으로 <code>sudo</code>권한을 가진 유저이름을 <code>REMOTE_USER</code>에 넣어주세요.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"REPO_URL"</span>: <span class="string">"https://github.com/Beomi/our_project"</span>,</span><br><span class="line">  <span class="attr">"PROJECT_NAME"</span>: <span class="string">"our_project"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_HOST"</span>: <span class="string">"our_project.com"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_HOST_SSH"</span>: <span class="string">"123.32.1.4"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_USER"</span>: <span class="string">"sudouser"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>자, 이제 아래 코드를 통해 <code>fabfile.py</code>파일을 만들어 줍시다. (이것도 <code>app.py</code>와 같은 위치에 두면 관리하기가 편합니다.) </p>
<p>이부분은 파일에 설명을 담을 예정이니 코드의 주석을 참고해주세요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fabfile.py</span></span><br><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 현재 fabfile.py가 있는 폴더의 경로</span></span><br><span class="line">PROJECT_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line"><span class="comment"># deploy.json이라는 파일을 열어 아래의 변수들에 담아줍니다.</span></span><br><span class="line">envs = json.load(open(os.path.join(PROJECT_DIR, <span class="string">"deploy.json"</span>)))</span><br><span class="line"></span><br><span class="line">REPO_URL = envs[<span class="string">'REPO_URL'</span>]</span><br><span class="line">PROJECT_NAME = envs[<span class="string">'PROJECT_NAME'</span>]</span><br><span class="line">REMOTE_HOST = envs[<span class="string">'REMOTE_HOST'</span>]</span><br><span class="line">REMOTE_HOST_SSH = envs[<span class="string">'REMOTE_HOST_SSH'</span>]</span><br><span class="line">REMOTE_USER = envs[<span class="string">'REMOTE_USER'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># SSH에 접속할 유저를 지정하고,</span></span><br><span class="line">env.user = REMOTE_USER</span><br><span class="line"><span class="comment"># SSH로 접속할 서버주소를 넣어주고,</span></span><br><span class="line">env.hosts = [</span><br><span class="line">    REMOTE_HOST_SSH,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 원격 서버중 어디에 프로젝트를 저장할지 지정해준 뒤,</span></span><br><span class="line">project_folder = <span class="string">'/home/&#123;&#125;/&#123;&#125;'</span>.format(env.user, PROJECT_NAME)</span><br><span class="line"><span class="comment"># 우리 프로젝트에 필요한 apt 패키지들을 적어줍니다.</span></span><br><span class="line">apt_requirements = [</span><br><span class="line">    <span class="string">'curl'</span>,</span><br><span class="line">    <span class="string">'git'</span>,</span><br><span class="line">    <span class="string">'python3-dev'</span>,</span><br><span class="line">    <span class="string">'python3-pip'</span>,</span><br><span class="line">    <span class="string">'build-essential'</span>,</span><br><span class="line">    <span class="string">'apache2'</span>,</span><br><span class="line">    <span class="string">'libapache2-mod-wsgi-py3'</span>,</span><br><span class="line">    <span class="string">'python3-setuptools'</span>,</span><br><span class="line">    <span class="string">'libssl-dev'</span>,</span><br><span class="line">    <span class="string">'libffi-dev'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># _로 시작하지 않는 함수들은 fab new_server 처럼 명령줄에서 바로 실행이 가능합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_server</span><span class="params">()</span>:</span></span><br><span class="line">    setup()</span><br><span class="line">    deploy()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup</span><span class="params">()</span>:</span></span><br><span class="line">    _get_latest_apt()</span><br><span class="line">    _install_apt_requirements(apt_requirements)</span><br><span class="line">    _make_virtualenv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deploy</span><span class="params">()</span>:</span></span><br><span class="line">    _get_latest_source()</span><br><span class="line">    _put_envs()</span><br><span class="line">    _update_virtualenv()</span><br><span class="line">    _make_virtualhost()</span><br><span class="line">    _grant_apache2()</span><br><span class="line">    _restart_apache2()</span><br><span class="line"></span><br><span class="line"><span class="comment"># put이라는 방식으로 로컬의 파일을 원격지로 업로드할 수 있습니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_put_envs</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span>  <span class="comment"># activate for envs.json file</span></span><br><span class="line">    <span class="comment"># put('envs.json', '~/&#123;&#125;/envs.json'.format(PROJECT_NAME))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># apt 패키지를 업데이트 할 지 결정합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_latest_apt</span><span class="params">()</span>:</span></span><br><span class="line">    update_or_not = input(<span class="string">'would you update?: [y/n]'</span>)</span><br><span class="line">    <span class="keyword">if</span> update_or_not == <span class="string">'y'</span>:</span><br><span class="line">        sudo(<span class="string">'apt-get update &amp;&amp; apt-get -y upgrade'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 필요한 apt 패키지를 설치합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_install_apt_requirements</span><span class="params">(apt_requirements)</span>:</span></span><br><span class="line">    reqs = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> req <span class="keyword">in</span> apt_requirements:</span><br><span class="line">        reqs += (<span class="string">' '</span> + req)</span><br><span class="line">    sudo(<span class="string">'apt-get -y install &#123;&#125;'</span>.format(reqs))</span><br><span class="line"></span><br><span class="line"><span class="comment"># virtualenv와 virtualenvwrapper를 받아 설정합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_make_virtualenv</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exists(<span class="string">'~/.virtualenvs'</span>):</span><br><span class="line">        script = <span class="string">'''"# python virtualenv settings</span></span><br><span class="line"><span class="string">                    export WORKON_HOME=~/.virtualenvs</span></span><br><span class="line"><span class="string">                    export VIRTUALENVWRAPPER_PYTHON="$(command \which python3)"  # location of python3</span></span><br><span class="line"><span class="string">                    source /usr/local/bin/virtualenvwrapper.sh"'''</span></span><br><span class="line">        run(<span class="string">'mkdir ~/.virtualenvs'</span>)</span><br><span class="line">        sudo(<span class="string">'pip3 install virtualenv virtualenvwrapper'</span>)</span><br><span class="line">        run(<span class="string">'echo &#123;&#125; &gt;&gt; ~/.bashrc'</span>.format(script))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git Repo에서 최신 소스를 받아옵니다.</span></span><br><span class="line"><span class="comment"># 깃이 있다면 fetch를, 없다면 clone을 진행합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_latest_source</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> exists(project_folder + <span class="string">'/.git'</span>):</span><br><span class="line">        run(<span class="string">'cd %s &amp;&amp; git fetch'</span> % (project_folder,))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        run(<span class="string">'git clone %s %s'</span> % (REPO_URL, project_folder))</span><br><span class="line">    current_commit = local(<span class="string">"git log -n 1 --format=%H"</span>, capture=<span class="literal">True</span>)</span><br><span class="line">    run(<span class="string">'cd %s &amp;&amp; git reset --hard %s'</span> % (project_folder, current_commit))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Repo에서 받아온 requirements.txt를 통해 pip 패키지를 virtualenv에 설치해줍니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_update_virtualenv</span><span class="params">()</span>:</span></span><br><span class="line">    virtualenv_folder = project_folder + <span class="string">'/../.virtualenvs/&#123;&#125;'</span>.format(PROJECT_NAME)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exists(virtualenv_folder + <span class="string">'/bin/pip'</span>):</span><br><span class="line">        run(<span class="string">'cd /home/%s/.virtualenvs &amp;&amp; virtualenv %s'</span> % (env.user, PROJECT_NAME))</span><br><span class="line">    run(<span class="string">'%s/bin/pip install -r %s/requirements.txt'</span> % (</span><br><span class="line">        virtualenv_folder, project_folder</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line"><span class="comment"># (optional) UFW에서 80번/tcp포트를 열어줍니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_ufw_allow</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">"ufw allow 'Apache Full'"</span>)</span><br><span class="line">    sudo(<span class="string">"ufw reload"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Apache2의 Virtualhost를 설정해 줍니다. </span></span><br><span class="line"><span class="comment"># 이 부분에서 wsgi.py와의 통신, 그리고 virtualenv 내의 파이썬 경로를 지정해 줍니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_make_virtualhost</span><span class="params">()</span>:</span></span><br><span class="line">    script = <span class="string">"""'&lt;VirtualHost *:80&gt;</span></span><br><span class="line"><span class="string">    ServerName &#123;servername&#125;</span></span><br><span class="line"><span class="string">    &lt;Directory /home/&#123;username&#125;/&#123;project_name&#125;&gt;</span></span><br><span class="line"><span class="string">        &lt;Files wsgi.py&gt;</span></span><br><span class="line"><span class="string">            Require all granted</span></span><br><span class="line"><span class="string">        &lt;/Files&gt;</span></span><br><span class="line"><span class="string">    &lt;/Directory&gt;</span></span><br><span class="line"><span class="string">    WSGIDaemonProcess &#123;project_name&#125; python-home=/home/&#123;username&#125;/.virtualenvs/&#123;project_name&#125; python-path=/home/&#123;username&#125;/&#123;project_name&#125;</span></span><br><span class="line"><span class="string">    WSGIProcessGroup &#123;project_name&#125;</span></span><br><span class="line"><span class="string">    WSGIScriptAlias / /home/&#123;username&#125;/&#123;project_name&#125;/wsgi.py</span></span><br><span class="line"><span class="string">    &#123;% raw %&#125;</span></span><br><span class="line"><span class="string">    ErrorLog $&#123;&#123;APACHE_LOG_DIR&#125;&#125;/error.log</span></span><br><span class="line"><span class="string">    CustomLog $&#123;&#123;APACHE_LOG_DIR&#125;&#125;/access.log combined</span></span><br><span class="line"><span class="string">    &#123;% endraw %&#125;</span></span><br><span class="line"><span class="string">    &lt;/VirtualHost&gt;'"""</span>.format(</span><br><span class="line">        username=REMOTE_USER,</span><br><span class="line">        project_name=PROJECT_NAME,</span><br><span class="line">        servername=REMOTE_HOST,</span><br><span class="line">    )</span><br><span class="line">    sudo(<span class="string">'echo &#123;&#125; &gt; /etc/apache2/sites-available/&#123;&#125;.conf'</span>.format(script, PROJECT_NAME))</span><br><span class="line">    sudo(<span class="string">'a2ensite &#123;&#125;.conf'</span>.format(PROJECT_NAME))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Apache2가 프로젝트 파일을 읽을 수 있도록 권한을 부여합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_grant_apache2</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">'chown -R :www-data ~/&#123;&#125;'</span>.format(PROJECT_NAME))</span><br><span class="line">    sudo(<span class="string">'chmod -R 775 ~/&#123;&#125;'</span>.format(PROJECT_NAME))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 마지막으로 Apache2를 재시작합니다.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_restart_apache2</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">'sudo service apache2 restart'</span>)</span><br></pre></td></tr></table></figure>

<p>위 코드를 <code>fabfile.py</code>에 넣어주고 나서 </p>
<p>첫 실행시에는 <code>fab new_server</code></p>
<p>코드를 수정하고 push한 뒤 서버에 배포시에는 <code>fab deploy</code></p>
<p>명령을 실행해 주면 됩니다.</p>
<blockquote>
<p>NOTE: _ 로 시작하는 함수는 <code>fab 함수이름</code>으로 실행하지 못합니다.</p>
</blockquote>
<p>자, 이제 서버에 올릴 준비가 되었습니다.</p>
<h2 id="서버에-올리기"><a href="#서버에-올리기" class="headerlink" title="서버에 올리기"></a>서버에 올리기</h2><p>우분투 서버를 만들고 첫 배포라면 <code>new_server</code>를, 한번 <code>new_server</code>를 했다면 <code>deploy</code>로 배포를 진행합니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fab new_server <span class="comment"># 첫 배포</span></span><br><span class="line">fab deploy <span class="comment"># 첫 배포를 제외한 나머지</span></span><br></pre></td></tr></table></figure>

<h2 id="끝났습니다"><a href="#끝났습니다" class="headerlink" title="끝났습니다!"></a>끝났습니다!</h2><p>여러분의 사이트는 이제 <a href="http://REMOTE_HOST">http://REMOTE_HOST</a> 으로 접속 가능할거에요!</p>
<h2 id="유의할-점"><a href="#유의할-점" class="headerlink" title="유의할 점"></a>유의할 점</h2><p><code>fabfile</code>내의 <code>apt_requirements</code> 리스트에는 프로젝트마다 필요한 다른 패키지들을 적어줘야 합니다.</p>
<p>만약 여러분의 프로젝트에서 <code>mysqlclient</code>패키지등을 사용한다면 <code>libmysqlclient-dev</code>를 <code>apt_requirements</code>리스트에 추가해줘야 합니다. 혹은 PostgreSQL을 사용한다면 <code>libpq-dev</code>가 필요할 수도 있습니다. 그리고 여러분이 이미지 처리를 하는 <code>pillow</code>패키지를 사용한다면 <code>libjpeg62-dev</code>를 <code>apt_requirements</code>에 추가해야 할 수도 있습니다.</p>
<p>이처럼 여러분이 파이썬 패키지에서 어떤 상황이냐에 따라 다른 apt패키지 리스트를 넣어줘야 합니다. </p>
<p>이 부분만 유의해 넣어준다면 Fabric으로 한번에 배포에 성공할 수 있을거랍니다! :)</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/10/01/PDF_to_GoogleTranslatorToolkit/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/pdf_to_google_translator_toolkit.jpeg" alt="PDF 책 구글 번역가 도구에서 번역하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-30T15:00:00.000Z">2017-10-01</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/tips/">tips</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/10/01/PDF_to_GoogleTranslatorToolkit/">PDF 책 구글 번역가 도구에서 번역하기</a>
            
        </h1>
        <div class="content">
            <h2 id="시작하며"><a href="#시작하며" class="headerlink" title="시작하며"></a>시작하며</h2><p>번역을 할 때 대상이 이미 doc파일같은 것이라면 사실 이 부분은 걱정하지 않아도 괜찮습니다. 하지만 만약 여러분이 책 번역등 의뢰를 받아 진행한다면 PDF로 책을 받을 가능성이 꽤 높습니다.<br>물론 PDF를 켜놓고 word창을 하나 옆으로 두 창을 띄워두며 한글로 번역해도 일이 가능하기는 합니다.<br>하지만 최근 React문서를 번역하며 사용했던 도구인 <a href="https://crowdin.com">crowdin</a>이나 Django문서 번역할때 사용하는 <a href="https://www.transifex.com">transifex</a>를 떠올려보면 이게 무슨 삽질인가, 하는 생각이 듭니다.</p>
<p>그래서 여러분이 번역을 하기 위해 crowdin이나 transifex를 사용하려 사이트에 들어가보면,</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+16.47.57.png?dl=1" alt=""></p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+16.48.33.png?dl=1" alt=""></p>
<p>월 단위 pricing인 것을 넘어 가격대가 상당히 높게 형성되어있는 것을 볼 수 있습니다. (ㅠㅠ) 저 두 서비스는 분명히 멋지고 좋은 서비스이지만 매달 가격을 지불하기에는 애매한 측면이 있어 다른 방법을 찾아보았습니다.</p>
<p>그러다 찾게 된 것이 바로 <a href="">구글 번역가 도구</a>였습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+16.50.24.png?dl=1" alt=""></p>
<p>이 구글 번역가 도구를 사용하면 상당히 다양한 형식의 문서를 번역할 수 있습니다.</p>
<h4 id="문서"><a href="#문서" class="headerlink" title="문서"></a>문서</h4><ul>
<li>HTML(.HTML)</li>
<li>Microsoft Word (.DOC/.DOCX)</li>
<li>일반 텍스트(.TXT)</li>
<li>서식 있는 텍스트(.RTF)</li>
<li>위키백과 URL</li>
</ul>
<h4 id="광고"><a href="#광고" class="headerlink" title="광고"></a>광고</h4><ul>
<li>애드워즈 에디터 보관 파일 (.AEA)</li>
<li>애드워즈 에디터 공유 파일(.AES)</li>
</ul>
<h4 id="동영상"><a href="#동영상" class="headerlink" title="동영상"></a>동영상</h4><ul>
<li>YouTube 캡션</li>
<li>SubRip(.SRT)</li>
<li>SubViewer(.SUB)</li>
</ul>
<h4 id="기타"><a href="#기타" class="headerlink" title="기타"></a>기타</h4><ul>
<li>자바 애플리케이션 (.PROPERTIES)</li>
<li>애플리케이션 리소스 번들(.ARB)</li>
<li>Chrome 확장 프로그램(.JSON)</li>
<li>Apple iOS 애플리케이션(.STRINGS)</li>
</ul>
<p>하지만 잘 보시면 우리가 받은 PDF파일을 바로 올릴수는 없게 되어있습니다.</p>
<p>자, 이제 ‘구글 번역가 도구에 올릴’ 파일을 만들기 위한 여정을 시작해봅시다.</p>
<h2 id="PDF를-쪼개기"><a href="#PDF를-쪼개기" class="headerlink" title="PDF를 쪼개기"></a>PDF를 쪼개기</h2><p>우리가 구글 번역가 도구에 올릴 최종 파일은 “1MB 이내의 .docx파일” 입니다. 왜 1MB냐고요? 구글이 그렇게 제한을 걸어서 그렇습니다 (ㅠㅠ)</p>
<p>만약 여러분이 1MB가 넘는 파일을 올리려 하시면…..</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.01.31.png?dl=1" alt=""></p>
<p>아래와 같이 에러가 납니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.03.42.png?dl=1" alt=""></p>
<p>하지만 우리가 만약 PDF를 워드로 바꿔주고 나서 쪼개주려고 하면 상당히 귀찮습니다. 그래서 PDF를 먼저 목차대로 쪼개주는 것이 좋습니다.</p>
<p>우리는 <a href="https://www.sejda.com/split-pdf-by-outline">https://www.sejda.com/split-pdf-by-outline</a>라는 사이트를 이용할거에요.</p>
<p>사이트를 들어가주시면 아래와 같이 PDF를 올리라고 하는 부분이 나옵니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.04.27.png?dl=1" alt=""></p>
<p>약간 아쉬운점은 무료는 200페이지 이내의 pdf로 제한이 걸린다는 점입니다. 그래서 저는 5달러를 지불하고 5일치 정액권을 구매해 이용했습니다.</p>
<p>무료는 속도 제한이 있기도 하고, 여기에서 여러 서비스를 사용할 것이기 때문에 5일권을 사서 진행하시는 것도 좋은 방법입니다.</p>
<blockquote>
<p>물론 무료로 진행할 수 있는 곳도 있지만, 나중에 PDF Crop을 할 때 이 사이트를 또 사용하기 때문에 정액권을 사는 것을 추천합니다.(커피한잔값에 여러분의 정신건강을 지킬 수 있습니다.)</p>
</blockquote>
<p>PDF를 올려주면 얼만큼 자세하게 쪼갤지 물어봅니다. Bookmark level이 바로 그 옵션인데요, 저는 대제목(챕터)로 자를 예정이라 1을 선택했습니다. 만약 좀 더 자세하게 소제목으로 잘라주고 싶다면 2정도를 선택해주시면 됩니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.08.26.png?dl=1" alt=""></p>
<p>이제 Split by bookmarks를 클릭해주면 아래와 같이 다운로드 버튼이 나옵니다!</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.09.45.png?dl=1" alt=""></p>
<p>다운로드 받은 zip파일을 풀어주면 다음과 같이 챕터별로 잘 쪼개졌다는 것을 확인할 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.10.30.png?dl=1" alt=""></p>
<p>하지만 이 상태는 책 각 페이지에 머리말과 꼬리말이 들어가 있어 이 파일을 바로 워드파일로 변환해주면 머리말과 꼬리말이 같이 들어가 번역하기 귀찮은 상태가 됩니다. 그래서 이 부분을 제거해주어야 합니다.</p>
<h2 id="머리말-꼬리말-제거해주기"><a href="#머리말-꼬리말-제거해주기" class="headerlink" title="머리말/꼬리말 제거해주기"></a>머리말/꼬리말 제거해주기</h2><p>이번에는 <a href="https://www.sejda.com/crop-pdf">https://www.sejda.com/crop-pdf</a>에서 진행합니다. 위에서 정액권을 구매했다면 여러개 파일을 동시에 넣어 crop을 돌릴 수 있습니다. (무료는 하나하나 넣어야 합니다)</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.12.59.png?dl=1" alt=""></p>
<p>위 사진의 Upload PDF Files를 눌러 파일 여러개를 동시에 crop할 수 있습니다. 우리가 위에서 목차대로 잘라준 경우처럼 책 사이즈가 같은 경우 굉장히 유용합니다.</p>
<p>우선 본문인 11~19번 파일만 업로드를 해보았습니다.</p>
<p>업로드가 완료되면 다음과 같이 Crop할 부분을 선택하라고 나옵니다. 문서 일부분이 화면에 겹쳐 나오기때문에 예상치 못하게 버려지는 부분이 생기는 것을 방지할 수 있습니다 :)</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.15.01.png?dl=1" alt=""></p>
<p>위 사진처럼 텍스트 부분만 선택하고 화면 아래의 CropPDF를 눌러주면 위에서와 같이 처리가 끝난 파일의 모음 zip을 받을 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.15.37.png?dl=1" alt=""></p>
<p>다운을 받아주고 확인해 봅시다. 글자 부분만 깔끔하게 잘 잘라준 것을 확인해 볼 수 있습니다!</p>
<blockquote>
<p>글 일부분이 안보이는 것은 책이라 일부러 잘라 보이지 않는 부분입니다. 파일은 잘 처리되었다는걸 썸네일에서 확인할 수 있죠!</p>
</blockquote>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.16.36.png?dl=1" alt=""></p>
<h2 id="PDF를-워드파일-docx-로-바꿔주기"><a href="#PDF를-워드파일-docx-로-바꿔주기" class="headerlink" title="PDF를 워드파일(.docx)로 바꿔주기"></a>PDF를 워드파일(.docx)로 바꿔주기</h2><p>이번에는 <a href="http://pdf2docx.com/">pdf2docx</a>라는 서비스를 이용합니다. (무료입니다!)</p>
<p>우리가 방금 만들어준 ‘cropped_어쩌구.pdf’파일들을 업로드 해 주면 됩니다. 여러개 파일을 한번에 올릴 수 있어 편리합니다 ;)</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.18.42.png?dl=1" alt=""></p>
<p>업로드가 끝나고 변환작업이 완료되면 아래와 같이 Download All버튼이 활성화됩니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.19.41.png?dl=1" alt=""></p>
<p>버튼을 누르면 <code>pdf2docx.zip</code>파일이 받아지고, 이 압축 파일을 풀어주면 다음과 같이 .docx파일로 변환된 파일들이 잘 들어오는 것을 확인할 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.20.28.png?dl=1" alt=""></p>
<p>하지만 잘 보시면 크기가 1MB를 넘는 파일이 보입니다. 저 파일들은 구글 번역가 도구에 올릴수 없습니다. 보통 문서가 1MB를 넘는 경우는 이미지의 크기가 큰 것이기 때문에, 이미지의 ppi를 조절해 파일 크기를 줄일 수 있습니다.</p>
<h2 id="docx파일-크기-줄이기-이미지-ppi줄이기"><a href="#docx파일-크기-줄이기-이미지-ppi줄이기" class="headerlink" title=".docx파일 크기 줄이기(이미지 ppi줄이기)"></a>.docx파일 크기 줄이기(이미지 ppi줄이기)</h2><p>1MB가 넘는 한 문서를 열어보니 이미지가 많아 보입니다. 하지만 이미지를 지우면 번역할때 어떤 내용을 다루는지 알아보기 어렵기 때문에 이미지의 해상도(ppi)만 낮춰주도록 하겠습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.21.59.png?dl=1" alt=""></p>
<p>우선 아래 스샷처럼 아무 이미지나 클릭해주고 나서 화면 위에 뜨는 ‘그림 서식’을 눌러주신 뒤, 핑크색으로 네모 표시 된 버튼을 눌러주세요.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.23.30.png?dl=1" alt=""></p>
<p>그러면 ‘그림압축’ 메뉴가 뜨고 아래와 같이 그림 품질을 고를 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.23.59.png?dl=1" alt=""></p>
<p>최저 ppi인 96ppi로 맞춰주고 ‘잘려진 그림 영역 삭제’에 체크를 눌러주고 ‘이 파일의 모든 그림’으로 맞춰준 후 확인을 눌러주세요. 그리고 저장을 해주시면, 아래와 같이 파일 사이즈가 줄어든 것을 볼 수 있습니다. (기존 1.5MB -&gt; 현재 1MB 조금 덜 됨)</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.25.33.png?dl=1" alt=""></p>
<h2 id="구글-번역가-도구에-업로드하기"><a href="#구글-번역가-도구에-업로드하기" class="headerlink" title="구글 번역가 도구에 업로드하기"></a>구글 번역가 도구에 업로드하기</h2><p><a href="https://translate.google.com/toolkit/docupload?hl=ko">구글 번역가 도구 업로드</a>에 다시 들어가 작아진 .docx파일을 올려줍시다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.27.15.png?dl=1" alt=""></p>
<p>언어 선택에 한국어는 기본적으로 없기 때문에 ‘ko’를 검색해 한국어를 추가하고 선택해줍시다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.27.47.png?dl=1" alt=""></p>
<p>이제 업로드가 끝나면 번역 업체를 누르라고 하는데, ‘아니오’를 눌러주면 됩니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.28.30.png?dl=1" alt=""></p>
<p>업로드가 완료되면 아래와 같이 번역 목록에 뜹니다!</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.29.09.png?dl=1" alt=""></p>
<p>링크를 클릭해 들어가면 이제 아래처럼 번역 작업을 시작할 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.ap-northeast-2.amazonaws.com/img/2017-10-01-pdf-google/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2017-10-01+17.29.46.png?dl=1" alt=""></p>
<h2 id="끝"><a href="#끝" class="headerlink" title="끝!"></a>끝!</h2><p>자, 이제 PDF파일로 된 책을 구글 번역가 도구에서 번역할 수 있도록 하는 작업이 모두 끝났습니다.</p>
<p>하지만 이 방식으로는 아쉬운 것이 세가지가 있습니다.</p>
<ul>
<li>책의 포맷을 맞춰주세요:<br>우리가 책을 crop했기 때문에 어렵습니다.</li>
<li>코드가 Indent가 제대로 되지 않아요:<br>pdf to docx는 코드도 일반 문서로 해석합니다. (ㅠㅠ)</li>
<li>TM(Translation memory)이 완벽하지 않아요:<br>구글 번역가 도구가 TM관리가 약간 기능이 부족합니다. 그래도 무료잖아요!</li>
</ul>
<p>하지만 이 세가지를 감안한다면 이 가이드가 유용하실 것이라 생각합니다. 번역하시는 모든 분들 화이팅!</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/09/28/HowToMakeWebCrawler-Headless-Chrome/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/Crawling-with-HeadlessChrome.png" alt="나만의 웹 크롤러 만들기(7): 창없는 크롬으로 크롤링하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-27T15:00:00.000Z">2017-09-28</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/howtomakewebcrawler/">howtomakewebcrawler</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/28/HowToMakeWebCrawler-Headless-Chrome/">나만의 웹 크롤러 만들기(7): 창없는 크롬으로 크롤링하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>좀 더 보기 편한 <a href="https://beomi.github.io/gb-crawling/">깃북 버전의 나만의 웹 크롤러 만들기</a>가 나왔습니다!</p>
</blockquote>
<blockquote>
<p>이번 가이드는 가이드 3편(<a href="/2017/02/27/HowToMakeWebCrawler-With-Selenium/">Selenium으로 무적 크롤러 만들기</a>)의 확장편입니다. 아직 <code>selenium</code>을 이용해보지 않은 분이라면 먼저 저 가이드를 보고 오시는걸 추천합니다.</p>
</blockquote>
<h2 id="HeadLess-Chrome-머리없는-크롬"><a href="#HeadLess-Chrome-머리없는-크롬" class="headerlink" title="HeadLess Chrome? 머리없는 크롬?"></a>HeadLess Chrome? 머리없는 크롬?</h2><h3 id="HeadLess란"><a href="#HeadLess란" class="headerlink" title="HeadLess란?"></a>HeadLess란?</h3><p>Headless라는 용어는 ‘창이 없는’과 같다고 이해하시면 됩니다. 여러분이 브라우저(크롬 등)을 이용해 인터넷을 브라우징 할 때 기본적으로 창이 뜨고 HTML파일을 불러오고, CSS파일을 불러와 어떤 내용을 화면에 그러야 할지 계산을 하는 작업을 브라우저가 자동으로 진행해줍니다. </p>
<p>하지만 이와같은 방식을 사용할 경우 사용하는 운영체제에 따라 크롬이 실행이 될 수도, 실행이 되지 않을 수도 있습니다. 예를들어 우분투 서버와 같은 OS에서는 ‘화면’ 자체가 존재하지 않기 때문에 일반적인 방식으로는 크롬을 사용할 수 없습니다. 이를 해결해 주는 방식이 바로 Headless 모드입니다. 브라우저 창을 실제로 운영체제의 ‘창’으로 띄우지 않고 대신 화면을 그려주는 작업(렌더링)을 가상으로 진행해주는 방법으로 실제 브라우저와 동일하게 동작하지만 창은 뜨지 않는 방식으로 동작할 수 있습니다.</p>
<h3 id="그러면-왜-크롬"><a href="#그러면-왜-크롬" class="headerlink" title="그러면 왜 크롬?"></a>그러면 왜 크롬?</h3><p>일전 가이드에서 <code>PhantomJS</code>(팬텀)라는 브라우저를 이용하는 방법에 대해 다룬적이 있습니다. 팬텀은 브라우저와 유사하게 동작하고 Javascript를 동작시켜주지만 성능상의 문제점과 크롬과 완전히 동일하게 동작하지는 않는다는 문제점이 있습니다. 우리가 크롤러를 만드는 상황이 대부분 크롬에서 진행하고, 크롬의 결과물 그대로 가져오기 위해서는 브라우저도 크롬을 사용하는 것이 좋습니다.</p>
<blockquote>
<p>하지만 여전히 팬텀이 가지는 장점이 있습니다. WebDriver Binary만으로 추가적인 설치 없이 환경을 만들 수 있다는 장점이 있습니다.</p>
</blockquote>
<p>윈도우 기준 크롬 59, 맥/리눅스 기준 크롬 60버전부터 크롬에 <code>Headless Mode</code>가 정식으로 추가되어서 만약 여러분의 브라우저가 최신이라면 크롬의 Headless모드를 쉽게 이용할 수 있습니다.</p>
<h2 id="크롬-버전-확인하기"><a href="#크롬-버전-확인하기" class="headerlink" title="크롬 버전 확인하기"></a>크롬 버전 확인하기</h2><p>크롬 버전 확인은 크롬 브라우저에서 <a href="chrome://version/">chrome://version/</a>로 들어가 확인할 수 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/ScreenShot2017-08-0112.47.57.png" alt=""></p>
<p>이와 같이 크롬 버전이 60버전 이상인 크롬에서는 ‘Headless’모드를 사용할 수 있습니다.</p>
<h2 id="크롬드라이버-chromedriver-업데이트"><a href="#크롬드라이버-chromedriver-업데이트" class="headerlink" title="크롬드라이버(chromedriver) 업데이트"></a>크롬드라이버(chromedriver) 업데이트</h2><p>크롬 버전이 올라감에 따라 크롬을 조작하도록 도와주는 <code>chromedriver</code> 역시 함께 업데이트를 진행해야 합니다.</p>
<p><a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></p>
<p>위 링크에서 Latest Release 옆 크롬드라이버를 선택해 OS별로 알맞은 zip파일을 받아 압축을 풀어줍시다.</p>
<h2 id="기존-코드-수정하기"><a href="#기존-코드-수정하기" class="headerlink" title="기존 코드 수정하기"></a>기존 코드 수정하기</h2><p>크롬의 헤드리스 모드를 사용하는 방식은 기존 selenium을 이용한 코드와 거의 동일합니다만, 몇가지 옵션을 추가해줘야합니다.</p>
<p>기존에 webdriver를 사용해 크롬을 동작한 경우 아래와 같은 코드를 사용할 수 있었습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># 유의: chromedriver를 위에서 받아준 </span></span><br><span class="line"><span class="comment"># chromdriver(windows는 chromedriver.exe)의 절대경로로 바꿔주세요!</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'http://naver.com'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line">driver.get_screenshot_as_file(<span class="string">'naver_main.png'</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>위 코드를 동작시키면 크롬이 켜지고 파이썬 파일 옆에 <code>naver_main.png</code>라는 스크린샷 하나가 생기게 됩니다.<br>이 코드는 지금까지 우리가 만들었던 코드와 큰 차이가 없는걸 확인해 보세요.</p>
<p>하지만 이 코드를 몇가지 옵션만 추가해주면 바로 Headless모드로 동작하게 만들어줄 수 있습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line"><span class="comment"># 혹은 options.add_argument("--disable-gpu")</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'http://naver.com'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line">driver.get_screenshot_as_file(<span class="string">'naver_main_headless.png'</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>위 코드를 보시면 <code>ChromeOptions()</code>를 만들어 <code>add_argument</code>를 통해 Headless모드인 것과, 크롬 창의 크기, 그리고 gpu(그래픽카드 가속)를 사용하지 않는 옵션을 넣어준 것을 볼 수 있습니다.</p>
<p>제일 중요한 부분은 바로 <code>options.add_argument(&#39;headless&#39;)</code>라는 부분입니다. 크롬이 Headless모드로 동작하도록 만들어주는 키워드에요. 그리고 크롬 창의 크기를 직접 지정해 준 이유는, 여러분이 일반적으로 노트북이나 데스크탑에서 사용하는 모니터의 해상도가 1920x1080이기 때문입니다. 즉, 여러분이 일상적으로 보는 것 그대로 크롬이 동작할거라는 기대를 해볼수 있습니다!</p>
<p>마지막으로는 <code>disable-gpu</code>인데요, 만약 위 코드를 실행했을때 GPU에러~가 난다면 <code>--disable-gpu</code>로 앞에 dash(-)를 두개 더 붙여보세요. 이 버그는 크롬 자체에 있는 문제점입니다. 브라우저들은 CPU의 부담을 줄이고 좀더 빠른 화면 렌더링을 위해 GPU를 통해 그래픽 가속을 사용하는데, 이 부분이 크롬에서 버그를 일으키는 현상을 보이고 있습니다. (윈도우 크롬 61버전까지는 아직 업데이트 되지 않았습니다. 맥 61버전에는 해결된 이슈입니다.)</p>
<p>그리고 <code>driver</code> 변수를 만들 때 단순하게 chromedriver의 위치만 적어주는 것이 아니라 <code>chrome_options</code>라는 이름의 인자를 함께 넘겨줘야 합니다.</p>
<p>이 <code>chrome_options</code>는 Chrome을 이용할때만 사용하는 인자인데요, 이 인자값을 통해 headless등의 추가적인 인자를 넘겨준답니다.</p>
<p>자, 이제 그러면 한번 실행해 보세요. 크롬 창이 뜨지 않았는데도 <code>naver_main_headless.png</code>파일이 생겼다면 여러분 컴퓨터에서 크롬이 Headless모드로 성공적으로 실행된 것이랍니다!</p>
<h2 id="Headless브라우저임을-숨기기"><a href="#Headless브라우저임을-숨기기" class="headerlink" title="Headless브라우저임을 숨기기"></a>Headless브라우저임을 숨기기</h2><p>Headless모드는 CLI기반의 서버 OS에서도 Selenium을 통한 크롤링/테스트를 가능하게 만드는 멋진 모드지만, 어떤 서버들에서는 이런 Headless모드를 감지하는 여러가지 방법을 쓸 수 있습니다.</p>
<p>아래 글에서는 Headless모드를 탐지하는 방법과 탐지를 ‘막는’방법을 다룹니다.(창과 방패, 또 새로운 창!)</p>
<p>아래 코드의 TEST_URL은 <a href="https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html">https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html</a> 인데요, 이곳에서 Headless모드가 감춰졌는지 아닌지 확인해 볼 수 있습니다.</p>
<h3 id="User-Agent-확인하기"><a href="#User-Agent-확인하기" class="headerlink" title="User Agent 확인하기"></a>User Agent 확인하기</h3><h4 id="Headless-탐지하기"><a href="#Headless-탐지하기" class="headerlink" title="Headless 탐지하기"></a>Headless 탐지하기</h4><p>가장 쉬운 방법은 <code>User-Agent</code>값을 확인하는 방법입니다.</p>
<p>일반적인 크롬 브라우저는 아래와 같은 <code>User-Agent</code>값을 가지고 있습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;61.0.3163.100 Safari&#x2F;537.36</span><br></pre></td></tr></table></figure>

<p>하지만 Headless브라우저는 아래와 같은 <code>User-Agent</code>값을 가지고 있습니다.</p>
<p>잘 보시면 ‘HeadlessChrome/~~’와 같이 ‘Headless’라는 단어가 들어가있는걸 확인할 수 있습니다!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mozilla&#x2F;5.0 (X11; Linux x86_64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) HeadlessChrome&#x2F;60.0.3112.50 Safari&#x2F;537.36</span><br></pre></td></tr></table></figure>

<h4 id="Headless-탐지-막기"><a href="#Headless-탐지-막기" class="headerlink" title="Headless 탐지 막기"></a>Headless 탐지 막기</h4><p>따라서 기본적으로 갖고있는 <code>User-Agent</code>값을 변경해줘야합니다.</p>
<p>이것도 위에서 사용한 <code>chrome_options</code>에 추가적으로 인자를 전달해주면 됩니다. 위코드를 약간 바꿔 아래와 같이 만들어보세요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">TEST_URL = <span class="string">'https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html'</span></span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># UserAgent값을 바꿔줍시다!</span></span><br><span class="line">options.add_argument(<span class="string">"user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"</span>)</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(TEST_URL)</span><br><span class="line"></span><br><span class="line">user_agent = driver.find_element_by_css_selector(<span class="string">'#user-agent'</span>).text</span><br><span class="line"></span><br><span class="line">print(<span class="string">'User-Agent: '</span>, user_agent)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>이제 여러분의 Headless크롬은 일반적인 크롬으로 보일거랍니다.</p>
<h3 id="플러그인-개수-확인하기"><a href="#플러그인-개수-확인하기" class="headerlink" title="플러그인 개수 확인하기"></a>플러그인 개수 확인하기</h3><h4 id="Headless-탐지하기-1"><a href="#Headless-탐지하기-1" class="headerlink" title="Headless 탐지하기"></a>Headless 탐지하기</h4><p>크롬에는 여러분이 따로 설치하지 않아도 추가적으로 플러그인 몇개가 설치되어있답니다. PDF 내장 리더기같은 것들이죠.</p>
<p>하지만 Headless모드에서는 플러그인이 하나도 로딩되지 않아 개수가 0개가 됩니다. 이를 통해 Headless모드라고 추측할 수 있답니다.</p>
<p>아래 자바스크립트 코드를 통해 플러그인의 개수를 알아낼 수 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(navigator.plugins.length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Headless 크롬이 아닐까??"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Headless-탐지-막기-1"><a href="#Headless-탐지-막기-1" class="headerlink" title="Headless 탐지 막기"></a>Headless 탐지 막기</h4><p>물론 이 탐지를 막는 방법도 있습니다. 바로 브라우저에 ‘가짜 플러그인’ 리스트를 넣어주는 것이죠!</p>
<p>아래 코드와 같이 JavaScript를 실행해 플러그인 리스트를 가짜로 만들어 넣어줍시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">TEST_URL = <span class="string">'https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html'</span></span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line">options.add_argument(<span class="string">"user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"</span>)</span><br><span class="line">options.add_argument(<span class="string">"lang=ko_KR"</span>) <span class="comment"># 한국어!</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'about:blank'</span>)</span><br><span class="line">driver.execute_script(<span class="string">"Object.defineProperty(navigator, 'plugins', &#123;get: function() &#123;return[1, 2, 3, 4, 5];&#125;,&#125;);"</span>)</span><br><span class="line">driver.get(TEST_URL)</span><br><span class="line"></span><br><span class="line">user_agent = driver.find_element_by_css_selector(<span class="string">'#user-agent'</span>).text</span><br><span class="line">plugins_length = driver.find_element_by_css_selector(<span class="string">'#plugins-length'</span>).text</span><br><span class="line"></span><br><span class="line">print(<span class="string">'User-Agent: '</span>, user_agent)</span><br><span class="line">print(<span class="string">'Plugin length: '</span>, plugins_length)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>위와 같이 JS로 navigator 객체의 <code>plugins</code>속성 자체를 오버라이딩 해 임의의 배열을 반환하도록 만들어주면 개수를 속일 수 있습니다.</p>
<blockquote>
<p>단, 출력물에서는 Plugin length가 여전히 0으로 나올거에요. 왜냐하면 사이트가 로딩 될때 이미 저 속성이 들어가있기 때문이죠 :’( 그래서 우리는 좀 더 다른방법을 뒤에서 써볼거에요.</p>
</blockquote>
<h3 id="언어-설정"><a href="#언어-설정" class="headerlink" title="언어 설정"></a>언어 설정</h3><h4 id="Headless-탐지하기-2"><a href="#Headless-탐지하기-2" class="headerlink" title="Headless 탐지하기"></a>Headless 탐지하기</h4><p>여러분이 인터넷을 사용할때 어떤 사이트를 들어가면 다국어 사이트인데도 여러분의 언어에 맞게 화면에 나오는 경우를 종종 보고, 구글 크롬을 써서 외국 사이트를 돌아다니면 ‘번역해줄까?’ 하는 친절한 질문을 종종 봅니다.</p>
<p>이 설정이 바로 브라우저의 언어 설정이랍니다. 즉, 여러분이 선호하는 언어가 이미 등록되어있는 것이죠.</p>
<p>Headless모드에는 이런 언어 설정이 되어있지 않아서 이를 통해 Headless모드가 아닐까 ‘추측’할 수 있습니다.</p>
<h4 id="Headless-탐지-막기-2"><a href="#Headless-탐지-막기-2" class="headerlink" title="Headless 탐지 막기"></a>Headless 탐지 막기</h4><p>Headless모드인 것을 감추기 위해 언어 설정을 넣어줍시다. 바로 <code>add_argument</code>를 통해 크롬에 전달해 줄 수 있답니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">TEST_URL = <span class="string">'https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html'</span></span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line">options.add_argument(<span class="string">"user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"</span>)</span><br><span class="line">options.add_argument(<span class="string">"lang=ko_KR"</span>) <span class="comment"># 한국어!</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(TEST_URL)</span><br><span class="line">driver.execute_script(<span class="string">"Object.defineProperty(navigator, 'plugins', &#123;get: function() &#123;return[1, 2, 3, 4, 5]&#125;&#125;)"</span>)</span><br><span class="line"><span class="comment"># lanuages 속성을 업데이트해주기</span></span><br><span class="line">driver.execute_script(<span class="string">"Object.defineProperty(navigator, 'languages', &#123;get: function() &#123;return ['ko-KR', 'ko']&#125;&#125;)"</span>)</span><br><span class="line"></span><br><span class="line">user_agent = driver.find_element_by_css_selector(<span class="string">'#user-agent'</span>).text</span><br><span class="line">plugins_length = driver.find_element_by_css_selector(<span class="string">'#plugins-length'</span>).text</span><br><span class="line">languages = driver.find_element_by_css_selector(<span class="string">'#languages'</span>).text</span><br><span class="line"></span><br><span class="line">print(<span class="string">'User-Agent: '</span>, user_agent)</span><br><span class="line">print(<span class="string">'Plugin length: '</span>, plugins_length)</span><br><span class="line">print(<span class="string">'languages: '</span>, languages)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>단, 출력물에서는 language가 빈칸으로 나올거에요. 왜냐하면 사이트가 로딩 될때 이미 저 속성이 들어가있기 때문이죠 :’( 그래서 우리는 좀 더 다른방법을 뒤에서 써볼거에요.</p>
</blockquote>
<h3 id="WebGL-벤더와-렌더러"><a href="#WebGL-벤더와-렌더러" class="headerlink" title="WebGL 벤더와 렌더러"></a>WebGL 벤더와 렌더러</h3><h4 id="Headless-탐지하기-3"><a href="#Headless-탐지하기-3" class="headerlink" title="Headless 탐지하기"></a>Headless 탐지하기</h4><p>여러분이 브라우저를 사용할때 WebGL이라는 방법으로 그래픽카드를 통해 그려지는 방법을 가속을 한답니다. 즉, 실제로 디바이스에서 돌아간다면 대부분은 그래픽 가속을 사용한다는 가정이 기반인 셈이죠.</p>
<blockquote>
<p>사실 이 방법으로 차단하는 웹사이트는 거의 없을거에요. 혹여나 GPU가속을 꺼둔 브라우저라면 구별할 수 없기 때문이죠.</p>
</blockquote>
<p>위 코드에서 사용해준 <code>disable-gpu</code>옵션은 사실 이 그래픽 가속을 꺼주는 것이에요. 따라서 이부분을 보완해 줄 필요가 있습니다.</p>
<h4 id="Headless-탐지-막기-3"><a href="#Headless-탐지-막기-3" class="headerlink" title="Headless 탐지 막기"></a>Headless 탐지 막기</h4><p>가장 쉬운 방법은 크롬이 업데이트되길 기대하고 <code>disable-gpu</code>옵션을 꺼버리는 것이지만, 우선은 이 옵션을 함께 사용하는 방법을 알려드릴게요.</p>
<p>위에서 사용한 script실행방법을 또 써 볼 것이랍니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">TEST_URL = <span class="string">'https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html'</span></span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line">options.add_argument(<span class="string">"user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"</span>)</span><br><span class="line">options.add_argument(<span class="string">"lang=ko_KR"</span>) <span class="comment"># 한국어!</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(TEST_URL)</span><br><span class="line">driver.execute_script(<span class="string">"Object.defineProperty(navigator, 'plugins', &#123;get: function() &#123;return[1, 2, 3, 4, 5]&#125;&#125;)"</span>)</span><br><span class="line">driver.execute_script(<span class="string">"Object.defineProperty(navigator, 'languages', &#123;get: function() &#123;return ['ko-KR', 'ko']&#125;&#125;)"</span>)</span><br><span class="line">driver.execute_script(<span class="string">"const getParameter = WebGLRenderingContext.getParameter;WebGLRenderingContext.prototype.getParameter = function(parameter) &#123;if (parameter === 37445) &#123;return 'NVIDIA Corporation'&#125; if (parameter === 37446) &#123;return 'NVIDIA GeForce GTX 980 Ti OpenGL Engine';&#125;return getParameter(parameter);&#125;;"</span>)</span><br><span class="line"></span><br><span class="line">user_agent = driver.find_element_by_css_selector(<span class="string">'#user-agent'</span>).text</span><br><span class="line">plugins_length = driver.find_element_by_css_selector(<span class="string">'#plugins-length'</span>).text</span><br><span class="line">languages = driver.find_element_by_css_selector(<span class="string">'#languages'</span>).text</span><br><span class="line">webgl_vendor = driver.find_element_by_css_selector(<span class="string">'#webgl-vendor'</span>).text</span><br><span class="line">webgl_renderer = driver.find_element_by_css_selector(<span class="string">'#webgl-renderer'</span>).text</span><br><span class="line"></span><br><span class="line">print(<span class="string">'User-Agent: '</span>, user_agent)</span><br><span class="line">print(<span class="string">'Plugin length: '</span>, plugins_length)</span><br><span class="line">print(<span class="string">'languages: '</span>, languages)</span><br><span class="line">print(<span class="string">'WebGL Vendor: '</span>, webgl_vendor)</span><br><span class="line">print(<span class="string">'WebGL Renderer: '</span>, webgl_renderer)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>위 코드에서는 WebGL렌더러를 Nvidia회사와 GTX980Ti엔진인 ‘척’ 하고 있는 방법입니다.</p>
<blockquote>
<p>하지만 WebGL print 구문에서는 여전히 빈칸일거에요. 이 역시 이미 사이트 로딩시 속성이 들어가있기 때문이에요.</p>
</blockquote>
<h2 id="Headless-브라우저-숨기는-방법-다함께-쓰기"><a href="#Headless-브라우저-숨기는-방법-다함께-쓰기" class="headerlink" title="Headless 브라우저 숨기는 방법 다함께 쓰기"></a>Headless 브라우저 숨기는 방법 다함께 쓰기</h2><p>위에서 사용한 방법 중 <code>User-Agent</code>를 바꾸는 방법 외에는 사실 모두 Javascript를 이용해 값을 추출하고 오버라이딩 하는 방식으로 바꿔보았습니다.</p>
<p>하지만 번번히 결과물이 빈칸으로 나오는 이유는 <code>driver.execute_script</code>라는 함수 자체가 사이트가 로딩이 끝난 후 (<code>onload()</code>이후) 실행되기 때문입니다.</p>
<p>즉, 우리는 우리가 써준 저 JS코드가 사이트가 로딩 되기 전 실행되어야 한다는 것이죠!</p>
<p>사실 기본 크롬이라면 사이트가 로딩 되기전 JS를 실행하는 Extension들을 사용할 수 있어요. 하지만 Headless크롬에서는 아직 Extension을 지원하지 않습니다 :’(</p>
<p>그래서 차선책으로 <a href="http://docs.mitmproxy.org/en/latest/mitmproxy.html">mitmproxy</a>라는 Proxy 프로그램을 사용해볼거에요.</p>
<h3 id="mitmproxy-사용하기"><a href="#mitmproxy-사용하기" class="headerlink" title="mitmproxy 사용하기"></a>mitmproxy 사용하기</h3><p>진행하기 전 앞서 만들었던 모든 JS코드가 들어있는 <code>content.js</code>를 아래처럼 만들어주세요.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CDP = <span class="built_in">require</span>(<span class="string">'chrome-remote-interface'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userAgent = <span class="string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.50 Safari/537.36'</span></span><br><span class="line"></span><br><span class="line">CDP(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">client</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;Network, Page&#125; = client;</span><br><span class="line">  <span class="keyword">await</span> Page.enable();</span><br><span class="line">  <span class="keyword">await</span> Network.enable();</span><br><span class="line">  <span class="keyword">await</span> Network.setUserAgentOverride(&#123;userAgent&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// user-agent is now set</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// overwrite the `languages` property to use a custom getter</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'languages'</span>, &#123;</span><br><span class="line">  <span class="keyword">get</span>: function() &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'ko-KR'</span>, <span class="string">'ko'</span>];</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// overwrite the `plugins` property to use a custom getter</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'plugins'</span>, &#123;</span><br><span class="line">  <span class="keyword">get</span>: function() &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getParameter = WebGLRenderingContext.getParameter;</span><br><span class="line">WebGLRenderingContext.prototype.getParameter = <span class="function"><span class="keyword">function</span>(<span class="params">parameter</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// UNMASKED_VENDOR_WEBGL</span></span><br><span class="line">  <span class="keyword">if</span> (parameter === <span class="number">37445</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Intel Open Source Technology Center'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// UNMASKED_RENDERER_WEBGL</span></span><br><span class="line">  <span class="keyword">if</span> (parameter === <span class="number">37446</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Mesa DRI Intel(R) Ivybridge Mobile '</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> getParameter(parameter);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[<span class="string">'height'</span>, <span class="string">'width'</span>].forEach(<span class="function"><span class="params">property</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// store the existing descriptor</span></span><br><span class="line">  <span class="keyword">const</span> imageDescriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(HTMLImageElement.prototype, property);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// redefine the property with a patched descriptor</span></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(HTMLImageElement.prototype, property, &#123;</span><br><span class="line">    ...imageDescriptor,</span><br><span class="line">    <span class="keyword">get</span>: function() &#123;</span><br><span class="line">      <span class="comment">// return an arbitrary non-zero dimension if the image failed to load</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.complete &amp;&amp; <span class="keyword">this</span>.naturalHeight == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// otherwise, return the actual dimension</span></span><br><span class="line">      <span class="keyword">return</span> imageDescriptor.get.apply(<span class="keyword">this</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// store the existing descriptor</span></span><br><span class="line"><span class="keyword">const</span> elementDescriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(HTMLElement.prototype, <span class="string">'offsetHeight'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// redefine the property with a patched descriptor</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(HTMLDivElement.prototype, <span class="string">'offsetHeight'</span>, &#123;</span><br><span class="line">  ...elementDescriptor,</span><br><span class="line">  <span class="keyword">get</span>: function() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.id === <span class="string">'modernizr'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> elementDescriptor.get.apply(<span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>우선 Mitmproxy를 pip로 설치해주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install mitmproxy</span><br></pre></td></tr></table></figure>

<p>그리고 proxy 처리를 해 줄 파일인 <code>inject.py</code>파일을 만들어주세요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inject.py</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> mitmproxy <span class="keyword">import</span> ctx</span><br><span class="line"></span><br><span class="line"><span class="comment"># load in the javascript to inject</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'content.js'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content_js = f.read()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">response</span><span class="params">(flow)</span>:</span></span><br><span class="line">    <span class="comment"># only process 200 responses of html content</span></span><br><span class="line">    <span class="keyword">if</span> flow.response.headers[<span class="string">'Content-Type'</span>] != <span class="string">'text/html'</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flow.response.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># inject the script tag</span></span><br><span class="line">    html = BeautifulSoup(flow.response.text, <span class="string">'lxml'</span>)</span><br><span class="line">    container = html.head <span class="keyword">or</span> html.body</span><br><span class="line">    <span class="keyword">if</span> container:</span><br><span class="line">        script = html.new_tag(<span class="string">'script'</span>, type=<span class="string">'text/javascript'</span>)</span><br><span class="line">        script.string = content_js</span><br><span class="line">        container.insert(<span class="number">0</span>, script)</span><br><span class="line">        flow.response.text = str(html)</span><br><span class="line"></span><br><span class="line">        ctx.log.info(<span class="string">'Successfully injected the content.js script.'</span>)</span><br></pre></td></tr></table></figure>

<p>이제 터미널에서 아래 명령어로 mitmproxy 서버를 띄워주세요.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mitmdump -p 8080 -s &quot;inject.py&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>이 서버는 크롤링 코드를 실행 할 때 항상 켜져있어야 해요!</p>
</blockquote>
<p>이제 우리 크롤링 코드에 <code>add_argument</code>로 Proxy옵션을 추가해 주세요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">TEST_URL = <span class="string">'https://intoli.com/blog/making-chrome-headless-undetectable/chrome-headless-test.html'</span></span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">'headless'</span>)</span><br><span class="line">options.add_argument(<span class="string">'window-size=1920x1080'</span>)</span><br><span class="line">options.add_argument(<span class="string">"disable-gpu"</span>)</span><br><span class="line">options.add_argument(<span class="string">"user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36"</span>)</span><br><span class="line">options.add_argument(<span class="string">"proxy-server=localhost:8080"</span>)</span><br><span class="line">driver = webdriver.Chrome(<span class="string">'chromedriver'</span>, chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(TEST_URL)</span><br><span class="line">print(driver.page_source)</span><br><span class="line"></span><br><span class="line">user_agent = driver.find_element_by_css_selector(<span class="string">'#user-agent'</span>).text</span><br><span class="line">plugins_length = driver.find_element_by_css_selector(<span class="string">'#plugins-length'</span>).text</span><br><span class="line">languages = driver.find_element_by_css_selector(<span class="string">'#languages'</span>).text</span><br><span class="line">webgl_vendor = driver.find_element_by_css_selector(<span class="string">'#webgl-vendor'</span>).text</span><br><span class="line">webgl_renderer = driver.find_element_by_css_selector(<span class="string">'#webgl-renderer'</span>).text</span><br><span class="line"></span><br><span class="line">print(<span class="string">'User-Agent: '</span>, user_agent)</span><br><span class="line">print(<span class="string">'Plugin length: '</span>, plugins_length)</span><br><span class="line">print(<span class="string">'languages: '</span>, languages)</span><br><span class="line">print(<span class="string">'WebGL Vendor: '</span>, webgl_vendor)</span><br><span class="line">print(<span class="string">'WebGL Renderer: '</span>, webgl_renderer)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p>하지만 사실 이 코드는 정상적으로 동작하지 않을거에요. 헤드리스모드를 끄면 잘 돌아가지만 헤드리스모드를 켜면 정상적으로 동작하지 않아요. 바로 SSL오류 때문입니다.</p>
<p>크롬에서 SSL을 무시하도록 만들수 있고, 로컬의 HTTP를 신뢰 가능하도록 만들 수도 있지만 아직 크롬 Headless모드에서는 지원하지 않습니다.</p>
<p>정확히는 아직 webdriver에서 지원하지 않습니다. </p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>아직까지는 크롬 Headless모드에서 HTTPS 사이트를 ‘완전히 사람처럼’보이게 한뒤 크롤링 하는 것은 어렵습니다. 하지만 곧 업데이트 될 크롬에서는 익스텐션 사용 기능이 추가될 예정이기 때문에 이 기능이 추가되면 복잡한 과정 없이 JS를 바로 추가해 진짜 일반적인 크롬처럼 동작하도록 만들 수 있으리라 생각합니다.</p>
<p>사실 서버 입장에서 위와 같은 요청을 보내는 경우 처리를 할 수 있는 방법은 JS로 헤드리스 유무를 확인하는 방법이 전부입니다. 즉, 서버 입장에서도 ‘식별’은 가능하지만 이로 인해 유의미한 차단은 하기 어렵습니다. 현재로서는 UserAgent 값만 변경해주어도 대부분의 사이트에서는 자연스럽게 크롤링을 진행할 수 있으리라 생각합니다.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="http://antoinevastel.github.io/bot%20detection/2017/08/05/detect-chrome-headless.html">Detecting Chrome Headless</a></li>
<li><a href="https://intoli.com/blog/making-chrome-headless-undetectable/">MAKING CHROME HEADLESS UNDETECTABLE</a></li>
</ul>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/08/26/SSH-Reverse-Proxy-like-ngrok/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-08-26-SSH-Reverse-Proxy-like-ngrok.jpg" alt="로컬 개발서버를 HTTPS로 세상에 띄우기(like ngork)">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-08-25T15:00:00.000Z">2017-08-26</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/tips/">tips</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/08/26/SSH-Reverse-Proxy-like-ngrok/">로컬 개발서버를 HTTPS로 세상에 띄우기(like ngork)</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 가이드를 따라가기 위해서는 HTTP(80/tcp) 포트가 열려있는 서버와 개인 도메인이 필요합니다.</p>
</blockquote>
<h2 id="들어가기-전"><a href="#들어가기-전" class="headerlink" title="들어가기 전"></a>들어가기 전</h2><p>django, node.js, react, vue와 같은 웹 개발(Backend &amp; Frontend)을 진행하다보면 모바일 디바이스나 타 디바이스에서 로컬 서버에 접근해야하는 경우가 있습니다. </p>
<p>하지만 보통 개발환경에서는 개발기기가 공인 IP를 갖고 있는것이 아니라 내부 NAT에서 개발이 이루어지고, 웹과 내부 개발기기 사이에는 방화벽이 있습니다. 집에서 개발한다면 공유기가, 회사에서 개발한다면 회사의 라우터 정책 기준이 있습니다. </p>
<p>일반적인 경우 네트워크 정책은 나가는(Outbound) 트래픽은 대부분의 포트가 열려있는 한편 들어오는(Inbound) 트래픽에는 극소수의 포트만 열려있습니다.</p>
<p>만약 로컬 서버에서 일반적으로 HTTP가 사용하는 80/tcp 포트로 서버를 띄어놓았다면 대부분의 경우 이 포트는 막혀있습니다. (개발용 서버인 8000/8080/4000/3000등도 마찬가지입니다. 극소수 빼고는 기본적으로 다 막아둡니다.)</p>
<p>이렇게 포트가 막혀있다면 우리가 로컬에 띄어둔 서버가 아무리 모든 IP에서의 접근을 허용한다고 해도 중간에 있는 라우터에서 막아버리기 때문에 LTE등의 모바일 셀룰러같은 외부에서의 접속은 사실상 불가능합니다.</p>
<p>따라서 이를 해결하기 위해 <a href="https://ngrok.com/">ngrok</a>와 같은 SSH 터널링을 이용합니다. 하지만 ngrok 서비스 서버는 기본적으로 해외에 있고, 무료 Plan의 경우 분당 connection의 개수를 40개로 제한하고 있습니다. 만약 CSS나 JS, 이미지같은 static파일 요청 하나하나가 각각 connection을 사용한다면, 짧은 시간 내 여러번 새로고침은 수십개의 connection을 만들어버리고 ngrok은 요청을 즉시 차단해버립니다.</p>
<blockquote>
<p>물론 <code>keep-alive</code>를 지원하는 클라이언트/서버 설정이 이루어지면 connection은 새로고침을 해도 늘어나지 않습니다. 하지만 모든 클라이언트가 <code>keep-alive</code>를 지원하지는 않습니다.</p>
</blockquote>
<p>하지만 유료 플랜이라고 해서 무제한 connection을 지원하지는 않기 때문에 마음놓고 새로고침을 하기는 어렵습니다.</p>
<p>이번 가이드에서는 ngrok같이 로컬 개발 서버(장고의 runserver, webpack의 webpack-dev-server)를 다른 서버에 SSH Proxy를 통해 전달하는 법, 그리고 CloudFlare를 통해 HTTPS서버로 만드는 것까지를 다룹니다.</p>
<h2 id="재료준비"><a href="#재료준비" class="headerlink" title="재료준비"></a>재료준비</h2><h3 id="80-tcp가-열린-서버가-있어야-합니다"><a href="#80-tcp가-열린-서버가-있어야-합니다" class="headerlink" title="80/tcp가 열린 서버가 있어야 합니다"></a>80/tcp가 열린 서버가 있어야 합니다</h3><p>이번 가이드에서는 80/tcp 포트가 열려있는 서버가 “꼭” 있어야 합니다. 물론 서버에는 공인 IP가 할당되어야 합니다. 그래야 나중에 CloudFlare에서 DNS설정을 해줄 수 있습니다.</p>
<blockquote>
<p>만약 집에 이런 서버를 둔다면 포트포워딩을 통해 80/tcp만 열어줘도 됩니다.</p>
</blockquote>
<p>한국서버가 가장 좋지만(물리적으로 가까우니까) 일본 VPS도 속도면에서 큰 손해를 보지는 않습니다. (물론 게임서버라면 약간 이야기가 다르지만, 웹 서버용으로는 충분합니다.)</p>
<p>이번엔 ubuntu server os를 세팅하는 방법으로 진행합니다. (ubuntu 14.04, 16.04 모두 가능합니다.)</p>
<h3 id="HTTPS를-쓰려면-도메인이-있어야-합니다"><a href="#HTTPS를-쓰려면-도메인이-있어야-합니다" class="headerlink" title="(HTTPS를 쓰려면) 도메인이 있어야 합니다"></a>(HTTPS를 쓰려면) 도메인이 있어야 합니다</h3><p>개인 도메인이 있어야 CloudFlare라는 DNS서비스에 등록을 하고 HTTPS를 이용할 수 있습니다. 도메인이 없거나 HTTPS를 사용하지 않아도 되는 상황이라면 공인 IP만 있어도 무방합니다.</p>
<h2 id="만들어보기"><a href="#만들어보기" class="headerlink" title="만들어보기"></a>만들어보기</h2><p>ubuntu 서버와 도메인이 준비되었다면 이제 시작해봅시다!</p>
<h3 id="서버-세팅하기"><a href="#서버-세팅하기" class="headerlink" title="서버 세팅하기"></a>서버 세팅하기</h3><p>서버 세팅은 크게 어렵지 않습니다. ssh로 서버에 접속해 아래 명령어를 그대로 입력해보세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshd -T | grep -E <span class="string">'gatewayports|allowtcpforwarding'</span></span><br></pre></td></tr></table></figure>

<p>위 명령어는 sshd의 <code>gatewayports</code>속성과 <code>allowtcpforwarding</code>속성값을 가져옵니다. 만약 여러분이 ubuntu를 설치하고 아무런 설정을 건드리지 않았다면 다음과 같이 뜰거에요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gatewayports no</span><br><span class="line">allowtcpforwarding yes</span><br></pre></td></tr></table></figure>

<p>우리는 저 두개를 모두 <code>yes</code>로 만들어야 합니다. 아래 명령어를 ssh에 그대로 입력해주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">echo</span> <span class="string">"gatewayports yes\nallowtcpforwarding yes"</span> &gt;&gt; /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>

<p>물론 <code>/etc/ssh/sshd_config</code> 파일에서 직접 수정해주셔도 됩니다.</p>
<blockquote>
<p>유의: 이와같이 사용하면 서버의 모든 유저가 SSH Proxy를 사용할수 있게 됩니다. 이를 막으려면 아래와 같이 <code>Match User 유저이름</code>을 넣고 진행해주세요. </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Match User beomi</span><br><span class="line">  AllowTcpForwarding yes</span><br><span class="line">  GatewayPorts yes</span><br></pre></td></tr></table></figure>

<p>정말 간단하게 서버 설정이 끝났습니다 :)</p>
<h3 id="로컬-8000포트를-원격-80포트로-연결하기"><a href="#로컬-8000포트를-원격-80포트로-연결하기" class="headerlink" title="로컬 8000포트를 원격 80포트로 연결하기"></a>로컬 8000포트를 원격 80포트로 연결하기</h3><p>로컬 터미널에서 아래와 같이 명령어를 입력하면 설정이 끝납니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ssh 원격서버유저이름@서버ip -N -R 서버포트:localhost:로컬포트 </span></span><br><span class="line">ssh beomi@47.156.24.36 -N -R 80:localhost:8000</span><br></pre></td></tr></table></figure>

<p>위 명령어는 <code>47.156.24.36</code>라는 ip를 가진 서버에 <code>beomi</code>라는 사용자로 ssh접속을 하고, 로컬의 8000번 포트를 원격 서버의 80포트로 연결하는 명령어입니다.</p>
<p>즉, <code>localhost:8000</code> 은 <code>47.156.24.36:80</code>와 같아진거죠!</p>
<p>이제 모바일 디바이스에서도 <code>http://47.156.24.36</code>라고 입력하면 개발 서버에 들어올 수 있어요.</p>
<h3 id="CloudFlare로-SSL-붙이기"><a href="#CloudFlare로-SSL-붙이기" class="headerlink" title="CloudFlare로 SSL 붙이기"></a>CloudFlare로 SSL 붙이기</h3><p>만약 서버주소를 외우는게 불편하지 않으시고 &amp; HTTPS가 필요하지 않으시다면, 아래부분은 진행하지 않아도 괜찮습니다.</p>
<p>이 챕터에서는 <a href="https://www.cloudflare.com/">CloudFlare</a>에 도메인을 연결할 때 제공받을 수 있는 SSL서비스를 통해 HTTP로 서빙되는 우리 서비스를 ‘안전한’ HTTPS로 서빙하도록 도와줍니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-08-26-SSH-Reverse-Proxy-like-ngrok-cloudflare-flexssl.png" alt=""></p>
<p>CloudFlare의 Flex SSL을 사용하면 우리 서버가 HTTPS가 아닌 HTTP로 서빙되더라도 클라우드 플레어에서 HTTPS로 만들어줍니다.</p>
<blockquote>
<p>사실 이 기능은 보안을 위해서 있는 서비스라고 보기는 어렵습니다. 물론 브라우저/클라이언트와 CloudFlare 간 통신에서는 좀 더 안전한 통신이 가능하지만, 도메인별로 다른 SSL 인증서를 사용하지 않고 여러 도메인을 그룹핑한 인증서를 사용하고 있는 문제가 있고, 결국 CloudFlare와 우리 서버간에는 HTTP로 통신이 이루어지기 때문에 CloudFlare와 우리 서버 사이 Node에서 이루어지는 공격은 막기 어렵습니다. 따라서 이런 경우는 Geolocation와 같은 HTTPS 위에서만 사용할 수 있는 기능등을 테스트 서버를 통해 구동할 경우 유용합니다.</p>
</blockquote>
<p>우선 CloudFlare에 가입하고 도메인을 CloudFlare에 등록해주세요.</p>
<p>도메인을 등록하고 <code>DNS</code> 탭에 들어가서 다음과 같이 서브 도메인(혹은 루트 도메인)을 서버 ip에 연결한 후 우측 하단의 구름모양을 켜 주세요. 이 구름모양을 켜 주면 이 도메인으로 온 요청은 CloudFlare의 CDN망을 통해 전달됩니다. (CSS/JS캐싱도 해줍니다!)</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-08-27%2014.08.01.png?dl=1" alt=""></p>
<p>도메인을 등록했으면 아래와 같이 <code>Crypto</code>탭에서 SSL을 <code>Flexible</code>로 바꿔주세요.</p>
<ul>
<li>off: 말 그대로 HTTPS를 끕니다.</li>
<li><strong>flexible</strong>: 우리 서버가 HTTP라도 클라우드플레어로 온 HTTPS요청을 우리서버에 HTTP로 바꿔서 보내줍니다.</li>
<li>full: 우리 서버도 HTTPS가 지원되어야 하지만, 꼭 CA에게 인증된 ‘안전한’ 인증서일 필요는 없습니다. 자체서명 인증서라도 괜찮아요.</li>
<li>full (strict): 우리 서버가 CA에게 인증된 ‘안전한’ 인증서를 통해 HTTPS로 서빙을 해야만 합니다. 자체서명 인증서는 쓸 수 없어요.</li>
</ul>
<p>이 설정은 off에서 다른 옵션으로 바꿔주면 약간의 시간이 걸리지만 안전한 SSL 인증서를 CloudFlare에서 만들어줍니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-08-27%2013.58.36.png?dl=1" alt=""></p>
<h2 id="proxy-명령어에-연결하기"><a href="#proxy-명령어에-연결하기" class="headerlink" title="proxy 명령어에 연결하기"></a><code>proxy</code> 명령어에 연결하기</h2><p>보통 <code>runserver</code>와 같은 개발 서버를 띄우는 명령은 자주 사용하지만 우리가 사용하는 긴 명령어는 한번에 치기도 어렵고 옵션 기억하기도 귀찮은 경우가 많습니다. 쉘에서 지원하는 <code>alias</code>를 통해 아래와 같이 만들어줍시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .zshrc / .bashrc / .bash_profile 와 같이 쉘이 켜질때 실행되는 부분에 넣어주세요</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> proxy=<span class="string">"ssh beomi@47.156.24.36 -N -R 80:localhost:8000"</span></span><br><span class="line"><span class="comment"># alias proxy="ssh 원격서버유저이름@서버ip -N -R 서버포트:localhost:로컬포트"</span></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">이와 같이 입력하고 저장한 후 터미널을 다시 켜주면 이제 `proxy`라는 명령어를 치면 로컬 개발 서버가 HTTPS로 세상에 오픈되는 것을 볼 수 있습니다 :)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 마치며</span></span><br><span class="line"></span><br><span class="line">ngrok는 아주 간편하고 좋은 서비스입니다. 하지만 모바일과 PC 웹을 동시에 테스트 하는 경우 connection개수를 금방 넘어버리고 ngrok를 새로 실행할 때마다 도메인 이름이 바뀌는점이 불편해 위와 같이 Proxy서버를 만들어 개발하는데 사용합니다.</span><br><span class="line"></span><br><span class="line">다만 CloudFlare의 CSS/JS캐싱 전략에 의해 변경된 파일이 가져와지지 않는 점은 있는데, 이때는 Apache등의 웹서버에서 제공하는 virtualhost기능과 <span class="built_in">let</span><span class="string">'s encrypt의 무료 SSL 서비스를 조합해 사용하면 CloudFlare없이도 동일하게 환경을 만들어 줄 수 있습니다. 하지만 웹서버 자체에 대한 이해가 필요하며 SSL을 붙이는 일도 상당히 귀찮기때문에 단순하게 CloudFlare에서 도에인 모드를 아래와 같이 '</span>Development Mode<span class="string">'로 설정해 주면 캐싱 하는 것을 방지할 수 있습니다.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">![](https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-08-27%2014.42.36.png?dl=1)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### 여담</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">django의 경우에는 `settings.py`파일의 `ALLOWED_HOSTS`에 우리가 지정한 도메인 (ex: shop.testi.kr)을 추가해줘야 합니다.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">```python</span></span><br><span class="line"><span class="string"># settings.py</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ALLOWED_HOSTS = ['</span>*<span class="string">'] # 모든 Host에서의 접근을 허용</span></span><br><span class="line"><span class="string"># ALLOWED_HOSTS = ['</span>shop.testi.kr<span class="string">'] # shop.testi.kr 도메인 host를 통한 접근을 허용</span></span><br></pre></td></tr></table></figure>

<p>webpack의 webpack-dev-server에서 위와같이 사용하려면 <code>webpack.config.js</code>파일을 아래와 같이 만들어주면 됩니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        host: <span class="string">"0.0.0.0"</span>, <span class="comment">// 모든 host에서의 접근을 허용</span></span><br><span class="line">        disableHostCheck: <span class="literal">true</span> <span class="comment">// Host Check를 끕니다</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/08/25/DjangoCBV-queryset-vs-get_queryset/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/queryset_vs_get_queryset_on_django_cbv.jpg" alt="Django CBV: queryset vs get_queryset() 삽질기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-08-24T15:00:00.000Z">2017-08-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/django/">django</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/08/25/DjangoCBV-queryset-vs-get_queryset/">Django CBV: queryset vs get_queryset() 삽질기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>요약: <code>queryset</code>은 request 발생시 한번만 쿼리셋이 동작하고, <code>get_queryset()</code>은 매 request마다 쿼리를 발생시킨다. 조건이 걸린 쿼리셋을 쓸때는 <code>get_queryset()</code>을 오버라이딩하자.</p>
</blockquote>
<h2 id="사건의-발단"><a href="#사건의-발단" class="headerlink" title="사건의 발단"></a>사건의 발단</h2><p>ListView안에서 체크박스로 ForeignKey로 연결된 장고 모델 인스턴스를 저장(<code>.save()</code>를 호출)하는데 저장 후 모델 인스턴스의 값을 확인하는 뷰에서는 결과값이 저장 전의 데이터로 나타났었다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 문제의 코드..</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderMatchingList</span><span class="params">(ListView)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Order</span><br><span class="line"></span><br><span class="line">    queryset_list = Order.objects.filter(status__gte=<span class="number">5</span>) \</span><br><span class="line">        .select_related(<span class="string">'education'</span>, <span class="string">'region'</span>) \</span><br><span class="line">        .prefetch_related(<span class="string">'orderdetail_set'</span>)</span><br><span class="line">    queryset = sorted(queryset_list, key=<span class="keyword">lambda</span> x: x.start_date())</span><br></pre></td></tr></table></figure>

<p>사실 지금은 코드를 보면 <code>queryset</code>에서 <code>sorted</code>된 값을 반환하고, 이경우에는 쿼리셋 자체가 저 변수로 할당되어버려 다음 request에서 쿼리가 돌지 않는다는 것을 쉽게 찾을 수 있다. 하지만 원래 한번 안보이면 잘 안보이는 법.. 심지어 이 경우에는 Exception이 나는 것도 아니기 때문에 더 찾기 어려웠다.. (ㅠㅠ)</p>
<h2 id="삽질의-시작"><a href="#삽질의-시작" class="headerlink" title="삽질의 시작"></a>삽질의 시작</h2><p>여러가지 가정을 할 수 있는 상황이었다.</p>
<ul>
<li>혹시 브라우저가 리스트를 캐싱하고 있던건 아닐까? (브라우저 캐시)</li>
<li>장고가 View의 Response를 캐싱하고 있는걸까? (장고 캐시)</li>
<li>혹시 DB에 <code>save()</code>가 안된(아예 DB가 업데이트가 되지 않은) 것은 아닐까?</li>
<li>장고 <code>queryset</code>에 캐싱이 되어있었을까?</li>
<li>AJAX call이 비정상적으로 이루어진 것은 아닐까?</li>
<li>아니면, 아예 내 View 로직이 잘못된 것은 아닐까? (CBV인데?)</li>
<li><code>select_related</code>나 <code>prefetch_related</code>에서 캐싱이 발생하는걸까?</li>
<li>…</li>
</ul>
<p>이런저런 가정을 하고 하나씩 체크를 해보기로 했다.</p>
<blockquote>
<p>아래부분에서는 django 로직과 관련된 삽질만 다뤘습니다. JS쪽은 문제가 없었거든요.</p>
</blockquote>
<h2 id="widgets"><a href="#widgets" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="첫번째-삽질-“브라우저가-캐싱을-하고-있는건-아닐까-”"><a href="#첫번째-삽질-“브라우저가-캐싱을-하고-있는건-아닐까-”" class="headerlink" title="첫번째 삽질: “브라우저가 캐싱을 하고 있는건 아닐까?”"></a>첫번째 삽질: “브라우저가 캐싱을 하고 있는건 아닐까?”</h3><p>만약 브라우저가 HTML파일을 캐싱하고 있다면</p>
<ul>
<li>캐시 삭제후 강력 새로고침을 하거나,</li>
<li>다른 브라우저로 접근하면</li>
</ul>
<p>정상적인 화면이 나와야 했다.</p>
<blockquote>
<p>그러나… “#망했어요”</p>
</blockquote>
<p>브라우저가 캐싱하고 있는게 아니었고, 다른 브라우저에서도 기존(업데이트 전)값을 가져왔다.</p>
<h2 id="widgets-1"><a href="#widgets-1" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="두번째-삽질-“장고가-template-렌더링-된것을-캐싱하는게-아닐까-”"><a href="#두번째-삽질-“장고가-template-렌더링-된것을-캐싱하는게-아닐까-”" class="headerlink" title="두번째 삽질: “장고가 template 렌더링 된것을 캐싱하는게 아닐까?”"></a>두번째 삽질: “장고가 template 렌더링 된것을 캐싱하는게 아닐까?”</h3><p>사실 장고에서 response는 따로 캐싱을 명시적으로 하지 않으면 쿼리가 새로 발생해야 하는 경우에는 캐싱을 하지 않는다. </p>
<p>하지만 일단 template을 재 렌더링 하지 않는게 아닐까… 하는 생각에 아래와 같은 부분을 추가해 보았다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;&#123;% for object in object_list %&#125;</span><br><span class="line">&#123;&#123; object &#125;&#125; 이건 object다 </span><br><span class="line">&#123;% endfor %&#125;&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>역시 .. “응 아니야~ 장고 일 잘하고 있음”</p>
</blockquote>
<p>템플릿은 렌더링이 충분히 잘 되고 있었다.</p>
<p>뭐가 문제일까?</p>
<h2 id="widgets-2"><a href="#widgets-2" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="세번째-삽질-“-save-메소드의-사용을-잘못한게-아닐까-”"><a href="#세번째-삽질-“-save-메소드의-사용을-잘못한게-아닐까-”" class="headerlink" title="세번째 삽질: “.save() 메소드의 사용을 잘못한게 아닐까?”"></a>세번째 삽질: “<code>.save()</code> 메소드의 사용을 잘못한게 아닐까?”</h3><p>아예 다음번에는 DB에 저장이 되지 않고 있는게 아닌가.. 하는 생각에 <code>save()</code>와 <code>update()</code>의 사용법을 찾고, <code>force_insert=True</code>와 같은 옵션을 넣어보기도 했다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># view.py 파일에서...</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="keyword">for</span> m_pay <span class="keyword">in</span> mentor_payment_list:</span><br><span class="line">        <span class="keyword">if</span> str(m_pay.pk) <span class="keyword">in</span> cleaned_keys:</span><br><span class="line">            m_pay.status = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            m_pay.status = <span class="number">0</span></span><br><span class="line">        m_pay.save(update_fields=[<span class="string">'status'</span>])</span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>

<p><code>.save()</code>는 모델 인스턴스에 적용하는 케이스이고, <code>.update()</code>는 쿼리셋에 적용하는 방법이다. <code>save()</code>의 경우 모델 인스턴스를 가져오기 위해 SELECT 쿼리를 한번 날리고 값을 변경 후 UPDATE를 해주는 방법이라면, <code>update()</code>는 쿼리 자체를 SELECT쿼리로 날리는 방식이다. 따라서 만약의 경우 <code>.update()</code>를 실행 중 다른 요청에서 값이 변경되었다면 그 Transaction이 손실될 수 있고, 모델 인스턴스의 값 자체를 이용해 업데이트하는 방법은 사용하기 어렵다. (물론 사용은 가능하지만 SELECT쿼리같이 <code>.get()</code>으로 한번 가져와야 하기때문에 큰 의미는 없습니다. 여전히 중간에 값이 변경되었을 경우에 기존 값(get)에 대한 불가능하고요.)</p>
<p><code>m_pay.save(update_fields=[&#39;status&#39;])</code>에서는 <code>save()</code>에 <code>update_fields</code> 리스트를 넣어주었다. 일반적인 <code>save()</code>함수가 인스턴스 전체를 변경하는 <code>UPDATE</code>문을 사용하지만 <code>update_fields</code>가 있는 경우에는 <code>force_insert</code>가 자동으로 <code>True</code>가 되며 동시에 해당되는 Column만 update가 일어난다.</p>
<p>게다가 <code>update_fields</code>를 넣기 전에도 이미 잘 작동하던 코드.</p>
<blockquote>
<p>무엇이 문제일까? 문제는 미궁속으로..</p>
</blockquote>
<h2 id="widgets-3"><a href="#widgets-3" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="네번째-삽질-“select-related나-prefetch-related에서-캐싱이-발생하는건-아닐까-”"><a href="#네번째-삽질-“select-related나-prefetch-related에서-캐싱이-발생하는건-아닐까-”" class="headerlink" title="네번째 삽질: “select_related나 prefetch_related에서 캐싱이 발생하는건 아닐까?”"></a>네번째 삽질: “<code>select_related</code>나 <code>prefetch_related</code>에서 캐싱이 발생하는건 아닐까?”</h3><p>장고에서 <code>select_related</code>나 <code>prefetch_related</code>는 기본적으로 한번에 데이터를 가져와 queryset 자체에 캐싱을 하는 전략인데.. 혹시 여기에서 ‘과도한 캐싱’이 발생하고 있는건 아닐까?</p>
<p>그렇다면 장고의 캐싱을 강제로 없애는 <code>never_cache</code> 데코레이터를 사용하면 어떨까? 하지만 지금 뷰는 CBV니까.. <code>@method_decorator</code>로 <code>never_cache</code>를 전달해 주면 되겠다!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.decorators.cache <span class="keyword">import</span> never_cache</span><br><span class="line"></span><br><span class="line"><span class="meta">@method_decorator(never_cache, name='dispatch')</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderMatchingList</span><span class="params">(SuperuserRequiredMixin, LoginRequiredMixin, ListView)</span>:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>

<p>물론, 당연히, 캐시 문제가 아니었기 때문에 <strong>안되는 것</strong>은 당연했다.</p>
<h2 id="widgets-4"><a href="#widgets-4" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="다섯번째-삽질-여섯번째-일곱-…-그리고-더-많은-삽질-끝에서의-허무"><a href="#다섯번째-삽질-여섯번째-일곱-…-그리고-더-많은-삽질-끝에서의-허무" class="headerlink" title="다섯번째 삽질, 여섯번째, 일곱 … 그리고 더 많은 삽질 끝에서의 허무"></a>다섯번째 삽질, 여섯번째, 일곱 … 그리고 더 많은 삽질 끝에서의 허무</h3><p>도대체 뭐가 문제인거지? <code>ListView</code>가 아예 문제인가? 이런 고민을 하다가 결국 django의 <code>ListView</code>자체를 뜯어보는데 눈에 들어오는 <code>MultipleObjectMixin</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultipleObjectMixin</span><span class="params">(ContextMixin)</span>:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    queryset = <span class="literal">None</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>

<p>헐. <code>queryset</code>와 <code>get_queryset</code>은 다른데.</p>
<h2 id="widgets-5"><a href="#widgets-5" class="headerlink" title="widgets:"></a>widgets:</h2><h2 id="해결-amp-평화"><a href="#해결-amp-평화" class="headerlink" title="해결 &amp; 평화"></a>해결 &amp; 평화</h2><p>사실 이 문제가 생긴건 DB에서 정렬하는 대신 파이썬 View에서 쿼리셋을 정렬하는 방식으로 사용하려다보니 생긴 문제였다.</p>
<p>모델 내부의 <code>start_date()</code>에 따라 정렬하는 방식을 쿼리셋 내부에서 구현이 어려워 파이썬의 <code>sorted</code>를 이용했는데, 이 sorted된 결과물이 <code>queryset</code> 변수에 담겨 새 request에도 같은 결과를 반환하게 된 것.</p>
<p>따라서 다음과 같이 <code>get_queryset</code>으로 변환해주어서 깔끔하게 해결되었다. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderMatchingList</span><span class="params">(ListView)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Order</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span><span class="params">(self)</span>:</span></span><br><span class="line">        queryset_list = Order.objects.filter(status__gte=<span class="number">5</span>) \</span><br><span class="line">            .select_related(<span class="string">'education'</span>, <span class="string">'region'</span>) \</span><br><span class="line">            .prefetch_related(<span class="string">'orderdetail_set'</span>)</span><br><span class="line">        <span class="keyword">return</span> sorted(queryset_list, key=<span class="keyword">lambda</span> x: x.start_date())</span><br></pre></td></tr></table></figure>

<p>사실 DJDT(Django Debug Toolbar)를 사용하며 쿼리의 개수를 확인해보는데 첫 요청시에는 6개의 쿼리가 가는데 비해 두번째 요청부터는 3개의 쿼리만이 실행되고, 그마저도 데이터를 가져오는 쿼리는 없고 세션/로그인등의 비교만 쿼리를 실행하고 있다는 것을 발견해 쿼리셋쪽의 문제라는 것을 알 수 있었다.</p>
<h3 id="여담"><a href="#여담" class="headerlink" title="여담"></a>여담</h3><p>문제의 코드 부분(아래)에서 <code>select_related</code>와 <code>prefetch_related</code>를 제거하면 쿼리수는 몇십개로 증가하지만 데이터 자체는 정상적으로 가져왔다. 이건 또 왜그랬을까?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 문제의 코드..</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderMatchingList</span><span class="params">(ListView)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Order</span><br><span class="line"></span><br><span class="line">    queryset_list = Order.objects.filter(status__gte=<span class="number">5</span>) \</span><br><span class="line">        .select_related(<span class="string">'education'</span>, <span class="string">'region'</span>) \</span><br><span class="line">        .prefetch_related(<span class="string">'orderdetail_set'</span>)</span><br><span class="line">    queryset = sorted(queryset_list, key=<span class="keyword">lambda</span> x: x.start_date())</span><br></pre></td></tr></table></figure>
        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/07/16/Use-Autoenv/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/use-autoenv.jpg" alt="Autoenv로 편리한 개발하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-07-15T15:00:00.000Z">2017-07-16</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/macos/">macos</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/07/16/Use-Autoenv/">Autoenv로 편리한 개발하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 가이드는 macOS를 대상으로 합니다.</p>
</blockquote>
<p>프로젝트를 여러가지를 동시에 진행하고 프로젝트에서 사용하는 개발환경이 다양해지다 보니 사용하게 되는 도구들이 많습니다.</p>
<p>Python에서는 <code>virtualenv</code>, <code>pyenv</code>등이 대표적이고 Node.js에서는 <code>nvm</code>이나 <code>n</code>등이 대표적인 사례입니다.</p>
<p>즉 시스템에 전역으로 설치되어있는 것과 다른 버전 혹은 다른 패키지들이 설치된 가상환경에서 개발을 진행해 각 프로젝트별로 다른 환경에서 개발을 진행합니다.</p>
<p>하지만 이러한 도구들을 사용하기 위해서는 프로젝트를 실행하기 전 특별한 명령어들(ex: <code>workon venv_name</code>등)을 사용해야 합니다.</p>
<p>Autoenv는 이러한 명령어들을 각 프로젝트 폴더 진입시 자동으로 실행할 수 있도록 도와줍니다.</p>
<h2 id="Autoenv가-작동하는-방법"><a href="#Autoenv가-작동하는-방법" class="headerlink" title="Autoenv가 작동하는 방법"></a>Autoenv가 작동하는 방법</h2><p>Autoenv는 시스템의 <code>cd</code>명령어를 바꿔, 폴더 안에 진입한 후 폴더 안에 <code>.env</code>파일이 있는지를 탐색하고 만약 <code>.env</code>파일이 있으면 그 파일을 한줄한줄 사람이 터미널에 치듯 실행새줍니다.</p>
<p>예를 들어, <code>hello</code>라는 폴더 안의 <code>.env</code>에 아래와 같이 되어있다고 가정해 봅시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env파일</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Hello World!"</span></span><br></pre></td></tr></table></figure>

<p>이후 이 <code>hello</code>폴더에 진입할 때마다 <code>Hello World!</code>가 출력됩니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~ $ <span class="built_in">cd</span> hello</span><br><span class="line">Hello World!</span><br><span class="line">~/hello $</span><br></pre></td></tr></table></figure>

<p>이처럼 여러가지 방법으로 이용할 수 있습니다. </p>
<h2 id="Autoenv-설치하기"><a href="#Autoenv-설치하기" class="headerlink" title="Autoenv 설치하기"></a>Autoenv 설치하기</h2><p>Autoenv는 다음 두 절차를 통해 쉽게 설치할 수 있습니다.</p>
<p>우선 <code>brew</code>로 설치해 줍시다. (HomeBrew는 <a href="http://brew.sh">brew.sh</a>에서 설치할 수 있습니다.)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install autoenv</span><br></pre></td></tr></table></figure>

<p>다음으로는 autoenv 실행 스크립트를 <code>.zshrc</code>나 <code>.bash_profile</code> 파일의 끝부분에 적어줍시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .zshrc 나 .bash_profile 의 파일 가장 끝</span></span><br><span class="line"><span class="built_in">source</span> /usr/<span class="built_in">local</span>/opt/autoenv/activate.sh</span><br></pre></td></tr></table></figure>

<blockquote>
<p>만약 아직 ZSH을 설치하지 않았다면 <a href="/2017/07/07/Beautify-ZSH/">멋진 Terminal 만들기</a>을 읽어보세요!</p>
</blockquote>
<h2 id="유의사항"><a href="#유의사항" class="headerlink" title="유의사항"></a>유의사항</h2><p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/Screenshot%202017-07-16%2017.44.52.png" alt=""></p>
<p><code>.env</code>파일 설정 후 첫 폴더 진입시 <code>.env</code>파일을 신뢰하고 실행할지 않을 지에 대한 동의가 나타납니다. 이 부분은 <code>.env</code>파일이 악의적으로 변경되었을때 사용자에게 알리기 위해서 있기 때문에 즐거운 마음으로 Y를 눌러줍시다.</p>
<h2 id="SSH키파일-등록하기"><a href="#SSH키파일-등록하기" class="headerlink" title="SSH키파일 등록하기"></a>SSH키파일 등록하기</h2><p>SSH키파일을 <code>.bash_profile</code>등에 등록해 터미널이 켜질때마다 불러오는 방법도 있지만, 그 대신 <code>ssh-add</code>명령어를 통해 직접 현재 터미널에만 제한적으로 불러오는 방법이 있습니다. </p>
<p>만약 <code>~/.ssh</code>폴더 안에 <code>my_key_file.pem</code>이라는 키 파일들이 있다면 아래와 같이 <code>.env</code>를 구성할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env파일</span></span><br><span class="line">ssh-add ~/.ssh/my_key_file.pem</span><br></pre></td></tr></table></figure>

<p>이와 같이 구성하면 폴더에 진입시마다 아래와 같이 키 파일이 등록된다는 것을 확인할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~ $ <span class="built_in">cd</span> project</span><br><span class="line">Identity added: /Users/beomi/.ssh/my_key_file.pem (/Users/beomi/.ssh/my_key_file.pem)</span><br><span class="line">~/project $</span><br></pre></td></tr></table></figure>

<h2 id="Python-가상환경-관리하기"><a href="#Python-가상환경-관리하기" class="headerlink" title="Python 가상환경 관리하기"></a>Python 가상환경 관리하기</h2><h3 id="venv를-사용할-경우"><a href="#venv를-사용할-경우" class="headerlink" title="venv를 사용할 경우"></a>venv를 사용할 경우</h3><p>파이썬 3.4이후부터 내장된 venv를 이용한 경우 다음과 같이 <code>.env</code>를 구성할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env파일</span></span><br><span class="line"><span class="built_in">source</span> ./가상환경폴더이름/bin/activate</span><br></pre></td></tr></table></figure>

<h3 id="virtualenv를-이용할-경우"><a href="#virtualenv를-이용할-경우" class="headerlink" title="virtualenv를 이용할 경우"></a>virtualenv를 이용할 경우</h3><p>venv와 동일합니다. 아래와 같이 <code>.env</code>를 구성해 주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env파일</span></span><br><span class="line"><span class="built_in">source</span> ./가상환경폴더이름/bin/activate</span><br></pre></td></tr></table></figure>

<h3 id="virtualenv-wrapper를-이용중인-경우"><a href="#virtualenv-wrapper를-이용중인-경우" class="headerlink" title="virtualenv-wrapper를 이용중인 경우"></a>virtualenv-wrapper를 이용중인 경우</h3><p><code>workon</code>명령어를 그대로 사용할 수 있습니다. 아래와 같이 <code>.env</code>를 설정해 주세요. (저는 이 방법을 사용하고 있습니다.)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env파일</span></span><br><span class="line">workon 가상환경이름</span><br></pre></td></tr></table></figure>

<h3 id="Pyenv를-이용중인-경우"><a href="#Pyenv를-이용중인-경우" class="headerlink" title="Pyenv를 이용중인 경우"></a>Pyenv를 이용중인 경우</h3><p>pyenv에서는 <code>local</code>이라는 명령어를 통해 기본적으로 폴더별 Python 버전을 관리해 줍니다. 따라서 <code>.env</code>를 통해 Global설정을 하는 경우를 제외하면 사용하지 않는 것을 추천합니다.</p>
<h2 id="Node-js-개발환경-관리하기"><a href="#Node-js-개발환경-관리하기" class="headerlink" title="Node.js 개발환경 관리하기"></a>Node.js 개발환경 관리하기</h2><h3 id="n을-사용할-경우"><a href="#n을-사용할-경우" class="headerlink" title="n을 사용할 경우"></a>n을 사용할 경우</h3><p>node버전을 관리해 주는 <code>n</code>은 <code>sudo</code>권한을 필요로 합니다. 시스템 전역에서 사용하는 node의 버전을 변경하기 때문입니다. 그래서 패스워드를 입력해 주는 과정이 필요할 수 있습니다. <code>.env</code>파일을 아래와 같이 만들어 주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo n latest <span class="comment"># 버전은 사용 환경에 맞게 입력해 주세요.</span></span><br></pre></td></tr></table></figure>

<h2 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h2><p>사실 Python을 주력 언어로 사용하다 보니 다른 언어들에 대해 언급은 적은 측면이 있습니다. 하지만 Autoenv 자체가 굉장히 심플한 스크립트로 이루어져 있기 때문에 필요에 맞춰 바꾸어 사용하는 것도 방법중 하나라고 생각합니다.</p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/4/">이전</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/6/">다음</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/4/">4</a></li>
            
            <li><a class="pagination-link is-current" href="/page/5/">5</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/6/">6</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/10/">10</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/profile_beomi.jpg" alt="Junbum Lee">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Junbum Lee
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Beomi&#39;s tech blog
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Seoul, KR</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/beomi">
                
                <i class="fab fa-github"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                카테고리
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/DataCollection/">
            <span class="level-start">
                <span class="level-item">DataCollection</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DataCollection/Twitter/">
            <span class="level-start">
                <span class="level-item">Twitter</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/">
            <span class="level-start">
                <span class="level-item">DevEnv</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DevEnv/DataScience/">
            <span class="level-start">
                <span class="level-item">DataScience</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/DeepLearning/">
            <span class="level-start">
                <span class="level-item">DeepLearning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/Git/">
            <span class="level-start">
                <span class="level-item">Git</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/Ubuntu/">
            <span class="level-start">
                <span class="level-item">Ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Django/">
            <span class="level-start">
                <span class="level-item">Django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Django/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/DjangoTDDStudy/">
            <span class="level-start">
                <span class="level-item">DjangoTDDStudy</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DjangoTDDStudy/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/MacOS/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/NLP/">
            <span class="level-start">
                <span class="level-item">NLP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/NLP/LanguageModel/">
            <span class="level-start">
                <span class="level-item">LanguageModel</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/NLP/Unsupervised/">
            <span class="level-start">
                <span class="level-item">Unsupervised</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Postmortem/">
            <span class="level-start">
                <span class="level-item">Postmortem</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Python/Celery/">
            <span class="level-start">
                <span class="level-item">Celery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/Fabric/">
            <span class="level-start">
                <span class="level-item">Fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Tech/">
            <span class="level-start">
                <span class="level-item">Tech</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Translation/">
            <span class="level-start">
                <span class="level-item">Translation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/aws/">
            <span class="level-start">
                <span class="level-item">aws</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/aws/python/">
            <span class="level-start">
                <span class="level-item">python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/azure/">
            <span class="level-start">
                <span class="level-item">azure</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/blog/">
            <span class="level-start">
                <span class="level-item">blog</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/blog/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/django/">
            <span class="level-start">
                <span class="level-item">django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/django/fabric/">
            <span class="level-start">
                <span class="level-item">fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/django/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/flask/">
            <span class="level-start">
                <span class="level-item">flask</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/flask/sqlalchemy/">
            <span class="level-start">
                <span class="level-item">sqlalchemy</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/howtomakewebcrawler/">
            <span class="level-start">
                <span class="level-item">howtomakewebcrawler</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/javascript/">
            <span class="level-start">
                <span class="level-item">javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/javascript/webpack/">
            <span class="level-start">
                <span class="level-item">webpack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/life/">
            <span class="level-start">
                <span class="level-item">life</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/machinelearning/">
            <span class="level-start">
                <span class="level-item">machinelearning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/machinelearning/seminar/">
            <span class="level-start">
                <span class="level-item">seminar</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/macos/">
            <span class="level-start">
                <span class="level-item">macos</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/macos/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/nlp/">
            <span class="level-start">
                <span class="level-item">nlp</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/nlp/languagemodel/">
            <span class="level-start">
                <span class="level-item">languagemodel</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/postmortem/">
            <span class="level-start">
                <span class="level-item">postmortem</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/">
            <span class="level-start">
                <span class="level-item">python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">25</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/python/aws/">
            <span class="level-start">
                <span class="level-item">aws</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/celery/">
            <span class="level-start">
                <span class="level-item">celery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/dataanalysis/">
            <span class="level-start">
                <span class="level-item">dataanalysis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/django/">
            <span class="level-start">
                <span class="level-item">django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/fabric/">
            <span class="level-start">
                <span class="level-item">fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/flask/">
            <span class="level-start">
                <span class="level-item">flask</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/howtomakewebcrawler/">
            <span class="level-start">
                <span class="level-item">howtomakewebcrawler</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/pyspark/">
            <span class="level-start">
                <span class="level-item">pyspark</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/ubuntu/">
            <span class="level-start">
                <span class="level-item">ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/react/">
            <span class="level-start">
                <span class="level-item">react</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/react/javascript/">
            <span class="level-start">
                <span class="level-item">javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/tips/githubpages/">
            <span class="level-start">
                <span class="level-item">githubpages</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/ubuntu/">
            <span class="level-start">
                <span class="level-item">ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/ubuntu/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/vlang/">
            <span class="level-start">
                <span class="level-item">vlang</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            최근 글
        </h3>
        
        <article class="media">
            
            <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/16/1*VZpuai6qP4iNLc7opAkQxA.jpeg" alt="KcBERT Finetune with PyTorch-Lightning v1.3.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-15T15:00:00.000Z">2021-03-16</time></div>
                    <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT Finetune with PyTorch-Lightning v1.3.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/15/fine-tuning_methods-20210315151211294.png" alt="KcBERT MLM Finetune으로 Domain adaptation하기">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-14T15:00:00.000Z">2021-03-15</time></div>
                    <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT MLM Finetune으로 Domain adaptation하기</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/12/04/Transformers4/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/image-20201204002610609.277ab6.png" alt="BertForSequenceClassification on Transformers v4.0.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-12-03T15:00:00.000Z">2020-12-04</time></div>
                    <a href="/2020/12/04/Transformers4/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BertForSequenceClassification on Transformers v4.0.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/NLP/">NLP</a> / <a class="has-link-grey -link" href="/categories/NLP/LanguageModel/">LanguageModel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/07/01/Review-the-Interview/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/typora/headway-5QgIuuBxKwM-unsplash.74d0f8.jpg" alt="면접에서 나온 통계 질문 리뷰">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-30T15:00:00.000Z">2020-07-01</time></div>
                    <a href="/2020/07/01/Review-the-Interview/" class="title has-link-black-ter is-size-6 has-text-weight-normal">면접에서 나온 통계 질문 리뷰</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/postmortem/">postmortem</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/Gitlab-for-LFS/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2020-05-27-12-22-58-KDTi9H.jpg" alt="딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-28T15:00:00.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/Gitlab-for-LFS/" class="title has-link-black-ter is-size-6 has-text-weight-normal">딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/DevEnv/">DevEnv</a> / <a class="has-link-grey -link" href="/categories/DevEnv/Git/">Git</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            아카이브
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/03/">
                <span class="level-start">
                    <span class="level-item">3월 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/12/">
                <span class="level-start">
                    <span class="level-item">12월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">7월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">5월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">2월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">1월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">12월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">10월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">7월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">6월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">11월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">3월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">2월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">1월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">12월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">11월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">10월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">9월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">8월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">7월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">6월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">4월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">3월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">2월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">1월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">12월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">11월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">9월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">8월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">7월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">6월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">5월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            최근 글
        </h3>
        
        <article class="media">
            
            <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/16/1*VZpuai6qP4iNLc7opAkQxA.jpeg" alt="KcBERT Finetune with PyTorch-Lightning v1.3.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-15T15:00:00.000Z">2021-03-16</time></div>
                    <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT Finetune with PyTorch-Lightning v1.3.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/15/fine-tuning_methods-20210315151211294.png" alt="KcBERT MLM Finetune으로 Domain adaptation하기">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-14T15:00:00.000Z">2021-03-15</time></div>
                    <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT MLM Finetune으로 Domain adaptation하기</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/12/04/Transformers4/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/image-20201204002610609.277ab6.png" alt="BertForSequenceClassification on Transformers v4.0.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-12-03T15:00:00.000Z">2020-12-04</time></div>
                    <a href="/2020/12/04/Transformers4/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BertForSequenceClassification on Transformers v4.0.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/NLP/">NLP</a> / <a class="has-link-grey -link" href="/categories/NLP/LanguageModel/">LanguageModel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/07/01/Review-the-Interview/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/typora/headway-5QgIuuBxKwM-unsplash.74d0f8.jpg" alt="면접에서 나온 통계 질문 리뷰">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-30T15:00:00.000Z">2020-07-01</time></div>
                    <a href="/2020/07/01/Review-the-Interview/" class="title has-link-black-ter is-size-6 has-text-weight-normal">면접에서 나온 통계 질문 리뷰</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/postmortem/">postmortem</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/Gitlab-for-LFS/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2020-05-27-12-22-58-KDTi9H.jpg" alt="딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-28T15:00:00.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/Gitlab-for-LFS/" class="title has-link-black-ter is-size-6 has-text-weight-normal">딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/DevEnv/">DevEnv</a> / <a class="has-link-grey -link" href="/categories/DevEnv/Git/">Git</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            아카이브
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/03/">
                <span class="level-start">
                    <span class="level-item">3월 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/12/">
                <span class="level-start">
                    <span class="level-item">12월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">7월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">5월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">2월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">1월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">12월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">10월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">7월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">6월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">11월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">3월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">2월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">1월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">12월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">11월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">10월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">9월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">8월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">7월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">6월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">4월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">3월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">2월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">1월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">12월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">11월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">9월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">8월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">7월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">6월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">5월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    Beomi&#39;s Tech Blog
                
                </a>
                <p class="is-size-7">
                &copy; 2021 Junbum Lee&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("ko");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://beomi.github.io',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Kembali ke atas" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>








<script src="/js/main.js" defer></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

    
</body>
</html>