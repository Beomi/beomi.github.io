<!DOCTYPE html>
<html  lang="ko">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Beomi&#39;s Tech blog</title>








<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89162642-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-89162642-1');
</script>

    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    


<link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="is-3-column">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                Beomi&#39;s Tech Blog
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="https://junbuml.ee">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/04/20/HowToMakeWebCrawler-Notice-with-Telegram/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/telegram.png" alt="나만의 웹 크롤러 만들기(5): 웹페이지 업데이트를 알려주는 Telegram 봇">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-04-19T15:00:00.000Z">2017-04-20</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/howtomakewebcrawler/">howtomakewebcrawler</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/04/20/HowToMakeWebCrawler-Notice-with-Telegram/">나만의 웹 크롤러 만들기(5): 웹페이지 업데이트를 알려주는 Telegram 봇</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>좀 더 보기 편한 <a href="https://beomi.github.io/gb-crawling/">깃북 버전의 나만의 웹 크롤러 만들기</a>가 나왔습니다!</p>
</blockquote>
<blockquote>
<p>이전게시글: <a href="/2017/03/01/HowToMakeWebCrawler-Save-with-Django/">나만의 웹 크롤러 만들기(4): Django로 크롤링한 데이터 저장하기</a></p>
</blockquote>
<blockquote>
<p>이번 가이드에서는 작업하는 컴퓨터가 아닌 원격 우분투16.04 서버(vps)에 올리는 부분까지 다룹니다. 테스트는 <code>crontab -e</code> 명령어를 사용할 수 있는 환경에서 가능하며, VISA/Master카드등 해외결제가 가능한 카드가 있다면 서비스 가입 후 실제로 배포도 가능합니다. 이 가이드에서는 Vultr VPS를 이용합니다.</p>
</blockquote>
<p>앞서 <code>Django</code>를 이용해 크롤링한 데이터를 DB에 저장해 보았습니다.</p>
<p>하지만 크롤링을 할 때마다 동일한(중복된) 데이터를 DB에 저장하는 것은 바람직 하지 않은 일이죠.</p>
<p>또한, 크롤링을 자동으로 해 사이트에 변경사항이 생길 때 마다 내 텔레그램으로 알림을 받을 수 있다면 더 편리하지 않을까요?</p>
<p>이번 가이드에서는 클리앙 중고장터 등을 크롤링해 새 게시글이 올라올 경우 새글 알림을 텔레그램으로 보내는 것까지를 다룹니다.</p>
<p>다루는 내용:</p>
<ul>
<li>Telegram Bot API</li>
<li>requests / BeautifulSoup</li>
<li>Crontab</li>
</ul>
<h2 id="시작하며"><a href="#시작하며" class="headerlink" title="시작하며"></a>시작하며</h2><h2 id="widgets"><a href="#widgets" class="headerlink" title="widgets:"></a>widgets:</h2><p>텔레그램은 REST API를 통해 봇을 제어하도록 안내합니다.</p>
<p>물론 직접 텔레그램 api를 사용할 수도 있지만, 이번 가이드에서는 좀 더 빠른 개발을 위해 <code>python-telegram-bot</code> 패키지를 사용합니다.</p>
<p><code>python-telegram-bot</code>은 Telegram Bot API를 python에서 쉽게 이용하기 위한 wrapper 패키지입니다.</p>
<h2 id="python-telegram-bot-설치하기"><a href="#python-telegram-bot-설치하기" class="headerlink" title="python-telegram-bot 설치하기"></a>python-telegram-bot 설치하기</h2><h2 id="widgets-1"><a href="#widgets-1" class="headerlink" title="widgets:"></a>widgets:</h2><p><code>python-telegram-bot</code>은 pip로 설치 가능합니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-telegram-bot</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>requests</code>, <code>bs4</code> 역시 설치되어있어야 합니다!</p>
</blockquote>
<h2 id="텔레그램-봇-만들기-amp-API-Key받기"><a href="#텔레그램-봇-만들기-amp-API-Key받기" class="headerlink" title="텔레그램 봇 만들기 &amp; API Key받기"></a>텔레그램 봇 만들기 &amp; API Key받기</h2><h2 id="widgets-2"><a href="#widgets-2" class="headerlink" title="widgets:"></a>widgets:</h2><p>텔레그램 봇을 만들고 API키를 받아 이용하는 기본적인 방법은 <a href="https://blog.psangwoo.com/coding/2016/12/08/python-telegram-bot-1.html">python에서 telegram bot 사용하기</a>에 차근차근 설명되어있습니다.</p>
<p>위 가이드에서 텔레그램 봇의 토큰을 받아오세요. 토큰은 <code>aaaa:bbbbbbbbbbbbbb</code>와 같이 생긴 문자열입니다.</p>
<blockquote>
<p>이번 가이드는 텔레그램 봇을 다루는 내용보다는 Cron으로 크롤링을 하고 변화 발견시 텔레그램 메시지를 보내는 것에 초점을 맞췄습니다.</p>
</blockquote>
<p>텔레그램 봇 API키를 받아왔다면 아래와 같이 크롤링을 하는 간단한 python파일을 작성해 봅시다. 클리앙에 새로운 글이 올라오면 “새 글이 올라왔어요!”라는 메시지를 보내는 봇을 만들어 보겠습니다.</p>
<h2 id="클리앙-새글-탐지코드-만들기"><a href="#클리앙-새글-탐지코드-만들기" class="headerlink" title="클리앙 새글 탐지코드 만들기"></a>클리앙 새글 탐지코드 만들기</h2><h2 id="widgets-3"><a href="#widgets-3" class="headerlink" title="widgets:"></a>widgets:</h2><p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2000.46.01.png" alt="clien marcket web page list"></p>
<p>우선 게시판의 글 제목중 첫번째 제목을 가져오고 txt파일로 저장하는 코드를 만들어 봅시다.</p>
<p>회원 장터 주소는 <code>http://clien.net/cs2/bbs/board.php?bo_table=sold</code>이고, 첫 게시글의 CSS Selector는 <code>#content &gt; div.board_main &gt; table &gt; tbody &gt; tr:nth-child(3) &gt; td.post_subject &gt; a</code>임을 알 수 있습니다. 따라서 아래와 같이 <code>latest</code> 변수에 담아 같은 폴더의 <code>latest.txt</code> 파일에 써 줍시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clien_market_parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">req = requests.get(<span class="string">'http://clien.net/cs2/bbs/board.php?bo_table=sold'</span>)</span><br><span class="line">req.encoding = <span class="string">'utf-8'</span> <span class="comment"># Clien에서 encoding 정보를 보내주지 않아 encoding옵션을 추가해줘야합니다.</span></span><br><span class="line"></span><br><span class="line">html = req.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">posts = soup.select(<span class="string">'td.post_subject'</span>)</span><br><span class="line">latest = posts[<span class="number">1</span>].text <span class="comment"># 0번은 회원중고장터 규칙입니다.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(latest)</span><br></pre></td></tr></table></figure>

<p>위와 같이 코드를 구성하면 <code>latest.txt</code>파일에 가장 최신 글의 제목이 저장됩니다.</p>
<p>크롤링 이후 새로운 글이 생겼는지의 유무를 알아보려면 크롤링한 최신글의 제목과 파일에 저장된 제목이 같은지를 확인하면 됩니다.</p>
<p>만약 같다면 패스, 다르다면 텔레그램으로 메시지를 보내는거죠!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clien_market_parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">req = requests.get(<span class="string">'http://clien.net/cs2/bbs/board.php?bo_table=sold'</span>)</span><br><span class="line">req.encoding = <span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line">html = req.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">posts = soup.select(<span class="string">'td.post_subject'</span>)</span><br><span class="line">latest = posts[<span class="number">1</span>].text</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'r+'</span>) <span class="keyword">as</span> f_read:</span><br><span class="line">    before = f_read.readline()</span><br><span class="line">    <span class="keyword">if</span> before != latest:</span><br><span class="line">        <span class="comment"># 같은 경우는 에러 없이 넘기고, 다른 경우에만</span></span><br><span class="line">        <span class="comment"># 메시지 보내는 로직을 넣으면 됩니다.</span></span><br><span class="line">    f_read.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> f_write:</span><br><span class="line">    f_write.write(latest)</span><br><span class="line">    f_write.close()</span><br></pre></td></tr></table></figure>

<h2 id="새글이라면-텔레그램으로-메시지-보내기"><a href="#새글이라면-텔레그램으로-메시지-보내기" class="headerlink" title="새글이라면? 텔레그램으로 메시지 보내기!"></a>새글이라면? 텔레그램으로 메시지 보내기!</h2><h2 id="widgets-4"><a href="#widgets-4" class="headerlink" title="widgets:"></a>widgets:</h2><p>이제 메시지를 보내볼게요. <code>telegram</code>을 import하신 후 <code>bot</code>을 선언해주시면 됩니다. token은 위에서 받은 토큰입니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clien_market_parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> telegram</span><br><span class="line"></span><br><span class="line"><span class="comment"># 토큰을 지정해서 bot을 선언해 줍시다! (물론 이 토큰은 dummy!)</span></span><br><span class="line">bot = telegram.Bot(token=<span class="string">'123412345:ABCDEFgHiJKLmnopqr-0StUvwaBcDef0HI4jk'</span>)</span><br><span class="line"><span class="comment"># 우선 테스트 봇이니까 가장 마지막으로 bot에게 말을 건 사람의 id를 지정해줄게요.</span></span><br><span class="line"><span class="comment"># 만약 IndexError 에러가 난다면 봇에게 메시지를 아무거나 보내고 다시 테스트해보세요.</span></span><br><span class="line">chat_id = bot.getUpdates()[<span class="number">-1</span>].message.chat.id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">req = requests.get(<span class="string">'http://clien.net/cs2/bbs/board.php?bo_table=sold'</span>)</span><br><span class="line">req.encoding = <span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line">html = req.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">posts = soup.select(<span class="string">'td.post_subject'</span>)</span><br><span class="line">latest = posts[<span class="number">1</span>].text</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'r+'</span>) <span class="keyword">as</span> f_read:</span><br><span class="line">    before = f_read.readline()</span><br><span class="line">    <span class="keyword">if</span> before != latest:</span><br><span class="line">        bot.sendMessage(chat_id=chat_id, text=<span class="string">'새 글이 올라왔어요!'</span>)</span><br><span class="line">    <span class="keyword">else</span>: <span class="comment"># 원래는 이 메시지를 보낼 필요가 없지만, 테스트 할 때는 봇이 동작하는지 확인차 넣어봤어요.</span></span><br><span class="line">        bot.sendMessage(chat_id=chat_id, text=<span class="string">'새 글이 없어요 ㅠㅠ'</span>)</span><br><span class="line">    f_read.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> f_write:</span><br><span class="line">    f_write.write(latest)</span><br><span class="line">    f_write.close()</span><br></pre></td></tr></table></figure>

<p>이제 <code>clien_market_parser.py</code>파일을 실행할 때 새 글이 올라왔다면 “새 글이 올라왔어요!”라는 알림이, 새 글이 없다면 “새 글이 없어요 ㅠㅠ”라는 알림이 옵니다.</p>
<blockquote>
<p>지금은 자동으로 실행되지 않기 때문에 <code>python clien_market_parser.py</code>명령어로 직접 실행해 주셔야 합니다.</p>
</blockquote>
<h2 id="자동으로-크롤링하고-메시지-보내기"><a href="#자동으로-크롤링하고-메시지-보내기" class="headerlink" title="자동으로 크롤링하고 메시지 보내기"></a>자동으로 크롤링하고 메시지 보내기</h2><h2 id="widgets-5"><a href="#widgets-5" class="headerlink" title="widgets:"></a>widgets:</h2><h3 id="가장-쉬운방법-while-sleep"><a href="#가장-쉬운방법-while-sleep" class="headerlink" title="가장 쉬운방법: while + sleep"></a>가장 쉬운방법: <code>while</code> + <code>sleep</code></h3><p>가장 쉬운 방법은 python의 <code>while</code>문을 쓰는 방법입니다. 물론, 가장 나쁜 방법이에요. 안전하지도 않고 시스템의 메모리를 좀먹을 수도 있어요.</p>
<p>하지만 테스트에서는 가장 쉽게 쓸 수 있어요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clien_market_parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> telegram</span><br><span class="line"></span><br><span class="line">bot = telegram.Bot(token=<span class="string">'123412345:ABCDEFgHiJKLmnopqr-0StUvwaBcDef0HI4jk'</span>)</span><br><span class="line">chat_id = bot.getUpdates()[<span class="number">-1</span>].message.chat.id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    req = requests.get(<span class="string">'http://clien.net/cs2/bbs/board.php?bo_table=sold'</span>)</span><br><span class="line">    req.encoding = <span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line">    html = req.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">    posts = soup.select(<span class="string">'td.post_subject'</span>)</span><br><span class="line">    latest = posts[<span class="number">1</span>].text</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'r+'</span>) <span class="keyword">as</span> f_read:</span><br><span class="line">        before = f_read.readline()</span><br><span class="line">        <span class="keyword">if</span> before != latest:</span><br><span class="line">            bot.sendMessage(chat_id=chat_id, text=<span class="string">'새 글이 올라왔어요!'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bot.sendMessage(chat_id=chat_id, text=<span class="string">'새 글이 없어요 ㅠㅠ'</span>)</span><br><span class="line">        f_read.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> f_write:</span><br><span class="line">        f_write.write(latest)</span><br><span class="line">        f_write.close()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">60</span>) <span class="comment"># 60초(1분)을 쉬어줍니다.</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>파이썬 동작중에는 CTRL+C로 빠져나올수 있습니다.</p>
</blockquote>
<h3 id="추천-시스템의-cron-스케쥴러를-이용하기"><a href="#추천-시스템의-cron-스케쥴러를-이용하기" class="headerlink" title="추천: 시스템의 cron/스케쥴러를 이용하기"></a>추천: 시스템의 cron/스케쥴러를 이용하기</h3><p>이번 가이드에서 핵심인 부분인데요, 이 부분은 이제 우분투 16.04 기준으로 진행할게요.</p>
<p>우선 Ubuntu 16.04가 설치된 시스템이 필요합니다. 이번 강의에서는 Vultr VPS를 이용합니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2001.31.34.png" alt="add deploy new vps"></p>
<p>Vultr는 가상 서버 회사인데, Tokyo리전의 VPS를 제공해줘 빠르게 이용이 가능합니다. 트래픽도 굉장히 많이주고요.</p>
<p>가이드를 만드는 지금은 월 2.5달러 VPS는 아쉽게도 없어서, 월5달러 VPS로 진행하지만 월2.5달러 VPS로도 충분합니다!</p>
<p>아래의 Deploy Now를 누르면 새 Cloud Instance(VPS)가 생성되는데요, 서버가 생성된 후 들어가 보면 다음과 같이 id와 pw가 나와있습니다. 패스워드는 눈 모양을 누르면 잠시 보입니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2001.43.54.png" alt=""></p>
<p>이 정보로 ssh에 접속해 봅시다. (윈도는 putty이나 Xshell등을 이용해주세요.)</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2001.46.08.png" alt=""></p>
<p>우분투 16.04버전에는 이미 Python3.5버전이 설치되어있기 때문에 <code>pip3</code>, <code>setuptools</code>을 설치해 주고 Ubuntu의 Locale을 설정해줘야 합니다. 아래 명령어를 한줄씩 순차적으로 치시면 완료됩니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3-pip python3-setuptools build-essential</span><br><span class="line">sudo locale-gen <span class="string">"ko_KR.UTF-8"</span></span><br><span class="line">pip3 install requests bs4 python-telegram-bot</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2001.48.11.png" alt=""></p>
<p>설치를 하신 후 코드를 테스트 해보려면 위 파일을 <code>vi</code>등으로 열어 위 코드들을 입력하시면 됩니다.</p>
<p>이제 코드를 약간 바꿔볼게요. 새 글이 올라올때만 파일을 다시 쓰도록 해요.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clien_market_parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> telegram</span><br><span class="line"></span><br><span class="line">bot = telegram.Bot(token=<span class="string">'123412345:ABCDEFgHiJKLmnopqr-0StUvwaBcDef0HI4jk'</span>)</span><br><span class="line">chat_id = bot.getUpdates()[<span class="number">-1</span>].message.chat.id</span><br><span class="line"></span><br><span class="line"><span class="comment"># 파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">req = requests.get(<span class="string">'http://clien.net/cs2/bbs/board.php?bo_table=sold'</span>)</span><br><span class="line">req.encoding = <span class="string">'utf-8'</span></span><br><span class="line"></span><br><span class="line">html = req.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">posts = soup.select(<span class="string">'td.post_subject'</span>)</span><br><span class="line">latest = posts[<span class="number">1</span>].text</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'r'</span>) <span class="keyword">as</span> f_read:</span><br><span class="line">    before = f_read.readline()</span><br><span class="line">    f_read.close()</span><br><span class="line">    <span class="keyword">if</span> before != latest:</span><br><span class="line">        bot.sendMessage(chat_id=chat_id, text=<span class="string">'새 글이 올라왔어요!'</span>)</span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'latest.txt'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> f_write:</span><br><span class="line">            f_write.write(latest)</span><br><span class="line">            f_write.close()</span><br></pre></td></tr></table></figure>

<p>이제 이 <code>clien_market_parser.py</code> 파일을 <code>python3</code>으로 실행해야 하기 때문에, <code>python3</code>이 어디 설치되어있는지 확인 해 봅시다.(아마 <code>/usr/bin/python3</code>일거에요!)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@vultr:~<span class="comment"># which python3</span></span><br><span class="line">/usr/bin/python3</span><br></pre></td></tr></table></figure>

<p>이제 Crontab에 이 파이썬으로 우리 파일을 매 1분마다 실행하도록 만들어 봅시다.</p>
<blockquote>
<p>crontab 수정은 <code>crontab -e</code>명령어로 사용 가능합니다. 만약 에디터를 선택하라고 한다면 초보자는 Nano를, vi를 쓰실수 있으시다면 vi를 이용하세요.</p>
</blockquote>
<p>이 한줄을 crontab 마지막에 추가해 주세요.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * /usr/bin/python3 /root/clien_market_parser.py</span><br></pre></td></tr></table></figure>

<blockquote>
<p>힌트: 매 12분마다로 하시려면 <code>*/12 * * * * /usr/bin/python3 /root/clien_market_parser.py</code>로 하시면 됩니다.</p>
</blockquote>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-04-21%2002.03.23.png" alt=""></p>
<p>이제 여러분의 휴대폰으로 새 글이 올라올 때 마다 알람이 올라올 거랍니다 :)</p>
<h2 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h2><h2 id="widgets-6"><a href="#widgets-6" class="headerlink" title="widgets:"></a>widgets:</h2><p>이번편 가이드는 DB를 이용하지 않고 단순하게 새로운 글이 왔다는 사실만을 메시지로 알려주는 봇을 만들어서 뭔가 아쉬움이 있을겁니다. </p>
<p>다음편 가이드는 <code>multiprocessing</code>을 이용한 N배 빠른 크롤러을 만들어 봅니다.</p>
<blockquote>
<p>다음 가이드: <a href="/2017/07/05/HowToMakeWebCrawler-with-Multiprocess/">나만의 웹 크롤러 만들기(6): N배빠른 크롤링, multiprocessing!</a></p>
</blockquote>
<!--

-->
        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/28/Make-Capture-to-GDrive-App/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/Tips/app_store.jpg" alt="편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 앱으로 만들고 키보드 단축키 연결하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-27T15:00:00.000Z">2017-03-28</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/tips/">tips</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/tips/githubpages/">githubpages</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/28/Make-Capture-to-GDrive-App/">편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 앱으로 만들고 키보드 단축키 연결하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>본 가이드는 MacOS에서 이용가능합니다.</p>
</blockquote>
<p>이전 가이드: <a href="/2017/03/27/Use-GoogleDrive-as-Image-Server/">편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 업로드 ShellScript편</a></p>
<blockquote>
<p>터미널에서 <code>gdrive list</code>라고 했을때 에러가 나지 않는 상태에서 아래 가이드를 진행해주세요.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>이전 가이드에서 스크린샷을 찍고 구글드라이브에 올린 후 이미지의 공유 URL을 가져오는 스크립트를 작성했습니다.</p>
<p>하지만 키보드 Shortcuts를 이용한 편리성에는 따라가기가 어렵죠. <code>.sh</code>스크립트를 키보드로 연동하는 방법 중 여러가지 방법이 있지만, 이번에는 <code>MacOS App</code>으로 만든 후 앱을 실행하는 것을 <code>서비스</code>에 등록하고 <code>Automator</code>를 통해 키보드와 앱실행 서비스를 연동하는 과정을 다룹니다.</p>
<blockquote>
<p>만약 잘 동작하는 맥용 앱을 바로 다운받으시려면 <a href="/others/CaptureToGdrive.zip">CaptureToGdrive.zip</a>을 받아주신 후 압축을 푸신 후 앱을 Application폴더로 옮기신 후 <a href="http://macnews.tistory.com/4277">[백투더맥 Q&amp;A] 키보드 단축키로 응용 프로그램을 실행하는 바로 가기 만들기</a> 과정을 따라가시면 됩니다.</p>
</blockquote>
<h2 id="SH파일을-앱으로-만들기"><a href="#SH파일을-앱으로-만들기" class="headerlink" title="SH파일을 앱으로 만들기"></a>SH파일을 앱으로 만들기</h2><p>우선 <code>.sh</code>파일로 된 스크립트를 맥용 앱으로 Wrapping해주는 작업이 필요합니다. 이번 가이드에서는 이 작업을 간소화해주는 <a href="http://sveinbjorn.org/platypus">platypus</a>를 이용합니다.</p>
<p>platypus는 <a href="http://sveinbjorn.org/files/software/platypus.zip">platypus.zip</a>을 받고 압축을 풀어 사용하시면 됩니다.</p>
<p>앱을 실행하면 아래와 같은 화면이 뜹니다.</p>
<p><img src="https://drive.google.com/uc?id=0B91qXw6kE4VfWWV2RWpnX056X2s" alt=""></p>
<p>App Name을 <code>CaptureToGdrive</code>로, Script Type을 <code>bash</code>로, Script Path는 아래의 <code>+New</code>를 눌러 아래와 같이 코드를 입력해 줍시다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">screencapture -tpng -i /tmp/temp_shot_gdrive.png</span><br><span class="line">DATEFILENAME=`date +<span class="string">"%Y%m%d%H%M"</span>`</span><br><span class="line">ID=`/usr/<span class="built_in">local</span>/bin/gdrive upload /tmp/temp_shot_gdrive.png --name screenshot<span class="variable">$&#123;DATEFILENAME&#125;</span>.png --share | egrep <span class="string">"^Uploaded"</span> | awk <span class="string">'&#123;print $2&#125;'</span>`</span><br><span class="line">URL=<span class="string">"https://drive.google.com/uc?id=<span class="variable">$&#123;ID&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;URL&#125;</span> | pbcopy</span><br></pre></td></tr></table></figure>

<p>위 코드는 이전 가이드에서 다뤘던 것과 약간 다른데요, <code>gdrive</code>명령어의 위치를 명확히 <code>/usr/local/bin/gdrive</code>로 바꿔준점이 다릅니다. 쉘 스크립트를 사용할 때 명확히 하지 않으면 gdrive의 PATH를 잡지 못해 에러가 나기 때문입니다.</p>
<blockquote>
<p>만약 다른 위치에 까셨다면 <code>which gdrive</code>명령을 통해 그 위치로 변경해주시면 됩니다.</p>
</blockquote>
<p><img src="https://drive.google.com/uc?id=0B91qXw6kE4VfRElUbERjYjhmSnM" alt=""></p>
<p>스크립트를 입력하고 나면 AppName이 초기화되는 사소한 문제가 있으니 다시 AppName을 등록해 줍시다.</p>
<p>스크린샷 촬영은 인터페이스가 필요없기 때문에 <code>Interface</code>는 <code>None</code>으로, root권한이 필요없고 백그라운드일 필요도 없고 프로그램이 굳이 계속 떠 있을 필요가 없기때문에 모든 체크박스는 아래와 같이 체크해제 해두시면 됩니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-28%2015.07.29.png" alt=""></p>
<p>이제 CreateApp을 클릭하고 아래와 같이 클릭한 후 Create를 누르면 앱이 만들어집니다 :)</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-28%2015.15.22.png" alt=""></p>
<p>만들어진 앱을 실행해 보시고 잘 되시는지 확인해보세요.</p>
<h2 id="앱을-키보드로-연결하기"><a href="#앱을-키보드로-연결하기" class="headerlink" title="앱을 키보드로 연결하기"></a>앱을 키보드로 연결하기</h2><p>이 부분은 좀 더 잘 정리되어있는 <a href="http://macnews.tistory.com/4277">[백투더맥 Q&amp;A] 키보드 단축키로 응용 프로그램을 실행하는 바로 가기 만들기</a>을 참고하시기 바랍니다.</p>
<h2 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h2><p>이번 가이드에서는 업로드 되는 폴더를 정확히 명시하지는 않았습니다. <code>gdrive</code>패키지에서 <code>-p</code>를 이용하면 폴더를 지정가능하다고 하지만 테스트 결과 제대로 업로드 되지 않는 것을 확인했기 때문에, 현재 주로 사용하지는 않는 다른 구글 아이디에 gdrive를 연결해 두었습니다.</p>
<p>Imgur, Dropbox등 여러 이미지 Serving 업체들이 있지만, 구글이 가진 구글 Fiber망과 서비스의 안정성은 여타 서비스들이 따라가기 어려운 점이라고 생각합니다 :)</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/28/Use-GoogleDrive-as-Image-Server/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/Tips/google-drive-logo.jpg" alt="편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 업로드 ShellScript편">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-27T15:00:00.000Z">2017-03-28</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/tips/">tips</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/tips/githubpages/">githubpages</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/28/Use-GoogleDrive-as-Image-Server/">편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 업로드 ShellScript편</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>본 가이드는 MacOS에서 이용가능합니다.</p>
</blockquote>
<h2 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h2><p>깃헙 페이지를 Jekyll등을 이용해 Markdown파일을 이용하다보면 스크린샷을 저장하고 깃헙 레포 폴더에 옮긴 후 수동으로 url을 추가해 주는 작업이 상당히 귀찮고, 심지어 깃헙 레포당 저장공간은 1G로 제한됩니다. </p>
<p>Dropbox의 경우에는 MacOS 내장 스크린샷(CMD+Shift+4)를 이용할 경우 파일을 자동으로 dropbox에 올린 후 공유 url이 나옵니다. 하지만 일반 유저는 용량 제한도 있고, 트래픽 제한도 있습니다.</p>
<p>따라서 무료로 15G의 용량과 명시적 트래픽 제한이 없는 구글드라이브를 이용하는 방안을 고려해보았습니다.</p>
<blockquote>
<p>정확히는 Github은 레포당 용량을 명시적으로 제한하지는 않지만 1G가 넘어가는 경우 스토리지를 이용하도록 가이드합니다. Dropbox링크를 통한 트래픽은 무료 유저의 경우 일 20G, 유료플랜 유저의 경우 일 200G를 줍니다. GoogleDrive의 경우 무료 계정도 일 100G(추정치)의 트래픽을 제공하기 때문에 큰 무리는 따르지 않는다 생각합니다.</p>
</blockquote>
<h2 id="Gdrive-설치하기"><a href="#Gdrive-설치하기" class="headerlink" title="Gdrive 설치하기"></a>Gdrive 설치하기</h2><p>이번 가이드에서는 <a href="https://github.com/prasmussen/gdrive">Gdrive</a>를 이용합니다.</p>
<p><a href="https://brew.sh/">Homebrew</a>를 통해 간단히 설치할 수 있습니다. 터미널에서 아래와 같이 입력해 주세요.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install gdrive</span><br></pre></td></tr></table></figure>

<h2 id="Gdrive-AUTH"><a href="#Gdrive-AUTH" class="headerlink" title="Gdrive AUTH"></a>Gdrive AUTH</h2><p>gdrive를 설치하고 나서, gdrive가 구글드라이브에 액세스 할 수 있도록 권한을 부여해야 합니다. </p>
<p>아래 명령어는 구글드라이브의 최상위 디렉토리를 리스팅 하는 명령어인데, 이 과정에서 드라이브 액세스 권한을 요구하기 때문에 자연스럽게 권한 등록이 가능합니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdrive list</span><br></pre></td></tr></table></figure>

<p>명령어를 입력시 아래와 같은 창이 뜹니다. 절대 창을 끄지 마시고 아래 안내되는 구글 링크로 들어가세요.</p>
<blockquote>
<p>보안을 위해 키 일부를 지웠습니다. 원래는 회색 빈칸이 없습니다 :)</p>
</blockquote>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-27%2016.02.26.png" alt="Console: GoogleDrive auth link"></p>
<p>링크를 따라가시면 구글 로그인을 요구합니다. 로그인을 하시면 아래와 같은 권한 요구 창이 뜨는데요, ‘허용’을 눌러주시면 됩니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-27%2016.03.21.png" alt=""></p>
<p>허용을 누르면 아래와 같은 코드가 나옵니다. 이 코드를 아까 터미널 창에 복사-붙여넣기를 해주세요.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-27%2016.04.52.png" alt=""></p>
<p>만약 코드가 정상적이었다면 아래와 같이 최상위 디렉토리의 폴더/파일 리스트가 나타납니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-27%2016.08.40.png" alt=""></p>
<h2 id="capture-sh파일-만들기"><a href="#capture-sh파일-만들기" class="headerlink" title="capture.sh파일 만들기"></a>capture.sh파일 만들기</h2><p>Gdrive가 정상적으로 구글 계정과 연결되었다면, 이제 <code>capture.sh</code>파일을 만들어야 합니다. 파일의 코드는 아래와 같습니다. 복사 하신 후 원하시는 위치에 넣어주세요. (저는 <code>~/capture.sh</code>로 두었습니다.)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># ~/capture.sh</span></span><br><span class="line">screencapture -tpng -i /tmp/temp_shot_gdrive.png</span><br><span class="line">DATEFILENAME=`date +<span class="string">"%Y%m%d%H%M"</span>`</span><br><span class="line"><span class="comment"># use -p id to upload to a specific folder</span></span><br><span class="line">ID=`gdrive upload /tmp/temp_shot_gdrive.png --name screenshot<span class="variable">$&#123;DATEFILENAME&#125;</span>.png --share | egrep <span class="string">"^Uploaded"</span> | awk <span class="string">'&#123;print $2&#125;'</span>`</span><br><span class="line">URL=<span class="string">"https://drive.google.com/uc?id=<span class="variable">$&#123;ID&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;URL&#125;</span> | pbcopy</span><br></pre></td></tr></table></figure>

<p>우선 이 스크립트 파일에 실행권한을 줘야 합니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x capture.sh</span><br></pre></td></tr></table></figure>

<p>이제 <code>./capture.sh</code>명령을 입력하면 캡쳐메뉴로 진입하고, 캡쳐를 진행하고 잠시 기다리면(업로드 시간) 클립보드에 구글드라이브로 공유된 파일의 URL이 복사됩니다.</p>
<h2 id="rc파일-zshrc-bashrc-에-alias걸기"><a href="#rc파일-zshrc-bashrc-에-alias걸기" class="headerlink" title="rc파일(.zshrc/.bashrc)에 alias걸기"></a>rc파일(.zshrc/.bashrc)에 alias걸기</h2><p><code>capture.sh</code>파일을 둔 위치가 <code>~/capture.sh</code>라고 가정하고, <code>~/.zshrc</code>(혹은<code>~/.bashrc</code>) 파일을 수정해 주겠습니다.</p>
<p>항상 <code>./capture.sh</code>라고 입력하는 것은 귀찮은 일이기 때문에, alias를 통해 <code>cap</code>라는 명령어를 캡쳐 명령어로 지정해 봅시다.</p>
<p><code>.zshrc</code>나 <code>.bashrc</code>파일 제일 아래에 아래 코드를 덧붙여주고 저장해줍시다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">cap</span>=<span class="string">"~/capture.sh"</span></span><br></pre></td></tr></table></figure>

<p>터미널을 재실행한 후 <code>cap</code>라는 명령을 치면 캡쳐 도구가 뜹니다!</p>
<h2 id="다음-가이드-앱으로-만들어-단축키로-연결하기"><a href="#다음-가이드-앱으로-만들어-단축키로-연결하기" class="headerlink" title="다음 가이드: 앱으로 만들어 단축키로 연결하기"></a>다음 가이드: 앱으로 만들어 단축키로 연결하기</h2><p>기본 스크린샷처럼 키보드 단축키 만으로 스크린샷 링크를 가져올 수 있다면 훨씬 편리하겠죠?</p>
<p>다음 가이드에서는 이번에 만든걸 앱으로 만들어 스크린샷 단축키로 연결하는 과정을 다룹니다.</p>
<p>다음가이드: <a href="/2017/03/28/Make-Capture-to-GDrive-App/">편리한 깃헙페이지 블로깅을 위한 이미지서버, 구글드라이브: 앱으로 만들고 키보드 단축키 연결하기</a></p>
<blockquote>
<p>완성된 앱도 함께 제공합니다!</p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/22/Setup-SocialAuth-for-Django-Email-as-User/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-02-08-Setup-SocialAuth-for-Django/social_login.png" alt="Django에 Social Login와 Email유저 함께 이용하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-21T15:00:00.000Z">2017-03-22</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/django/">django</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/22/Setup-SocialAuth-for-Django-Email-as-User/">Django에 Social Login와 Email유저 함께 이용하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p><code>django-custom-user</code>와 <code>social-auth-app-django</code>(구 <code>python-social-auth</code>)를 이용해 이메일 기반 유저와 소셜 로그인으로 로그인 한 유저를 하나처럼 사용하는 방법입니다.</p>
</blockquote>
<blockquote>
<p>장고에 소셜 로그인을 붙이는 가이드는 <a href="/2017/02/08/Setup-SocialAuth-for-Django/">Django에 Social Login 붙이기: Django세팅부터 Facebook/Google 개발 설정까지</a> 포스팅에서 찾으실 수 있습니다.</p>
</blockquote>
<h1 id="Django-SocialLogin-Email-as-User"><a href="#Django-SocialLogin-Email-as-User" class="headerlink" title="Django + SocialLogin + Email as User"></a>Django + SocialLogin + Email as User</h1><p>웹 서비스를 제공할 때 여러가지 로그인 방법을 구현할 수 있습니다. 아이디/패스워드 기반의 방식, 페이스북과 구글등의 OAuth를 이용한 소셜 로그인 방식 등이 있습니다.</p>
<p>장고 프로젝트를 만들 때 <code>django-custom-user</code>등의 패키지를 이용하면 이메일 주소를 Unique Key로 사용해 이메일 주소로 로그인을 할 수 있도록 만들어 줍니다.</p>
<blockquote>
<p><code>django-custom-user</code>에 관한 문서는 <a href="https://github.com/jcugat/django-custom-user#django-custom-user">Django Custom User GitHub</a>에서 확인하실 수 있습니다.</p>
</blockquote>
<p>하지만, <code>social-auth-app-django</code>를 통해 유저를 생성 할 경우 OAuth Provider에 따라 다른 User를 생성합니다. 즉, 같은 이메일 주소를 가지고 있는 유저라 하더라도 페이스북을 통해 로그인 한 유저와 구글을 통해 로그인 한 유저는 다르게 다뤄진다는 뜻입니다.</p>
<blockquote>
<p>사실 이메일 주소를 신뢰하지 않고 Provier마다 다른 유저로 생성하는 것이 기본으로 되어있는 이유는 Oauth Provier의 신뢰 문제입니다. 모든 Oauth Provier가 가입한 유저의 Email의 실 소유권을 확인하지는 않기 때문입니다.</p>
</blockquote>
<p>이를 해결하고 같은 이메일을 통해 로그인한 유저는 모두 같은 유저로 취급하기 위해서는 장고 프로젝트 폴더의 <code>settings.py</code>파일 안에서 <code>social-auth-app-django</code>의 Pipeline설정을 변경해 줘야 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SOCIAL_AUTH_PIPELINE = (</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.social_details'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.social_uid'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.auth_allowed'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.social_user'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.user.get_username'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.associate_by_email'</span>,  <span class="comment"># &lt;--- 이 줄이 핵심입니다.</span></span><br><span class="line">    <span class="string">'social_core.pipeline.user.create_user'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.associate_user'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.social_auth.load_extra_data'</span>,</span><br><span class="line">    <span class="string">'social_core.pipeline.user.user_details'</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>SOCIAL_AUTH_PIPELINE</code>은 <code>settings.py</code>내에는 기본적으로 지정이 해제되어있습니다. 따라서 변수가 없는 경우 위 코드 전체를 <code>settings.py</code>파일 끝에 덧붙이시면 됩니다.</p>
<blockquote>
<p>참고: <a href="http://python-social-auth.readthedocs.io/en/latest/use_cases.html#associate-users-by-email">Python Social Auth: Associate users by Email</a></p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/20/Using-ES6-JSX-on-Client/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/React/react_icon.png" alt="React+JSX(ES6)를 빌드 없이 사용하기: browser.js">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-19T15:00:00.000Z">2017-03-20</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/react/">react</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/react/javascript/">javascript</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/react/javascript/es6/">es6</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/20/Using-ES6-JSX-on-Client/">React+JSX(ES6)를 빌드 없이 사용하기: browser.js</a>
            
        </h1>
        <div class="content">
            <h2 id="Babel-ES6를-ES5로"><a href="#Babel-ES6를-ES5로" class="headerlink" title="Babel: ES6를 ES5로"></a>Babel: ES6를 ES5로</h2><p>바벨(Babel)은 ES6(ECMAScript6)을 ES5 문법으로 변환시켜 오래된 브라우저들에서도 ES6의 기능을 이용할 수 있도록 도와주는 자바스크립트 모듈이다. React는 개발시 ES6 문법을 주로 이용하기 때문에 이러한 Babel은 필수적이라고 말할 수 있다.</p>
<h2 id="그러나…"><a href="#그러나…" class="headerlink" title="그러나…"></a>그러나…</h2><p>React에서 공식적인 이용 방법 중 하나인 CDN을 이용할 경우 (아래 사진처럼) 실제 첫 튜토리얼을 할 경우 JavaScript에서 JSX를 공식적으로 지원하지 않기 때문에 JS문법 에러가 난다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-21%2000.17.14.png" alt=""></p>
<blockquote>
<p>아래 코드는 작동하지 않는다.</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(</span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>,</span><br><span class="line">  document.getElementById('root')</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>물론 실제 배포시에는 빌드 과정을 거쳐 나온 파일을 관리해야 한다. 하지만 React를 처음 배우는 과정에서는 로컬의 한 HTML파일 안에서 모든 과정이 작동하기를 원하게 된다. 따라서 클라이언트 렌더링을 고려할 수 있다.</p>
<blockquote>
<p>물론 클라이언트 렌더링은 성능 이슈가 있기 때문에 실 배포시에는 사용하지 않아야 한다.</p>
</blockquote>
<h2 id="Browser-js-사용하기"><a href="#Browser-js-사용하기" class="headerlink" title="Browser.js 사용하기"></a>Browser.js 사용하기</h2><p>Babel은 6버전부터 Browser.js를 업데이트 하지 않았다. 하지만 정상적으로 동작하는 파일이 CDN에 존재하기 때문에, HTML문서에 다음 세 줄을 추가해 주면 <code>script</code>태그에 <code>type=&quot;text/babel&quot;</code>이라는 타입을 가진 코드들을 ES6로 간주하고 ES5로 변환해 준다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react@15/dist/react.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react-dom@15/dist/react-dom.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Browser.js파일을 추가해서 우리는 위 코드를 아래와 같이 쓸 수 있게 된다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react@15/dist/react.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react-dom@15/dist/react-dom.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span></span><br><span class="line">    ReactDOM.render(</span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>,</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span></span><br><span class="line">    );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>위 코드를 살펴보면 정상적으로 동작한다는 것을 알 수 있다.</p>
<h2 id="입문-개발-전용"><a href="#입문-개발-전용" class="headerlink" title="입문/개발 전용!!"></a>입문/개발 전용!!</h2><p>단, 이 방법은 React에 입문하는 사람이 HTML 문서 하나만으로, 그리고 NPM을 사용하지 않고 작업할 경우에 사용할 수 있는 방법이며, 실 프로젝트에서 이와 같이 사용하는 것은 여러 문제를 일으킬 수 있다. </p>
<p>그러니 입문/개발때에만 사용하자 :) </p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/20/Deploy-Django-with-Fabric/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/old_post/python-fabric-logo.jpg" alt="Fabric으로 Django 배포하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-19T15:00:00.000Z">2017-03-20</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/fabric/">fabric</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/fabric/django/">django</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/20/Deploy-Django-with-Fabric/">Fabric으로 Django 배포하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>이번 가이드는 완성된 상태의 Django 프로젝트가 있다고 가정합니다. 예제로 <a href="https://github.com/Beomi/irkshop">https://github.com/Beomi/irkshop</a> 을 배포해 봅니다.</p>
</blockquote>
<blockquote>
<p><a href="https://gist.github.com/Beomi/945cd905175c3b21370f8f04abd57404">https://gist.github.com/Beomi/945cd905175c3b21370f8f04abd57404</a>의 예제를 설명합니다.</p>
</blockquote>
<h1 id="Fabric으로-Django-배포하기"><a href="#Fabric으로-Django-배포하기" class="headerlink" title="Fabric으로 Django 배포하기"></a>Fabric으로 Django 배포하기</h1><p>Django는 내장된 <code>runserver</code>라는 개발용 웹 서버가 있습니다. 하지만 개발용 웹 서버를 상용 환경에서 사용하는 것은 여러가지 문제를 가져옵니다. 메모리 문제등의 성능 이슈부터 Static file서빙의 보안 문제까지 다양한데요, 이 때문에 Django는 웹 서버(ex: <code>Apache2</code> <code>NginX</code>등)를 통해 배포하게 됩니다.</p>
<p>하지만 이러한 배포작업은 아마존 EC2등의 VPS나 리얼 서버에서 <code>Apache2</code>를 깔고, <code>python3</code>와 <code>mod_wsgi</code>등을 깔아야만 동작하기 때문에 배포 자체가 어려움을 갖게 됩니다. 또한 SSH에 접속히 직접 명령어를 치는 경우 오타나 실수등으로 인해 정상적으로 작동하지 않는 경우도 부지기수입니다.</p>
<p>따라서 이러한 작업을 자동화해주는 도구가 바로 Fabric이고, 이번 가이드에서는 Django 프로젝트를 Vultr VPS, Ubuntu에 올리는 방법을 다룹니다.</p>
<h2 id="Vultr-VPS-생성하기"><a href="#Vultr-VPS-생성하기" class="headerlink" title="Vultr VPS 생성하기"></a>Vultr VPS 생성하기</h2><p><a href="vultr.com">Vultr</a>는 VPS(가상서버) 제공 회사입니다. 최근 가격 인하로 유사 서비스 대비 절반 가격에 이용할 수 있어 가성비가 좋습니다.</p>
<p>사용자가 많지 않은 (혹은 혼자 사용하는..) 서비스라면 최소 가격인 1cpu 512MB의 월 2.5달러짜리를 이용하시면 됩니다.</p>
<p>Vultr는 일본 Region에 서버가 있어 한국에서 사용하기에도 핑이 25ms정도로 양호합니다.</p>
<p>VPS하나를 만든 후 root로 접속해 장고를 구동할 사용자를 만들어 봅시다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-19%2023.20.21.png" alt="예제VPS"></p>
<h2 id="django-유저-만들기-sudo권한-가진-유저-만들기"><a href="#django-유저-만들기-sudo권한-가진-유저-만들기" class="headerlink" title="django 유저 만들기(sudo권한 가진 유저 만들기)"></a><code>django</code> 유저 만들기(sudo권한 가진 유저 만들기)</h2><p>Fabric을 사용할 때 초기에 <code>apt</code>를 이용해 패키지를 설치해야 할 필요가 있습니다.</p>
<p>하지만 처음에 제공되는 <code>root</code>계정은 사용하지 않는 것을 보안상 추천합니다. 따라서 우리는 <code>sudo</code>권한을 가진 <code>django</code>라는 유저를 생성하고 Fabric으로 진행해 보겠습니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adduser django <span class="comment"># `django`라는 유저를 만듭니다.</span></span><br><span class="line">adduser django sudo <span class="comment"># django유저를 `sudo`그룹에 추가합니다.</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>비밀번호를 만드는 것을 제외하면 나머지는 빈칸으로 만들어 두어도 무방합니다.</p>
</blockquote>
<h2 id="Fabric-설치하기"><a href="#Fabric-설치하기" class="headerlink" title="Fabric 설치하기"></a>Fabric 설치하기</h2><p><code>Fabric</code>은 기본적으로 서버가 아닌 클라이언트에 설치합니다. 개념상 로컬에서 SSH로 서버에 접속해 명령을 처리하는 것이기 때문에 당연히 SSH 명령을 입려하는 로컬에 설치되어야 합니다.</p>
<p>Fabric은 공식적으로는 Python2.7만을 지원합니다. 하지만 이 프로젝트를 Fork해서 Python3을 지원하는 프로젝트인 <code>Fabric3</code>이 있습니다. 이번 가이드에서는 이 <code>Fabric3</code>을 설치합니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install fabric3</span><br><span class="line"><span class="comment"># 혹은</span></span><br><span class="line">python3 -m pip install fabric3</span><br></pre></td></tr></table></figure>

<h2 id="fabfile-만들기"><a href="#fabfile-만들기" class="headerlink" title="fabfile 만들기"></a>fabfile 만들기</h2><h3 id="Fabric-import하기"><a href="#Fabric-import하기" class="headerlink" title="Fabric import하기"></a>Fabric import하기</h3><p>Fabric을 설치하시면 <code>fab</code>이라는 명령어를 사용할 수 있습니다. 이 명령어는 <code>fab some_func</code>라는 방식을 통해 <code>fabfile.py</code>파일 안의 함수를 실행할 수 있습니다.</p>
<p>fabfile은 기본적으로 <code>manage.py</code>파일와 같은 위치인 프로젝트 폴더에 두시는 것을 권장합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br></pre></td></tr></table></figure>

<p>우선 fabric에서 사용하는 API들을 import해줍니다.</p>
<p><code>fabric.contrib.files</code>에서는 원격(혹은 로컬)의 파일을 관리하는 API입니다. <code>fabric.api</code>는 Fabric에서 사용하는 환경이나, SSH로 연결한 원격 서버에서 명령어를 실행하는 API입니다.</p>
<h3 id="PROJECT-DIR-BASE-DIR-지정하기"><a href="#PROJECT-DIR-BASE-DIR-지정하기" class="headerlink" title="PROJECT_DIR, BASE_DIR 지정하기"></a>PROJECT_DIR, BASE_DIR 지정하기</h3><p>장고의 <code>settings.py</code>파일에 기본적으로 지정된 <code>BASE_DIR</code>와 같은 장고 프로젝트의 폴더 위치를 지정하는 <code>PROJECT_DIR</code>와 <code>BASE_DIR</code>을 지정해 줍니다.</p>
<p><code>PROJECT_DIR</code>은 <code>settings.py</code>가 있는 폴더의 위치이고, <code>BASE_DIR</code>은 <code>manage.py</code>가 있는 폴더입니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">PROJECT_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">BASE_DIR = os.path.dirname(PROJECT_DIR)</span><br></pre></td></tr></table></figure>

<h3 id="배포용-변수-불러오기"><a href="#배포용-변수-불러오기" class="headerlink" title="배포용 변수 불러오기"></a>배포용 변수 불러오기</h3><p>서버에 배포를 하기 위해 <code>git</code>을 이용합니다. 따라서 소스가 올라가 있는 깃헙(혹은 gitlab, bitbucket 등)의 주소(<code>REPO_URL</code>)가 필요합니다.</p>
<p>그리고 원격으로 SSH접속을 하기 때문에 원격 서버에 접속할 수 있는 SSH용 주소(<code>REMOTE_HOST_SSH</code>), 원격 계정 ID(<code>REMOTE_USER</code>), 원격 계정 비밀번호(<code>REMOTE_PASSWORD</code>)가 필요합니다.</p>
<p>또한, 장고 <code>settings.py</code>의 <code>ALLOWED_HOSTS</code>에 추가할 도메인(<code>REMOTE_HOST</code>)이 필요합니다.</p>
<p>이러한 변수들은 보통 json파일에 저장하고 <code>.gitignore</code>에 이 json파일을 지정해 git에 올라가지 않도록 관리합니다. 이번 가이드에서는 <code>deploy.json</code>이라는 파일에 아래 변수들을 저장하고 관리해 보겠습니다.</p>
<p><code>deploy.json</code>파일을 <code>fabfile.py</code>파일이 있는 곳에 아래 내용을 담고 저장해주세요.</p>
<blockquote>
<p><code>REPO_URL</code>와 <code>PROJECT_NAME</code>을 제외한 설정은 위 Vultr에서 만들어준 대로 진행해주세요. 단, REMOTE_USER는 root이면 안됩니다!</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"REPO_URL"</span>:<span class="string">"https://github.com/Beomi/irkshop.git"</span>,</span><br><span class="line">  <span class="attr">"PROJECT_NAME"</span>:<span class="string">"irkshop"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_HOST_SSH"</span>:<span class="string">"45.77.20.73"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_HOST"</span>:<span class="string">"45.77.20.73"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_USER"</span>:<span class="string">"django"</span>,</span><br><span class="line">  <span class="attr">"REMOTE_PASSWORD"</span>:<span class="string">"django_pwd123"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>만약 SSH 포트가 다르다면 <code>REMOTE_HOST_SSH</code> 뒤 포트를 :으로 붙여주면 됩니다. (ex: 45.77.20.73:22)</p>
</blockquote>
<blockquote>
<p>REMOTE_HOST는 도메인 주소(ex: irkshop.testi.kr)일 수 있습니다. 하지만 이번 배포에서는 도메인을 다루지 않으므로 IP주소로 대신합니다.</p>
</blockquote>
<p>json파일을 만들었다면 이 파일을 이제 <code>fabfile.py</code>에서 불러와 사용해 봅시다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">PROJECT_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># deploy.json파일을 불러와 envs변수에 저장합니다.</span></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(PROJECT_DIR, <span class="string">"deploy.json"</span>)) <span class="keyword">as</span> f:</span><br><span class="line">    envs = json.loads(f.read())</span><br><span class="line"></span><br><span class="line">REPO_URL = envs[<span class="string">'REPO_URL'</span>]</span><br><span class="line">PROJECT_NAME = envs[<span class="string">'PROJECT_NAME'</span>]</span><br><span class="line">REMOTE_HOST_SSH = envs[<span class="string">'REMOTE_HOST_SSH'</span>]</span><br><span class="line">REMOTE_HOST = envs[<span class="string">'REMOTE_HOST'</span>]</span><br><span class="line">REMOTE_USER = envs[<span class="string">'REMOTE_USER'</span>]</span><br><span class="line">REMOTE_PASSWORD = envs[<span class="string">'REMOTE_PASSWORD'</span>]</span><br><span class="line"><span class="comment"># 아래 부분은 Django의 settings.py에서 지정한 STATIC_ROOT 폴더 이름, STATID_URL, MEDIA_ROOT 폴더 이름을 입력해주시면 됩니다.</span></span><br><span class="line">STATIC_ROOT_NAME = <span class="string">'static_deploy'</span></span><br><span class="line">STATIC_URL_NAME = <span class="string">'static'</span></span><br><span class="line">MEDIA_ROOT = <span class="string">'uploads'</span></span><br></pre></td></tr></table></figure>

<h3 id="Fabric-환경-설정하기"><a href="#Fabric-환경-설정하기" class="headerlink" title="Fabric 환경 설정하기"></a>Fabric 환경 설정하기</h3><p>이제 Fabric이 사용할 <code>env</code>를 설정해 줍시다. 대표적으로 <code>env.user</code>와 <code>env.hosts</code>, <code>env.password</code>가 있습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">PROJECT_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(PROJECT_DIR, <span class="string">"deploy.json"</span>)) <span class="keyword">as</span> f:</span><br><span class="line">    envs = json.loads(f.read())</span><br><span class="line"></span><br><span class="line">REPO_URL = envs[<span class="string">'REPO_URL'</span>]</span><br><span class="line">PROJECT_NAME = envs[<span class="string">'PROJECT_NAME'</span>]</span><br><span class="line">REMOTE_HOST_SSH = envs[<span class="string">'REMOTE_HOST_SSH'</span>]</span><br><span class="line">REMOTE_HOST = envs[<span class="string">'REMOTE_HOST'</span>]</span><br><span class="line">REMOTE_USER = envs[<span class="string">'REMOTE_USER'</span>]</span><br><span class="line">REMOTE_PASSWORD = envs[<span class="string">'REMOTE_PASSWORD'</span>]</span><br><span class="line">STATIC_ROOT_NAME = <span class="string">'static_deploy'</span></span><br><span class="line">STATIC_URL_NAME = <span class="string">'static'</span></span><br><span class="line">MEDIA_ROOT = <span class="string">'uploads'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Fabric이 사용하는 env에 값들을 저장합니다.</span></span><br><span class="line">env.user = REMOTE_USER</span><br><span class="line">username = env.user</span><br><span class="line">env.hosts = [</span><br><span class="line">    REMOTE_HOST_SSH, <span class="comment"># 리스트로 만들어야 합니다.</span></span><br><span class="line">    ]</span><br><span class="line">env.password = REMOTE_PASSWORD</span><br><span class="line"><span class="comment"># 원격 서버에서 장고 프로젝트가 있는 위치를 정해줍니다.</span></span><br><span class="line">project_folder = <span class="string">'/home/&#123;&#125;/&#123;&#125;'</span>.format(env.user, PROJECT_NAME)</span><br></pre></td></tr></table></figure>

<p>이와 같이 설정시 <code>fab</code>명령어를 실행할 경우에 추가적인 값을 입력할 필요가 없어집니다.</p>
<h3 id="APT-설치-목록-지정하기"><a href="#APT-설치-목록-지정하기" class="headerlink" title="APT 설치 목록 지정하기"></a>APT 설치 목록 지정하기</h3><p>VPS에 따라 설치되어있는 리눅스 패키지가 다릅니다. 이번 가이드에서는 <code>Apache2</code>와 <code>mod-wsgi-py3</code>을 사용하기 때문에 이 패키지와 파이썬 의존 패키지들을 설치해 줘야 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fabric.contrib.files <span class="keyword">import</span> append, exists, sed, put</span><br><span class="line"><span class="keyword">from</span> fabric.api <span class="keyword">import</span> env, local, run, sudo</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">PROJECT_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(PROJECT_DIR, <span class="string">"deploy.json"</span>)) <span class="keyword">as</span> f:</span><br><span class="line">    envs = json.loads(f.read())</span><br><span class="line"></span><br><span class="line">REPO_URL = envs[<span class="string">'REPO_URL'</span>]</span><br><span class="line">PROJECT_NAME = envs[<span class="string">'PROJECT_NAME'</span>]</span><br><span class="line">REMOTE_HOST_SSH = envs[<span class="string">'REMOTE_HOST_SSH'</span>]</span><br><span class="line">REMOTE_HOST = envs[<span class="string">'REMOTE_HOST'</span>]</span><br><span class="line">REMOTE_USER = envs[<span class="string">'REMOTE_USER'</span>]</span><br><span class="line">REMOTE_PASSWORD = envs[<span class="string">'REMOTE_PASSWORD'</span>]</span><br><span class="line">STATIC_ROOT_NAME = <span class="string">'static_deploy'</span></span><br><span class="line">STATIC_URL_NAME = <span class="string">'static'</span></span><br><span class="line">MEDIA_ROOT = <span class="string">'uploads'</span></span><br><span class="line"></span><br><span class="line">env.user = REMOTE_USER</span><br><span class="line">username = env.user</span><br><span class="line">env.hosts = [REMOTE_HOST_SSH,]</span><br><span class="line">env.password = REMOTE_PASSWORD</span><br><span class="line">project_folder = <span class="string">'/home/&#123;&#125;/&#123;&#125;'</span>.format(env.user, PROJECT_NAME)</span><br><span class="line"></span><br><span class="line"><span class="comment"># APT로 설치할 목록을 정해줍니다.</span></span><br><span class="line">apt_requirements = [</span><br><span class="line">    <span class="string">'ufw'</span>, <span class="comment"># 방화벽</span></span><br><span class="line">    <span class="string">'curl'</span>,</span><br><span class="line">    <span class="string">'git'</span>, <span class="comment"># 깃</span></span><br><span class="line">    <span class="string">'python3-dev'</span>, <span class="comment"># Python 의존성</span></span><br><span class="line">    <span class="string">'python3-pip'</span>, <span class="comment"># PIP</span></span><br><span class="line">    <span class="string">'build-essential'</span>, <span class="comment"># C컴파일 패키지</span></span><br><span class="line">    <span class="string">'python3-setuptools'</span>, <span class="comment"># PIP</span></span><br><span class="line">    <span class="string">'apache2'</span>, <span class="comment"># 웹서버 Apache2</span></span><br><span class="line">    <span class="string">'libapache2-mod-wsgi-py3'</span>, <span class="comment"># 웹서버~Python3 연결</span></span><br><span class="line">    <span class="comment"># 'libmysqlclient-dev', # MySql</span></span><br><span class="line">    <span class="string">'libssl-dev'</span>, <span class="comment"># SSL</span></span><br><span class="line">    <span class="string">'libxml2-dev'</span>, <span class="comment"># XML</span></span><br><span class="line">    <span class="string">'libjpeg8-dev'</span>, <span class="comment"># Pillow 의존성 패키지(ImageField)</span></span><br><span class="line">    <span class="string">'zlib1g-dev'</span>, <span class="comment"># Pillow 의존성 패키지</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="Fab-함수-만들기"><a href="#Fab-함수-만들기" class="headerlink" title="Fab 함수 만들기"></a>Fab 함수 만들기</h3><p>Fabric은 fabfile있는 곳에서 <code>fab 함수이름</code>의 명령어로 실행 가능합니다. 단, <code>_</code>로 시작하는 함수는 Fabric이 관리하지 않습니다.</p>
<p>이제 서버에서 실행할 SSH를 캡슐화한다고 보면 됩니다. 크게 <code>setup</code>와 <code>deploy</code>로 나눌 수 있다고 봅니다. Setup은 장고 코드와 무관한 OS의 패키지 관리와 VirtualEnv관리, Deploy는 장고 소스가 변화할 경우 업데이트 되어야 하는 코드입니다.</p>
<p>Setup에는 APT 최신 패키지 설치와 <code>apt_requirements</code>설치, 그리고 <code>virtualenv</code>를 만드는 것까지를 다룹니다.</p>
<p>Deploy에서는 Git에서 최신 소스코드를 가져오고, Git에서 관리되지 않는 환경변수 파일을 서버에 업로드하고, 장고 <code>settings.py</code>파일을 상용 환경으로 바꿔주고, virtualenv로 만든 가상환경에 pip 패키지를 설치하고, StaticFile들을 collect하고, DB를 migrate해주고, Apache2의 VirtualHost에 장고 웹 서비스를 등록하고, 폴더 권한을 잡아주고, 마지막으로 Apache2 웹서버를 재부팅하는 과정까지를 다룹니다.</p>
<blockquote>
<p>여기서부터는 코드가 너무 길어지는 관계로 <code>apt_requirements</code> 포함한 윗부분을 생략합니다. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 앞부분 생략</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_server</span><span class="params">()</span>:</span></span><br><span class="line">    setup()</span><br><span class="line">    deploy()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup</span><span class="params">()</span>:</span></span><br><span class="line">    _get_latest_apt() <span class="comment"># APT update/upgrade</span></span><br><span class="line">    _install_apt_requirements(apt_requirements) <span class="comment"># APT install</span></span><br><span class="line">    _make_virtualenv() <span class="comment"># Virtualenv</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deploy</span><span class="params">()</span>:</span></span><br><span class="line">    _get_latest_source() <span class="comment"># Git에서 최신 소스 가져오기</span></span><br><span class="line">    _put_envs() <span class="comment"># 환경변수 json파일 업로드</span></span><br><span class="line">    _update_settings() <span class="comment"># settings.py파일 변경</span></span><br><span class="line">    _update_virtualenv() <span class="comment"># pip 설치</span></span><br><span class="line">    _update_static_files() <span class="comment"># collectstatics</span></span><br><span class="line">    _update_database() <span class="comment"># migrate</span></span><br><span class="line">    _make_virtualhost() <span class="comment"># Apache2 VirtualHost</span></span><br><span class="line">    _grant_apache2() <span class="comment"># chmod</span></span><br><span class="line">    _grant_sqlite3() <span class="comment"># chmod</span></span><br><span class="line">    _restart_apache2() <span class="comment"># 웹서버 재시작</span></span><br></pre></td></tr></table></figure>

<p>이와 같이 함수를 등록해주면 <code>fab new_server</code>, <code>fab setup</code>, <code>fab deploy</code>를 통해 바로바로 배포를 할 수 있습니다.</p>
<p>이제 <code>_</code>로 시작하는, 진짜 Fabric함수들을 만들어 보겠습니다.</p>
<blockquote>
<p>_ 로 시작하는 함수들을 설명할 때는 함수만 각각 설명합니다. 모두 모인 코드는 글 상단의 GIST를 참고해주세요.</p>
</blockquote>
<ul>
<li><code>_get_latest_apt</code>: APT 업데이트 &amp; 업그레이드</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_latest_apt</span><span class="params">()</span>:</span></span><br><span class="line">    update_or_not = input(<span class="string">'would you update?: [y/n]'</span>)</span><br><span class="line">    <span class="keyword">if</span> update_or_not==<span class="string">'y'</span>:</span><br><span class="line">        sudo(<span class="string">'sudo apt-get update &amp;&amp; sudo apt-get -y upgrade'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_install_apt_requirements</code>: apt_requirements에 적은 패키지들을 설치합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_install_apt_requirements</span><span class="params">(apt_requirements)</span>:</span></span><br><span class="line">    reqs = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> req <span class="keyword">in</span> apt_requirements:</span><br><span class="line">        reqs += (<span class="string">' '</span> + req)</span><br><span class="line">    sudo(<span class="string">'sudo apt-get -y install &#123;&#125;'</span>.format(reqs))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_make_virtualenv</code>: 원격 서버에 <code>~/.virtualenvs</code>폴더가 없는 경우 virtualenv와 virtualenvwrapper를 설치하고 <code>.bashrc</code>파일에 virtualenvwrapper를 등록해 줍니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_make_virtualenv</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exists(<span class="string">'~/.virtualenvs'</span>):</span><br><span class="line">        script = <span class="string">'''"# python virtualenv settings</span></span><br><span class="line"><span class="string">                    export WORKON_HOME=~/.virtualenvs</span></span><br><span class="line"><span class="string">                    export VIRTUALENVWRAPPER_PYTHON="$(command \which python3)"  # location of python3</span></span><br><span class="line"><span class="string">                    source /usr/local/bin/virtualenvwrapper.sh"'''</span></span><br><span class="line">        run(<span class="string">'mkdir ~/.virtualenvs'</span>)</span><br><span class="line">        sudo(<span class="string">'sudo pip3 install virtualenv virtualenvwrapper'</span>)</span><br><span class="line">        run(<span class="string">'echo &#123;&#125; &gt;&gt; ~/.bashrc'</span>.format(script))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_get_latest_source</code>: 만약 <code>.git</code>폴더가 없다면 원격 git repo에서 clone해오고, 있다면 fetch해온 후 최신 커밋으로 reset합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_latest_source</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> exists(project_folder + <span class="string">'/.git'</span>):</span><br><span class="line">        run(<span class="string">'cd %s &amp;&amp; git fetch'</span> % (project_folder,))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        run(<span class="string">'git clone %s %s'</span> % (REPO_URL, project_folder))</span><br><span class="line">    current_commit = local(<span class="string">"git log -n 1 --format=%H"</span>, capture=<span class="literal">True</span>)</span><br><span class="line">    run(<span class="string">'cd %s &amp;&amp; git reset --hard %s'</span> % (project_folder, current_commit))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_put_envs</code>: 로컬의 <code>envs.json</code>이름의 환경변수를 서버에 업로드 합니다.</li>
</ul>
<blockquote>
<p>Apache2는 웹서버가 OS의 환경변수를 사용하지 않기 때문에 json와 같은 파일을 통해 환경변수를 관리해 줘야 합니다. 저는 <code>envs.json</code>이라는 파일을 <code>manage.py</code>파일이 있는 프로젝트 폴더에 만든 후 환경변수를 장고의 <code>settings.py</code>에서 불러와 사용합니다.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_put_envs</span><span class="params">()</span>:</span></span><br><span class="line">    put(os.path.join(PROJECT_DIR, <span class="string">'envs.json'</span>), <span class="string">'~/&#123;&#125;/envs.json'</span>.format(PROJECT_NAME))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_update_settings</code>: <code>settings.py</code>파일을 바꿔줍니다. DEBUG를 False로 바꾸고, ALLOWED_HOSTS에 호스트 이름을 등록하고, 장고에서 만들어준 키 파일이 아니라 서버에서 랜덤으로 만든 Secret KEY를 사용하게 합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_update_settings</span><span class="params">()</span>:</span></span><br><span class="line">    settings_path = project_folder + <span class="string">'/&#123;&#125;/settings.py'</span>.format(PROJECT_NAME)</span><br><span class="line">    sed(settings_path, <span class="string">"DEBUG = True"</span>, <span class="string">"DEBUG = False"</span>)</span><br><span class="line">    sed(settings_path,</span><br><span class="line">        <span class="string">'ALLOWED_HOSTS = .+$'</span>,</span><br><span class="line">        <span class="string">'ALLOWED_HOSTS = ["%s"]'</span> % (REMOTE_HOST,)</span><br><span class="line">    )</span><br><span class="line">    secret_key_file = project_folder + <span class="string">'/&#123;&#125;/secret_key.py'</span>.format(PROJECT_NAME)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exists(secret_key_file):</span><br><span class="line">        chars = <span class="string">'abcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*(-_=+)'</span></span><br><span class="line">        key = <span class="string">''</span>.join(random.SystemRandom().choice(chars) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">50</span>))</span><br><span class="line">        append(secret_key_file, <span class="string">"SECRET_KEY = '%s'"</span> % (key,))</span><br><span class="line">    append(settings_path, <span class="string">'\nfrom .secret_key import SECRET_KEY'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_update_virtualenv</code>: virtualenv에 <code>requirements.txt</code>파일로 지정된 pip 패키지들을 설치합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_update_virtualenv</span><span class="params">()</span>:</span></span><br><span class="line">    virtualenv_folder = project_folder + <span class="string">'/../.virtualenvs/&#123;&#125;'</span>.format(PROJECT_NAME)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> exists(virtualenv_folder + <span class="string">'/bin/pip'</span>):</span><br><span class="line">        run(<span class="string">'cd /home/%s/.virtualenvs &amp;&amp; virtualenv %s'</span> % (env.user, PROJECT_NAME))</span><br><span class="line">    run(<span class="string">'%s/bin/pip install -r %s/requirements.txt'</span> % (</span><br><span class="line">        virtualenv_folder, project_folder</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_update_static_files</code>: CollectStatic을 해줍니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_update_static_files</span><span class="params">()</span>:</span></span><br><span class="line">    virtualenv_folder = project_folder + <span class="string">'/../.virtualenvs/&#123;&#125;'</span>.format(PROJECT_NAME)</span><br><span class="line">    run(<span class="string">'cd %s &amp;&amp; %s/bin/python3 manage.py collectstatic --noinput'</span> % (</span><br><span class="line">        project_folder, virtualenv_folder</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_update_database</code>: DB migrate를 해줍니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_update_database</span><span class="params">()</span>:</span></span><br><span class="line">    virtualenv_folder = project_folder + <span class="string">'/../.virtualenvs/&#123;&#125;'</span>.format(PROJECT_NAME)</span><br><span class="line">    run(<span class="string">'cd %s &amp;&amp; %s/bin/python3 manage.py migrate --noinput'</span> % (</span><br><span class="line">        project_folder, virtualenv_folder</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_make_virtualhost</code>: Apache2가 관리하는 VirtualHost를 만들어줍니다. 80포트로 지정하고 Static파일을 Apache2가 서빙합니다.</li>
</ul>
<blockquote>
<p>만약 SSL을 사용하고 싶으시다면 *:443으로 관리되는 파일을 추가적으로 만드셔야 합니다. 이번 가이드에서는 다루지 않습니다.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_make_virtualhost</span><span class="params">()</span>:</span></span><br><span class="line">    script = <span class="string">"""'&lt;VirtualHost *:80&gt;</span></span><br><span class="line"><span class="string">    ServerName &#123;servername&#125;</span></span><br><span class="line"><span class="string">    Alias /&#123;static_url&#125; /home/&#123;username&#125;/&#123;project_name&#125;/&#123;static_root&#125;</span></span><br><span class="line"><span class="string">    Alias /&#123;media_url&#125; /home/&#123;username&#125;/&#123;project_name&#125;/&#123;media_url&#125;</span></span><br><span class="line"><span class="string">    &lt;Directory /home/&#123;username&#125;/&#123;project_name&#125;/&#123;media_url&#125;&gt;</span></span><br><span class="line"><span class="string">        Require all granted</span></span><br><span class="line"><span class="string">    &lt;/Directory&gt;</span></span><br><span class="line"><span class="string">    &lt;Directory /home/&#123;username&#125;/&#123;project_name&#125;/&#123;static_root&#125;&gt;</span></span><br><span class="line"><span class="string">        Require all granted</span></span><br><span class="line"><span class="string">    &lt;/Directory&gt;</span></span><br><span class="line"><span class="string">    &lt;Directory /home/&#123;username&#125;/&#123;project_name&#125;/&#123;project_name&#125;&gt;</span></span><br><span class="line"><span class="string">        &lt;Files wsgi.py&gt;</span></span><br><span class="line"><span class="string">            Require all granted</span></span><br><span class="line"><span class="string">        &lt;/Files&gt;</span></span><br><span class="line"><span class="string">    &lt;/Directory&gt;</span></span><br><span class="line"><span class="string">    WSGIDaemonProcess &#123;project_name&#125; python-home=/home/&#123;username&#125;/.virtualenvs/&#123;project_name&#125; python-path=/home/&#123;username&#125;/&#123;project_name&#125;</span></span><br><span class="line"><span class="string">    WSGIProcessGroup &#123;project_name&#125;</span></span><br><span class="line"><span class="string">    WSGIScriptAlias / /home/&#123;username&#125;/&#123;project_name&#125;/&#123;project_name&#125;/wsgi.py</span></span><br><span class="line"><span class="string">    &#123;% raw %&#125;</span></span><br><span class="line"><span class="string">    ErrorLog $&#123;&#123;APACHE_LOG_DIR&#125;&#125;/error.log</span></span><br><span class="line"><span class="string">    CustomLog $&#123;&#123;APACHE_LOG_DIR&#125;&#125;/access.log combined</span></span><br><span class="line"><span class="string">    &#123;% endraw %&#125;</span></span><br><span class="line"><span class="string">    &lt;/VirtualHost&gt;'"""</span>.format(</span><br><span class="line">        static_root=STATIC_ROOT_NAME,</span><br><span class="line">        username=env.user,</span><br><span class="line">        project_name=PROJECT_NAME,</span><br><span class="line">        static_url=STATIC_URL_NAME,</span><br><span class="line">        servername=REMOTE_HOST,</span><br><span class="line">        media_url=MEDIA_ROOT</span><br><span class="line">    )</span><br><span class="line">    sudo(<span class="string">'echo &#123;&#125; &gt; /etc/apache2/sites-available/&#123;&#125;.conf'</span>.format(script, PROJECT_NAME))</span><br><span class="line">    sudo(<span class="string">'a2ensite &#123;&#125;.conf'</span>.format(PROJECT_NAME))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_grant_apache2</code>: 프로젝트 폴더내 파일을 <code>www-data</code>그룹(Apache2)이 관리할 수 있도록 소유권을 변경합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_grant_apache2</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">'sudo chown -R :www-data ~/&#123;&#125;'</span>.format(PROJECT_NAME))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_grant_sqlite3</code>: 만약 Sqlite3을 그대로 이용할 경우 <code>www-data</code>가 쓰기 권한을 가져야 합니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_grant_sqlite3</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">'sudo chmod 775 ~/&#123;&#125;/db.sqlite3'</span>.format(PROJECT_NAME))</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_restart_apache2</code>: 모든 설정을 마친 후 Apache2 웹서버를 재실행해 설정을 적용해줍니다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_restart_apache2</span><span class="params">()</span>:</span></span><br><span class="line">    sudo(<span class="string">'sudo service apache2 restart'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="배포해보기"><a href="#배포해보기" class="headerlink" title="배포해보기"></a>배포해보기</h2><p>이제 <code>manage.py</code>파일이 있는 곳에서 아래 명령어를 입력해 봅시다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fab new_server</span><br></pre></td></tr></table></figure>

<p>이 명령어를 치면 자동으로 모든 과정이 완료되고 서버가 뜹니다.</p>
<p>만약 파일을 수정하고 커밋했다면, Github Repo에 올린 후 <code>deploy</code> 명령어를 통해 새 코드를 서버에 배포할 수 있습니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fab deploy</span><br></pre></td></tr></table></figure>

<h2 id="짜잔"><a href="#짜잔" class="headerlink" title="짜잔!"></a>짜잔!</h2><p>프로젝트 하나가 배포가 완료되었습니다! 아무것도 없어보이지만, DB에 자료를 추가하면 <a href="http://irkshop.testi.kr">IRKSHOP 예제</a>처럼 예쁘게 생성됩니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-03-20%2000.28.56.png" alt="Simple IRKSHOP"></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/19/Celery-Getting-Started/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-03-19-Celery-Getting-Started/celery.jpg" alt="[번역]셀러리: 시작하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-18T15:00:00.000Z">2017-03-19</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/">celery</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/celerydocs/">celerydocs</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/celerydocs/translation/">translation</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/19/Celery-Getting-Started/">[번역]셀러리: 시작하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>글 작성 시점 최신 버전 <code>v4.0.2</code>의 문서입니다.</p>
</blockquote>
<p>원문: <a href="http://docs.celeryproject.org/en/latest/getting-started/index.html">http://docs.celeryproject.org/en/latest/getting-started/index.html</a></p>
<h1 id="셀러리-시작하기"><a href="#셀러리-시작하기" class="headerlink" title="셀러리: 시작하기"></a>셀러리: 시작하기</h1><p>출시버전: v4.0.2</p>
<p>출시일: 2017. 03. 15.</p>
<p>번역일: 2017. 03. 19. ~</p>
<h2 id="셀러리-입문하기"><a href="#셀러리-입문하기" class="headerlink" title="셀러리 입문하기"></a><a href="/2017/03/19/Introduction-to-Celery/">셀러리 입문하기</a></h2><ul>
<li><p>태스크 큐란 무엇인가? (What’s a Task Queue?)</p>
</li>
<li><p>뭐가 필요한가요? (What do I need?)</p>
</li>
<li><p>시작하기 (Get Started)</p>
</li>
<li><p>셀러리는.. (Celery is..)</p>
</li>
<li><p>셀러리의 기능들 (Features)</p>
</li>
<li><p>프레임워크와 함께 이용하기 (Framework Integration)</p>
</li>
<li><p>빠르게 찾아보기 (Quick Jump)</p>
</li>
<li><p>셀러리 설치하기 (Installation)</p>
</li>
</ul>
<h2 id="브로커-Brokers"><a href="#브로커-Brokers" class="headerlink" title="브로커 (Brokers)"></a>브로커 (Brokers)</h2><ul>
<li><p>브로커 가이드 (Broker Instructions)</p>
<ul>
<li>RabbitMQ 사용하기 (Using RabbitMQ)</li>
<li>Redis 사용하기 (Using Redis)</li>
<li>Amazon SQS 사용하기 (Using Amazon SQS)</li>
</ul>
</li>
<li><p>브로커간 기능 (Broker Overview)</p>
</li>
</ul>
<h2 id="셀러리-한-발자국-내밀기-First-Steps-with-Celery"><a href="#셀러리-한-발자국-내밀기-First-Steps-with-Celery" class="headerlink" title="셀러리 한 발자국 내밀기 (First Steps with Celery)"></a>셀러리 한 발자국 내밀기 (First Steps with Celery)</h2><ul>
<li><p>브로커 선택하기 (Choosing a Broker)</p>
</li>
<li><p>셀러리 설치하기 (Installing Celery)</p>
</li>
<li><p>앱 (Application)</p>
</li>
<li><p>셀러리 워커 서버 띄우기 (Running the Celery worker server)</p>
</li>
<li><p>태스크 호출하기 (Calling the task)</p>
</li>
<li><p>결과 유지하기 (Keeping Results)</p>
</li>
<li><p>설정하기 (Configuration)</p>
</li>
<li><p>더 나아가기 (Where to go from here)</p>
</li>
<li><p>문제 해결하기 (Troubleshooting)</p>
</li>
</ul>
<h2 id="더-알아보기-Next-Steps"><a href="#더-알아보기-Next-Steps" class="headerlink" title="더 알아보기 (Next Steps)"></a>더 알아보기 (Next Steps)</h2><ul>
<li><p>셀러리를 기존 앱에서 사용하기 (Using Celery in your Application)</p>
</li>
<li><p>태스크 호출하기 (Calling Tasks)</p>
</li>
<li><p>Canvas: 워크플로 디자인하기 (Canvas: Designing Work-flows)</p>
</li>
<li><p>라우팅 (Routing)</p>
</li>
<li><p>원격 제어 (Remote Control)</p>
</li>
<li><p>타임존 (Timezone)</p>
</li>
<li><p>최적화 (Optimization)</p>
</li>
<li><p>더, 더, 더. (What to do now?)</p>
</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/19/Introduction-to-Celery/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-03-19-Celery-Getting-Started/celery.jpg" alt="[번역]셀러리 입문하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-03-18T15:00:00.000Z">2017-03-19</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/">celery</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/celerydocs/">celerydocs</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/celery/celerydocs/translation/">translation</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/19/Introduction-to-Celery/">[번역]셀러리 입문하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>글 작성 시점 최신 버전 <code>v4.0.2</code>의 문서입니다.</p>
</blockquote>
<p>원문: <a href="http://docs.celeryproject.org/en/latest/getting-started/introduction.html">http://docs.celeryproject.org/en/latest/getting-started/introduction.html</a></p>
<h1 id="셀러리-입문하기"><a href="#셀러리-입문하기" class="headerlink" title="셀러리 입문하기"></a>셀러리 입문하기</h1><h2 id="widgets"><a href="#widgets" class="headerlink" title="widgets:"></a>widgets:</h2><ul>
<li><p>태스크 큐란 무엇인가? (What’s a Task Queue?)</p>
</li>
<li><p>뭐가 필요한가요? (What do I need?)</p>
</li>
<li><p>시작하기 (Get Started)</p>
</li>
<li><p>셀러리는.. (Celery is..)</p>
</li>
<li><p>셀러리의 기능들 (Features)</p>
</li>
<li><p>프레임워크와 함께 이용하기 (Framework Integration)</p>
</li>
<li><p>셀러리 설치하기 (Installation)</p>
</li>
</ul>
<h2 id="태스크-큐란-무엇인가"><a href="#태스크-큐란-무엇인가" class="headerlink" title="태스크 큐란 무엇인가?"></a>태스크 큐란 무엇인가?</h2><p>태스크 큐는 스레드간 혹은 기계 간 업무를 분산하는 목적으로 만들어진 메커니즘입니다.</p>
<p>태스크 큐에 들어가는 일거리들은 태스크(Task)라고 불리고 각각 독립된 워커(Worker)프로세스들은 새로운 일거리(Task)가 없는지 지속적으로 태스크 큐를 감시합니다.</p>
<p>셀러리는 메시지(message)를 통해 통신하는데요, 보통 브로커(Broker)가 클라이언트와 워커 사이에서 메시지를 중계해줍니다. 브로커는 클라이언트가 큐에 새로 추가한 태스크를 메시지로 워커에 전달해줍니다.</p>
<p>셀러리 시스템에서는 여러개의 워커와 브로커를 함께 사용할 수 있는데요, 이 덕분에 높은 가용성과 Scaling이 가능합니다.</p>
<p>셀러리는 Python으로 짜여져 있습니다. 하지만 어떤 언어를 통해서도 프로토콜을 통해 셀러리를 사용할 수 있습니다. 예를들어, Node나 PHP를 위한 <a href="https://github.com/mher/node-celery">node-celery</a>나 <a href="https://github.com/gjedeer/celery-php">PHP client</a>도 있답니다.</p>
<p>또, HTTP endpoint를 통해 webhook으로 태스크를 요청하는 것도 가능하답니다.</p>
<h2 id="뭐가-필요한가요"><a href="#뭐가-필요한가요" class="headerlink" title="뭐가 필요한가요?"></a>뭐가 필요한가요?</h2><p>셀러리를 사용하려면 메시지를 주고받아주는 브로커 등이 필요합니다. RabbitMQ나 Redis같은 브로커가 가장 좋은 선택이지만, 개발환경에서는 Sqlite와 같이 수많은 실험적인 대안도 있습니다.</p>
<p>셀러리는 단일 머신, 복수 머신, 혹은 데이터센터간에서도 사용 가능합니다.</p>
<h2 id="시작하기"><a href="#시작하기" class="headerlink" title="시작하기"></a>시작하기</h2><p>만약 여러분이 셀러리를 처음 이용하시거나 3.1버전 같은 이전 버전을 이용했다면, <a href="">셀러리 한 발자국 내밀기</a>나 <a href="">더 알아보기</a> 튜토리얼을 먼저 해보세요.</p>
<blockquote>
<p>버전 확인</p>
</blockquote>
<blockquote>
<p>셀러리 4.0은 Python2.7/3.4/3.5 PyPy5.4/5.5에서 정상적으로 동작합니다.</p>
</blockquote>
<h2 id="셀러리는"><a href="#셀러리는" class="headerlink" title="셀러리는.."></a>셀러리는..</h2><ul>
<li><p>단순해요!</p>
<p>셀러리는 사용하기도 쉽고 관리하기도 쉽습니다. 설정 파일도 필요하지 않아요!</p>
<p>가장 단순한 셀러리 앱은 아래와 같이 만들 수 있어요.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line"></span><br><span class="line">app = Celery(<span class="string">'hello'</span>, broker=<span class="string">'amqp://guest@localhost//'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello world'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>높은 가용성</p>
<p>워커와 클라이언트는 연결이 끊어지거나 실패하면 자동으로 다시 연결을 시도합니다. 그리고 몇몇 브로커들은 Primary/Primary나 Primary/Replica 의 복제방식을 통해 고가용성을 제공합니다.</p>
</li>
<li><p>빨라요!</p>
<p>하나의 셀러리 프로세스는 1분에 수십만개의 태스크를 처리할 수 있고, ms초 이하의 RTT(왕복지연시간)로 태스크를 처리 가능하답니다. (RabbitMQ, librabbitmq와 최적화된 설정을 할 경우)</p>
</li>
<li><p>유연해요!</p>
<p>셀러리의 대부분 파트는 그 자체로 이용할 수도 있고 원하는 만큼 확장도 가능합니다. Custom pool implementations, serializers, compression schemes, logging, schedulers, consumers, producers, broker transports을 포함해 더 많이요.</p>
</li>
</ul>
<h2 id="셀러리의-기능들"><a href="#셀러리의-기능들" class="headerlink" title="셀러리의 기능들"></a>셀러리의 기능들</h2><ul>
<li><p>모니터링</p>
<p>모니터링 이벤트 스트림은 각 워커에서 나오고, 클러스터에서 수행하는 작업을 실시간으로 알려줍니다.</p>
<p><a href="http://docs.celeryproject.org/en/latest/userguide/monitoring.html#guide-monitoring">더 알아보기..</a></p>
</li>
<li><p>워크 플로우</p>
<p>간단하거나 복잡한 워크플로우를 “캔버스”라는 도구를 통해 그룹핑, 체이닝, 청킹등을 할 수 있습니다.</p>
<p><a href="http://docs.celeryproject.org/en/latest/userguide/canvas.html#guide-canvas">더 알아보기..</a></p>
</li>
<li><p>시간 / 비율 제한</p>
<p>태스크가 시간당 얼마나 실행 될지 제어할 수 있고, 한 태스크가 얼마나 오랫동안 실행될지 허용할 수 있습니다. 각각의 워커마다 다르게 설정하거나 각각의 태스크마다도 다르게 설정할 수 있답니다.</p>
<p><a href="http://docs.celeryproject.org/en/latest/userguide/workers.html#worker-time-limits">더 알아보기..</a></p>
</li>
<li><p>스케쥴링</p>
<p>어떤 태스크를 정해진 시간에 실행할 수 있습니다. 또, 정해진 주기로 태스크를 실행 할 수도 있습니다. Crontab에서 사용하는 방식(분/시간/요일등등)을 이용할 수도 있습니다.</p>
<p><a href="http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html#guide-beat">더 알아보기..</a></p>
</li>
<li><p>사용자 컴포넌트</p>
<p>각각의 워커 컴포넌트들을 커스터마이징해 사용할 수 있습니다. 그리고 추가적인 컴포넌트도 커스터마이징해 사용할 수 있습니다. 워커는 내부 구조를 세밀하게 제어할수있는 종속성 그래프인 “bootsteps”를 사용하여 빌드됩니다.</p>
</li>
</ul>
<h2 id="프레임워크와-함께-이용하기"><a href="#프레임워크와-함께-이용하기" class="headerlink" title="프레임워크와 함께 이용하기"></a>프레임워크와 함께 이용하기</h2><p>셀러리는 웹 프레임 워크와 쉽게 함께 사용할 수 있고, 일부는 합쳐진 패키지도 있습니다.</p>
<ul>
<li>Pyramid: <a href="https://pypi.python.org/pypi/pyramid_celery/">pyramid_celery</a></li>
<li>Pylons: <a href="https://pypi.python.org/pypi/celery-pylons/">celery-pylons</a></li>
<li>Flask: 필요없음</li>
<li>Web2Py: <a href="https://pypi.python.org/pypi/web2py-celery/">web2py-celery</a></li>
<li>Tornado: <a href="https://pypi.python.org/pypi/tornado-celery/">tornado-celery</a></li>
</ul>
<p>Django의 경우에는 <a href="http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html#django-first-steps">장고와 함께하는 셀러리 첫걸음</a>을 참고하세요.</p>
<p>통합 패키지가 굳이 필요하지는 않지만 개발을 더 쉽게 해주고 DB 커넥션 등에서 중요한 hook를 추가하기도 하기때문에 이용하는 편이 낫습니다.</p>
<h2 id="설치하기"><a href="#설치하기" class="headerlink" title="설치하기"></a>설치하기</h2><p>셀러리는 PyPI를 통해 쉽게 설치할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U pip</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/03/01/HowToMakeWebCrawler-Save-with-Django/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-02-27-HowToMakeWebCrawler-Save-with-Django/python+django.jpg" alt="나만의 웹 크롤러 만들기(4): Django로 크롤링한 데이터 저장하기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-02-28T15:00:00.000Z">2017-03-01</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/howtomakewebcrawler/">howtomakewebcrawler</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/03/01/HowToMakeWebCrawler-Save-with-Django/">나만의 웹 크롤러 만들기(4): Django로 크롤링한 데이터 저장하기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>좀 더 보기 편한 <a href="https://beomi.github.io/gb-crawling/">깃북 버전의 나만의 웹 크롤러 만들기</a>가 나왔습니다!</p>
</blockquote>
<blockquote>
<p>(@2017.03.18) 본 블로그 테마가 업데이트되면서 구 블로그의 URL은 <a href="https://beomi.github.io/beomi.github.io_old/로">https://beomi.github.io/beomi.github.io_old/로</a> 변경되었습니다. 예제 코드에서는 변경을 완료하였지만 캡쳐 화면은 변경하지 않았으니 유의 바랍니다.</p>
</blockquote>
<p>이전게시글: <a href="/2017/02/27/HowToMakeWebCrawler-With-Selenium/">나만의 웹 크롤러 만들기(3): Selenium으로 무적 크롤러 만들기</a></p>
<p>Python을 이용해 <code>requests</code>와 <code>selenium</code>을 이용해 웹 사이트에서 데이터를 크롤링해 보았습니다.</p>
<p>하지만 이러한 데이터를 체계적으로 관리하려면 DB가 필요하고, 이러한 DB를 만들고 관리하는 방법이 여러가지가 있지만 이번 가이드에서는 Python 웹 프레임워크인 <code>django</code>의 Database ORM을 이용해 DB를 만들고 데이터를 저장해 보려 합니다.</p>
<p>이번 가이드에서는 1회차 가이드였던 이 블로그를 크롤링해서 나온 결과물을 Django ORM으로 Sqlite DB에 저장해보는 것까지를 다룹니다.</p>
<blockquote>
<p>이번 가이드는 기본적으로 Django의 <code>Model</code>에 대해 이해하고 있는 분들에게 추천합니다.</p>
</blockquote>
<blockquote>
<p>만약 django가 처음이시라면 <a href="https://djangogirlsseoul.gitbooks.io/django-tube/content/">DjangoGirls Tutorial: DjangoTube</a>를 따라해보시면 기본적인 이해에 도움이 되시리라 생각합니다. 30분 내외로 따라가실 수 있습니다.</p>
</blockquote>
<h1 id="Django-프로젝트-만들기"><a href="#Django-프로젝트-만들기" class="headerlink" title="Django 프로젝트 만들기"></a>Django 프로젝트 만들기</h1><h2 id="widgets"><a href="#widgets" class="headerlink" title="widgets:"></a>widgets:</h2><p>우선 크롤링 한 데이터를 저장할 Django 프로젝트와 앱을 만들고, Model을 통해 DB를 만들어야 합니다.</p>
<h2 id="Django-설치하기"><a href="#Django-설치하기" class="headerlink" title="Django 설치하기"></a>Django 설치하기</h2><p>Django는 pip로 간편하게 설치할 수 있습니다.</p>
<blockquote>
<p>가상환경을 이용해 설치하는 것을 추천합니다. 가상환경은 python3.4이후부터는 <code>python3 -m venv 가상환경이름</code>으로 만드실 수 있습니다.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.14.57.png" alt="django install success"></p>
<blockquote>
<p>글 작성 시점인 2017.02.28 기준 1.10.5 버전이 최신버전입니다.</p>
</blockquote>
<h2 id="Django-Start-Project-프로젝트-만들기"><a href="#Django-Start-Project-프로젝트-만들기" class="headerlink" title="Django Start Project | 프로젝트 만들기"></a>Django Start Project | 프로젝트 만들기</h2><p>django가 성공적으로 설치되면 <code>django-admin</code>이라는 명령어로 장고 프로젝트를 생성할 수 있습니다.</p>
<p>이번 가이드에서는 <code>websaver</code>라는 이름의 프로젝트를 만들어보겠습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject websaver</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.15.47.png" alt="startproject websaver"></p>
<blockquote>
<p>성공적으로 생길 경우 어떠한 반응도 나타나지 않습니다.</p>
</blockquote>
<p>위 명령어를 치면 명령어를 친 위치에 <code>websaver</code>라는 폴더가 생기고, 그 안의 구조는 아래와 같습니다.</p>
<blockquote>
<p><code>cd websaver</code>로 <code>websaver</code>폴더 안으로 진입한 상태입니다.</p>
</blockquote>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.18.06.png" alt="tree websaver"></p>
<blockquote>
<p>tree 명령어는 mac에서 <code>brew install tree</code>로 설치한 명령어입니다. 기본적으로는 깔려있지 않습니다.</p>
</blockquote>
<p>이와 같이 <code>manage.py</code>파일과 프로젝트 이름인 <code>websaver</code>라는 이름의 폴더가 함께 생성됩니다.</p>
<h2 id="Django-Start-App-장고-앱-만들기"><a href="#Django-Start-App-장고-앱-만들기" class="headerlink" title="Django Start App | 장고 앱 만들기"></a>Django Start App | 장고 앱 만들기</h2><p>Django는 프로젝트와 그 안의 <code>앱</code>으로 관리됩니다. 이 <code>앱</code>은 하나의 기능을 담당하는 단위로 보시면 됩니다.</p>
<p>앱은 <code>manage.py</code>파일을 통해 <code>startapp</code>이라는 명령어로 생성 가능합니다. <code>parsed_data</code>라는 이름의 앱을 만들어보겠습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp parsed_data</span><br></pre></td></tr></table></figure>

<blockquote>
<p>manage.py 파일이 있는 곳에서 실행합니다. django가 설치된 가상환경에 진입해 있는지 꼭 확인하세요!</p>
</blockquote>
<p>이제 아래와 같은 구조로 앱이 생겼을 것인데, 이 앱을 Django가 관리하도록 <code>websaver</code>폴더 안의 <code>settings.py</code>파일의 <code>INSTALLED_APPS</code>에 추가해줘야 합니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.32.06.png" alt="startapp parsed_data"></p>
<blockquote>
<p>유의: .pyc파일은 python실행시 생기는 캐싱 파일입니다. 없으셔도 전혀 문제는 발생하지 않습니다.</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># websaver/settings.py</span></span><br><span class="line">...</span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">    <span class="string">'parsed_data'</span>, <span class="comment"># 앱을 추가해 줍시다.</span></span><br><span class="line">]</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="Django-First-Migration-첫-마이그레이션"><a href="#Django-First-Migration-첫-마이그레이션" class="headerlink" title="Django First Migration | 첫 마이그레이션"></a>Django First Migration | 첫 마이그레이션</h2><p>​<br>장고는 <code>python manage.py migrate</code>이라는 명령어로 DB를 migrate합니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<p>위 명령어를 입력하면 아래와 같이 Django에서 사용하는 기본적인 DB가 생성됩니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.37.23.png" alt="First migrate"></p>
<h2 id="parsed-data-App-Model-parsed-data-앱-모델-만들기"><a href="#parsed-data-App-Model-parsed-data-앱-모델-만들기" class="headerlink" title="parsed_data App Model | parsed_data 앱 모델 만들기"></a>parsed_data App Model | parsed_data 앱 모델 만들기</h2><p>이제 DB구조를 관리해주는 <code>Model</code>을 만들어 줘야 합니다.</p>
<p>Django에서 모델은 앱 단위로 만들어지고 구성됩니다. 따라서 앞서 만들어준 <code>parsed_data</code>앱 안의 <code>models.py</code>파일을 수정해줘야 합니다.</p>
<p>이 모델 파일은 크롤링해온 데이터를 필드별로 저장하는 것이 목적입니다. 따라서 크롤링한 데이터를 파이썬이 관리할 수 있는 객체로 만들어두는 것이 중요합니다.</p>
<p>이번 가이드에서는 <a href="https://beomi.github.io/beomi.github.io_old/python/2017/01/19/HowToMakeWebCrawler.html">나만의 웹 크롤러 만들기 With Requests/BeautifulSoup</a>에서 만든 <code>parser.py</code>파일을 수정해 게시글의 title와 link를 DB에 저장해보겠습니다.</p>
<p>따라서 이번 앱의 모델에서는 title와 link라는 column을 가진 <code>BlogData</code>라는 이름의 Table을 DB에 만들면 됩니다.</p>
<blockquote>
<p>django models의 class는 DB의 Table이 됩니다.</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parsed_data/models.py</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlogData</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    link = models.URLField()</span><br></pre></td></tr></table></figure>

<p>이와 같이 만들어주면 <code>title</code>은 200글자 제한의 CharField로, <code>link</code>는 URLField로 지정됩니다.</p>
<h2 id="parsed-data-App-Makemigrations-amp-Migrate-앱-DB-반영하기"><a href="#parsed-data-App-Makemigrations-amp-Migrate-앱-DB-반영하기" class="headerlink" title="parsed_data App Makemigrations &amp; Migrate | 앱 DB 반영하기"></a>parsed_data App Makemigrations &amp; Migrate | 앱 DB 반영하기</h2><p>이제 해야 할 일은 Django가 모델을 관리하도록 하려면 <code>makemigrations</code>를 통해 DB의 변경 정보를 정리하고, <code>migrate</code>를 통해 실제 DB에 반영하는 과정을 진행해야 합니다.</p>
<blockquote>
<p>django가 설치된 가상환경에서 실행하도록 합시다. 명령어의 실행 위치는 <code>manage.py</code>파일이 있는 곳입니다.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations parsed_data</span><br><span class="line">python manage.py migrate parsed_data</span><br></pre></td></tr></table></figure>

<p>각 명령어 입력시 아래와 같이 결과가 나타난다면 성공적으로 DB에 반영된 것입니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2017.58.01.png" alt="parsed_data app migration"></p>
<h1 id="크롤링-함수-만들기"><a href="#크롤링-함수-만들기" class="headerlink" title="크롤링 함수 만들기"></a>크롤링 함수 만들기</h1><h2 id="widgets-1"><a href="#widgets-1" class="headerlink" title="widgets:"></a>widgets:</h2><p><a href="https://beomi.github.io/beomi.github.io_old/python/2017/01/19/HowToMakeWebCrawler.html">나만의 웹 크롤러 만들기 With Requests/BeautifulSoup</a>에서 만든 <code>parser.py</code>파일을 수정해보겠습니다.</p>
<p>이번 파일은 <code>manage.py</code>가 있는 위치에 <code>parser.py</code>라는 이름으로 저장해보겠습니다.</p>
<blockquote>
<p>만약 <code>requests</code>와 <code>bs4</code>가 설치되어있지 않다면 pip로 설치해주세요!</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># python파일의 위치</span></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line">req = requests.get(<span class="string">'https://beomi.github.io/beomi.github.io_old/'</span>)</span><br><span class="line">html = req.text</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">my_titles = soup.select(</span><br><span class="line">    <span class="string">'h3 &gt; a'</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">data = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> title <span class="keyword">in</span> my_titles:</span><br><span class="line">    data[title.text] = title.get(<span class="string">'href'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(os.path.join(BASE_DIR, <span class="string">'result.json'</span>), <span class="string">'w+'</span>) <span class="keyword">as</span> json_file:</span><br><span class="line">    json.dump(data, json_file)</span><br></pre></td></tr></table></figure>

<p>이전의 <code>parser.py</code>파일은 위와 같습니다. 이제 이 파일을 <code>parse_blog</code>라는 함수로 만들고, {‘블로그 글 타이틀’: ‘블로그 글 링크’}로 이루어진 딕셔너리를 반환하도록 만들어 봅시다.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_blog</span><span class="params">()</span>:</span></span><br><span class="line">    req = requests.get(<span class="string">'https://beomi.github.io/beomi.github.io_old/'</span>)</span><br><span class="line">    html = req.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">    my_titles = soup.select(</span><br><span class="line">        <span class="string">'h3 &gt; a'</span></span><br><span class="line">        )</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> title <span class="keyword">in</span> my_titles:</span><br><span class="line">        data[title.text] = title.get(<span class="string">'href'</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>

<p>이제 <code>parse_blog</code>라는 함수를 다른 파일에서 import해 사용할 수 있습니다.</p>
<p>또한, 현재 프로젝트 폴더의 구조는 아래와 같습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.05.30.png" alt="project folder tree"></p>
<p>하지만 현재 <code>parse_blog</code>함수는 Django에 저장하는 기능을 갖고 있지 않습니다. 따라서 약간 더 추가를 해줘야 합니다.</p>
<h2 id="Django-환경-불러오기"><a href="#Django-환경-불러오기" class="headerlink" title="Django 환경 불러오기"></a>Django 환경 불러오기</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="comment"># 아래 4줄을 추가해 줍니다.</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># Python이 실행될 때 DJANGO_SETTINGS_MODULE이라는 환경 변수에 현재 프로젝트의 settings.py파일 경로를 등록합니다.</span></span><br><span class="line">os.environ.setdefault(<span class="string">"DJANGO_SETTINGS_MODULE"</span>, <span class="string">"websaver.settings"</span>)</span><br><span class="line"><span class="comment"># 이제 장고를 가져와 장고 프로젝트를 사용할 수 있도록 환경을 만듭니다.</span></span><br><span class="line"><span class="keyword">import</span> django</span><br><span class="line">django.setup()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_blog</span><span class="params">()</span>:</span></span><br><span class="line">    req = requests.get(<span class="string">'https://beomi.github.io/beomi.github.io_old/'</span>)</span><br><span class="line">    html = req.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">    my_titles = soup.select(</span><br><span class="line">        <span class="string">'h3 &gt; a'</span></span><br><span class="line">        )</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> title <span class="keyword">in</span> my_titles:</span><br><span class="line">        data[title.text] = title.get(<span class="string">'href'</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>

<p>위 코드에서 아래 4줄을 추가해 줄 경우, 이 파일을 단독으로 실행하더라도 마치 <code>manage.py</code>을 통해 django를 구동한 것과 같이 django환경을 사용할 수 있게 됩니다.</p>
<h2 id="Django-ORM으로-데이터-저장하기"><a href="#Django-ORM으로-데이터-저장하기" class="headerlink" title="Django ORM으로 데이터 저장하기"></a>Django ORM으로 데이터 저장하기</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ.setdefault(<span class="string">"DJANGO_SETTINGS_MODULE"</span>, <span class="string">"websaver.settings"</span>)</span><br><span class="line"><span class="keyword">import</span> django</span><br><span class="line">django.setup()</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>python manage.py shell</code>을 실행하는 것과 비슷한 방법입니다.</p>
</blockquote>
<p>이제 models에서 우리가 만든 <code>BlogData</code>를 import해 봅시다.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parser.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ.setdefault(<span class="string">"DJANGO_SETTINGS_MODULE"</span>, <span class="string">"websaver.settings"</span>)</span><br><span class="line"><span class="keyword">import</span> django</span><br><span class="line">django.setup()</span><br><span class="line"><span class="comment"># BlogData를 import해옵니다</span></span><br><span class="line"><span class="keyword">from</span> parsed_data.models <span class="keyword">import</span> BlogData</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_blog</span><span class="params">()</span>:</span></span><br><span class="line">    req = requests.get(<span class="string">'https://beomi.github.io/beomi.github.io_old/'</span>)</span><br><span class="line">    html = req.text</span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">    my_titles = soup.select(</span><br><span class="line">        <span class="string">'h3 &gt; a'</span></span><br><span class="line">        )</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> title <span class="keyword">in</span> my_titles:</span><br><span class="line">        data[title.text] = title.get(<span class="string">'href'</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 이 명령어는 이 파일이 import가 아닌 python에서 직접 실행할 경우에만 아래 코드가 동작하도록 합니다.</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    blog_data_dict = parse_blog()</span><br><span class="line">    <span class="keyword">for</span> t, l <span class="keyword">in</span> blog_data_dict.items():</span><br><span class="line">        BlogData(title=t, link=l).save()</span><br></pre></td></tr></table></figure>

<p>위와 같이 <code>parser.py</code>를 수정한 후 터미널에서 <code>parser.py</code>파일을 실행해 봅시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python parser.py</span><br></pre></td></tr></table></figure>

<p>아무런 에러가 나지 않는다면 성공적으로 저장된 것입니다.</p>
<h2 id="저장된-데이터-Django-Admin에서-확인하기"><a href="#저장된-데이터-Django-Admin에서-확인하기" class="headerlink" title="저장된 데이터 Django Admin에서 확인하기"></a>저장된 데이터 Django Admin에서 확인하기</h2><h3 id="SuperUser-관리자계정-만들기"><a href="#SuperUser-관리자계정-만들기" class="headerlink" title="SuperUser | 관리자계정 만들기"></a>SuperUser | 관리자계정 만들기</h3><p>Django는 Django Admin이라는 강력한 기능을 제공합니다.</p>
<p>우선 Admin 계정을 만들어야 합니다. <code>createsuperuser</code> 명령어로 만들 수 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.18.49.png" alt="createsuperuser"></p>
<p>기본적으로 유저이름, 이메일, 비밀번호를 받습니다.</p>
<blockquote>
<p>이메일은 입력하지 않아도 됩니다.</p>
</blockquote>
<h3 id="앱에-Admin-등록하기"><a href="#앱에-Admin-등록하기" class="headerlink" title="앱에 Admin 등록하기"></a>앱에 Admin 등록하기</h3><p>Django가 어떤 앱을 admin에서 관리하도록 하려면 앱 폴더(<code>parsed_data</code>) 안의 <code>admin.py</code>파일을 수정해줘야 합니다.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parsed_data/admin.py</span></span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="comment"># models에서 BlogData를 import 해옵니다.</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> BlogData</span><br><span class="line"></span><br><span class="line"><span class="comment"># 아래의 코드를 입력하면 BlogData를 admin 페이지에서 관리할 수 있습니다.</span></span><br><span class="line">admin.site.register(BlogData)</span><br></pre></td></tr></table></figure>

<h3 id="Django-Runserver-장고-서버-실행하기"><a href="#Django-Runserver-장고-서버-실행하기" class="headerlink" title="Django Runserver | 장고 서버 실행하기"></a>Django Runserver | 장고 서버 실행하기</h3><p>이제 <code>manage.py</code>가 있는 위치에서 <code>runserver</code>명령어로 장고 개발 서버를 실행해 봅시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>

<p>아래와 같이 나타난다면 성공적으로 서버가 실행된 것입니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.26.07.png" alt="django runserver"></p>
<p>이제 <a href="http://localhost:8000/admin/">http://localhost:8000/admin/</a>로 들어가 봅시다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.27.23.png" alt="Django admin login page"></p>
<p>아까 <code>createsuperuser</code>로 만든 계정으로 로그인 해 봅시다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.28.09.png" alt="django admin page"></p>
<p>우리가 만든 <code>parsed_data</code>앱 안에 <code>BlogData</code>라는 항목이 나와있는 것을 볼 수 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.28.54.png" alt="blogdata admin list"></p>
<p><code>BlogData object</code>라는 이름으로 데이터들이 들어와 있는 것을 확인할 수 있습니다. 하나를 클릭해 들어가 보면 아래와 같이 title와 link가 성공적으로 들어와 있는 것을 볼 수 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.29.43.png" alt="blogdata specific data"></p>
<h1 id="약간-더-나아가기"><a href="#약간-더-나아가기" class="headerlink" title="약간 더 나아가기"></a>약간 더 나아가기</h1><h2 id="widgets-2"><a href="#widgets-2" class="headerlink" title="widgets:"></a>widgets:</h2><p>위에서 Admin페이지에 들어갈 때 모든 데이터들의 이름이 <code>BlogData object</code>로 나와있는 것을 볼 수 있습니다.</p>
<p>우리가 만들어 준 <code>parsed_data/models.py</code>파일의 <code>BlogData</code> Class를 살펴보면 <code>models.Model</code>클래스를 상속받아 만들었고, 이 클래스는 기본적으로 <code>ClassName + object</code>라는 값을 반환하는 <code>__str__</code>함수를 내장하고 있습니다.</p>
<p>따라서 <code>models.Model</code>을 상속받은 <code>BlogData</code>의 <code>__str__</code>함수에서는 <code>BlogData object</code>라는 값을 반환합니다. 이 <code>__str__</code>함수를 오버라이딩해 사용하면 Admin에서 데이터의 이름을 좀 더 직관적으로 알 수 있습니다.</p>
<h2 id="str-함수-오버라이딩하기"><a href="#str-함수-오버라이딩하기" class="headerlink" title="str 함수 오버라이딩하기"></a><strong>str</strong> 함수 오버라이딩하기</h2><p><code>parsed_data</code>앱 폴더 안의 <code>models.py</code>파일을 아래와 같이 수정해 봅시다.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parsed_data/models.py</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlogData</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    link = models.URLField()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="keyword">return</span> self.title</span><br></pre></td></tr></table></figure>

<p>위 코드는 BlogData 데이터 객체의 <code>title</code> 값을 반환합니다.</p>
<p>이제 장고 서버를 다시 켜주고 <a href="http://localhost:8000/admin/parsed_data/blogdata/">BlogData admin page</a>로 들어가면 타이틀 이름으로 된 데이터들을 볼 수 있습니다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-28%2018.38.11.png" alt="title list admin page"></p>
<blockquote>
<p>현재 <code>models.py</code>파일을 수정했지만 DB에 반영되는 사항이 아니기 때문에 <code>makemigrations</code>나 <code>migrate</code>를 해줄 필요가 없습니다.</p>
</blockquote>
<h1 id="다음-가이드에서는"><a href="#다음-가이드에서는" class="headerlink" title="다음 가이드에서는.."></a>다음 가이드에서는..</h1><h2 id="widgets-3"><a href="#widgets-3" class="headerlink" title="widgets:"></a>widgets:</h2><p>다음 가이드는 <strong>주기적</strong>으로 데이터를 크롤링 해, <strong>새로운</strong> 데이터가 생기는 경우 텔레그램 봇으로 메시지 알림을 보내주는 과정을 다룰 예정입니다.</p>
<p>다음 가이드: <a href="/2017/04/20/HowToMakeWebCrawler-Notice-with-Telegram/">나만의 웹 크롤러 만들기(5): 웹페이지 업데이트를 알려주는 Telegram 봇</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/02/27/HowToMakeWebCrawler-With-Selenium/" class="image is-7by1">
            <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2017-01-25-HowToMakeWebCrawler-With-Selenium/selenium1.jpg" alt="나만의 웹 크롤러 만들기(3): Selenium으로 무적 크롤러 만들기">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-02-26T15:00:00.000Z">2017-02-27</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/python/">python</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/python/howtomakewebcrawler/">howtomakewebcrawler</a>
                </div>
                
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/02/27/HowToMakeWebCrawler-With-Selenium/">나만의 웹 크롤러 만들기(3): Selenium으로 무적 크롤러 만들기</a>
            
        </h1>
        <div class="content">
            <blockquote>
<p>좀 더 보기 편한 <a href="https://beomi.github.io/gb-crawling/">깃북 버전의 나만의 웹 크롤러 만들기</a>가 나왔습니다!</p>
</blockquote>
<blockquote>
<p>Updated @ 2019.10.10. Typo/Layout fix, 네이버 로그인 Captcha관련 수정 추가</p>
</blockquote>
<p>이전게시글: <a href="/2017/01/20/HowToMakeWebCrawler-With-Login/">나만의 웹 크롤러 만들기(2): Login with Session</a></p>
<h2 id="Selenium이란"><a href="#Selenium이란" class="headerlink" title="Selenium이란?"></a>Selenium이란?</h2><p>Selenium은 주로 웹앱을 테스트하는데 이용하는 프레임워크다. <code>webdriver</code>라는 API를 통해 운영체제에 설치된 Chrome등의 브라우저를 제어하게 된다.</p>
<p>브라우저를 직접 동작시킨다는 것은 JavaScript를 이용해 비동기적으로 혹은 뒤늦게 불러와지는 컨텐츠들을 가져올 수 있다는 것이다. 즉, ‘눈에 보이는’ 컨텐츠라면 모두 가져올 수 있다는 뜻이다. 우리가 requests에서 사용했던 <code>.text</code>의 경우 브라우저에서 ‘소스보기’를 한 것과 같이 동작하여, JS등을 통해 동적으로 DOM이 변화한 이후의 HTML을 보여주지 않는다. 반면 Selenium은 실제 웹 브라우저가 동작하기 때문에 JS로 렌더링이 완료된 후의 DOM결과물에 접근이 가능하다.</p>
<h2 id="어떻게-설치하나"><a href="#어떻게-설치하나" class="headerlink" title="어떻게 설치하나?"></a>어떻게 설치하나?</h2><h3 id="pip-selenium-package"><a href="#pip-selenium-package" class="headerlink" title="pip selenium package"></a>pip selenium package</h3><p>Selenium을 설치하는 것은 기본적으로 <code>pip</code>를 이용한다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure>

<blockquote>
<p>참고: Selenium의 버전은 자주 업데이트 되고, 브라우저의 업데이트 마다 새로운 Driver를 잡아주기 때문에 항상 최신버전을 깔아 주는 것이 좋다.</p>
</blockquote>
<p>이번 튜토리얼에서는 <code>BeautifulSoup</code>이 설치되어있다고 가정합니다.</p>
<blockquote>
<p>BeautifulSoup은 <code>pip install bs4</code>로 설치 가능합니다.</p>
</blockquote>
<h3 id="webdriver"><a href="#webdriver" class="headerlink" title="webdriver"></a>webdriver</h3><p>Selenium은 <code>webdriver</code>라는 것을 통해 디바이스에 설치된 브라우저들을 제어할 수 있다. 이번 가이드에서는 Chrome을 사용해 볼 예정이다.</p>
<h3 id="Chrome-WebDriver"><a href="#Chrome-WebDriver" class="headerlink" title="Chrome WebDriver"></a>Chrome WebDriver</h3><p>크롬을 사용하려면 로컬에 크롬이 설치되어있어야 한다.</p>
<p>그리고 크롬 드라이버를 다운로드 받아주자.</p>
<p><a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></p>
<p>글 수정일자인 2019년 10월 10일에는 크롬 77버전이 최신이며, 해당하는 크롬 드라이버를 받아야 한다.</p>
<blockquote>
<p>Update @ 2019.10.10</p>
<p>크롬에서는 현재 <code>버전별</code> 지정된 chromedriver를 받도록 안내하며, 버전에 일치하지 않는 드라이버를 사용하면 에러가 납니다.</p>
<p>현재 사용하는 크롬의 버전은 크롬 창에 👉 <code>chrome://version</code> 👈 이 URL을 주소창에 그대로 입력하면(http없이) 버전을 확인할 수 있습니다.</p>
<p><img src="https://beomi-tech-blog.s3.amazonaws.com/img/2019-10-10-085013.png" alt="스크린샷 2019-10-10 오후 5.49.07"></p>
</blockquote>
<p><img src="https://beomi-tech-blog.s3.amazonaws.com/img/2019-10-10-085538.png" alt="스크린샷 2019-10-10 오후 5.53.25"></p>
<p>버전을 클릭하면 아래와 같은 OS별 Driver파일이 나열되어있다. 사용하는 OS에 따른 driver를 받아주자.</p>
<p><img src="https://beomi-tech-blog.s3.amazonaws.com/img/2019-10-10-085753.png" alt="스크린샷 2019-10-10 오후 5.56.03"></p>
<p>zip파일을 받고 풀어주면 <code>chromedriver</code>라는 파일이 저장된다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2021.41.17.png" alt=""></p>
<p>위 폴더를 기준으로 할 경우 <code>/Users/beomi/Downloads/chromedriver</code>가 크롬드라이버 파일의 위치가 된다.</p>
<p>이 경로를 나중에 Selenium 객체를 생성할 때 지정해 주어야 한다. (그래야 python이 chromedriver를 통해 크롬 브라우저를 조작할 수 있다!)</p>
<h3 id="PhantomJS-webdriver"><a href="#PhantomJS-webdriver" class="headerlink" title="PhantomJS webdriver"></a>PhantomJS webdriver</h3><blockquote>
<p>단, 2018년+ 기준 PhantomJS는 더이상 개발되지 않고 있기 때문에 앞으로는 크롬의 <code>headless</code>모드를 사용하는 것을 추천합니다.</p>
</blockquote>
<p>PhantomJS는 기본적으로 WebTesting을 위해 나온 Headless Browser다.(즉, 화면이 존재하지 않는다)</p>
<p>하지만 JS등의 처리를 온전하게 해주며 CLI환경에서도 사용이 가능하기 때문에, 만약 CLI서버 환경에서 돌아가는 크롤러라면 PhantomJS를 사용하는 것도 방법이다.</p>
<p>PhantomJS는 공식 프로젝트의 <a href="http://phantomjs.org/download.html">PhantomJS Download Page</a>에서 받을 수 있다.</p>
<p>Binary 자체로 제공되기 때문에, Linux를 제외한 OS에서는 외부 dependency없이 바로 실행할 수 있다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2021.47.01.png" alt="Extracted PhantomJS Zip file"></p>
<p>압축을 풀어주면 아래와 같은 많은 파일들이 있지만, 우리가 사용하는 것은 <code>bin</code>폴더 안의 <code>phantomjs</code>파일이다.</p>
<p>위 폴더 기준으로 할 경우 <code>/Users/beomi/Downloads/phantomjs-2.1.1-macosx/bin/phantomjs</code>가 PhantomJS드라이버의 위치다.</p>
<h2 id="Selenium으로-사이트-브라우징"><a href="#Selenium으로-사이트-브라우징" class="headerlink" title="Selenium으로 사이트 브라우징"></a>Selenium으로 사이트 브라우징</h2><p>Selenium은 <code>webdriver api</code>를 통해 브라우저를 제어한다.</p>
<p>우선 <code>webdriver</code>를 import해주자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br></pre></td></tr></table></figure>

<p>이제 <code>driver</code>라는 이름의 webdriver 객체를 만들어 주자.</p>
<blockquote>
<p>이름이 꼭 <code>driver</code>일 필요는 없다.</p>
<p>이번 가이드에서는 크롬을 기본적으로 이용할 예정이다.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># Chrome의 경우 | 아까 받은 chromedriver의 위치를 지정해준다.</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line"><span class="comment"># PhantomJS의 경우 | 아까 받은 PhantomJS의 위치를 지정해준다.</span></span><br><span class="line"><span class="comment"># driver = webdriver.PhantomJS('/Users/beomi/Downloads/phantomjs-2.1.1-macosx/bin/phantomjs')</span></span><br></pre></td></tr></table></figure>

<p>Selenium은 기본적으로 웹 자원들이 모두 로드될때까지 기다려주지만, 암묵적으로 모든 자원이 로드될때 까지 기다리게 하는 시간을 직접 <code>implicitly_wait</code>을 통해 지정할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line"><span class="comment"># 암묵적으로 웹 자원 로드를 위해 3초까지 기다려 준다.</span></span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>이제 특정 url로 브라우저를 켜 보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># url에 접근한다.</span></span><br><span class="line">driver.get(<span class="string">'https://google.com'</span>)</span><br></pre></td></tr></table></figure>

<p>만약 chromedriver의 위치가 정확하다면 새 크롬 화면이 뜨고 구글 첫 화면으로 들어가질 것이다.</p>
<p>Selenium은 driver객체를 통해 여러가지 메소드를 제공한다.</p>
<blockquote>
<p>아래의 메소드들은 보통 <code>driver.~~~</code> 방식으로 사용합니다.</p>
</blockquote>
<p>URL에 접근하는 메소드,</p>
<ul>
<li><code>get(&#39;http://url.com&#39;)</code></li>
</ul>
<p>페이지의 단일 element에 접근하는 메소드,</p>
<ul>
<li><code>find_element_by_name(&#39;HTML_name&#39;)</code></li>
<li><code>find_element_by_id(&#39;HTML_id&#39;)</code></li>
<li><code>find_element_by_xpath(&#39;/html/body/some/xpath&#39;)</code></li>
<li><code>find_element_by_css_selector(&#39;#css &gt; div.selector&#39;)</code></li>
<li><code>find_element_by_class_name(&#39;some_class_name&#39;)</code></li>
<li><code>find_element_by_tag_name(&#39;h1&#39;)</code></li>
</ul>
<p>페이지의 여러 elements에 접근하는 메소드 등이 있다. (대부분 <code>element</code> 를 <code>elements</code> 로 바꾸기만 하면 된다.)</p>
<ul>
<li><code>find_elements_by_css_selector(&#39;#css &gt; div.selector&#39;)</code></li>
</ul>
<p>위 메소드들을 활용시 HTML을 브라우저에서 파싱해주기 때문에 굳이 Python와 BeautifulSoup을 사용하지 않아도 된다.</p>
<p>하지만 Selenium에 내장된 함수만 사용가능하기 때문에 좀더 사용이 편리한 soup객체를 이용하려면 <code>driver.page_source</code> API를 이용해 현재 렌더링 된 페이지의 Elements를 모두 가져올 수 있다.</p>
<blockquote>
<p><code>driver.page_source</code>: 브라우저에 보이는 그대로의 HTML, 크롬 개발자 도구의 <code>Element</code> 탭 내용과 동일.</p>
<p><code>requests</code> 통해 가져온 <code>req.text</code>: HTTP요청 결과로 받아온 HTML, 크롬 개발자 도구의 <code>페이지 소스</code> 내용과 동일.</p>
<p>위 2개는 사이트에 따라 같을수도 다를수도 있습니다.</p>
</blockquote>
<h2 id="네이버-로그인-하기"><a href="#네이버-로그인-하기" class="headerlink" title="네이버 로그인 하기"></a>네이버 로그인 하기</h2><p>네이버는 requests를 이용해 로그인하는 것이 어렵다. 프론트 단에서 JS처리를 통해 로그인 처리를 하기 때문인데, Selenium을 이용하면 보다 쉽게 로그인을 할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># url에 접근한다.</span></span><br><span class="line">driver.get(<span class="string">'https://nid.naver.com/nidlogin.login'</span>)</span><br></pre></td></tr></table></figure>

<p>네이버 로그인 화면을 확인 해 보면 아이디를 입력받는 부분의 name이 <code>id</code>, ​비밀번호를 입력받는 부분의 name이 <code>pw</code>인 것을 알 수 있다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2022.19.18.png" alt="Naver Login Page"></p>
<p><code>find_element_by_name</code>을 통해 아이디/비밀번호 input 태그를 잡아주고, 값을 입력해 보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line">driver.get(<span class="string">'https://nid.naver.com/nidlogin.login'</span>)</span><br><span class="line"><span class="comment"># 아이디/비밀번호를 입력해준다.</span></span><br><span class="line">driver.find_element_by_name(<span class="string">'id'</span>).send_keys(<span class="string">'naver_id'</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">'pw'</span>).send_keys(<span class="string">'mypassword1234'</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2022.23.11.png" alt="Naver Login Input"></p>
<p>성공적으로 값이 입력된 것을 확인할 수 있다.</p>
<p>이제 Login버튼을 눌러 실제로 로그인이 되는지 확인해 보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line">driver.get(<span class="string">'https://nid.naver.com/nidlogin.login'</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">'id'</span>).send_keys(<span class="string">'naver_id'</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">'pw'</span>).send_keys(<span class="string">'mypassword1234'</span>)</span><br><span class="line"><span class="comment"># 로그인 버튼을 눌러주자.</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">'//*[@id="frmNIDLogin"]/fieldset/input'</span>).click()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Update @ 2019.10.10.</p>
</blockquote>
<p>하지만 로그인이 이전처럼 잘 되지 않고 Captcha를 요구하는 창이 뜰 수 있다.</p>
<p>네이버에서 </p>
<p>성공적으로 로그인이 되는 것을 확인할 수 있다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2022.28.00.png" alt="Naver Login Success"></p>
<p>로그인이 필요한 페이지인 네이버 페이의 주문내역 페이지를 가져와보자.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2022.38.43.png" alt="Naver Pay Order"></p>
<p>네이버 페이의 Url은 <code>https://order.pay.naver.com/home</code> 이다. 위 페이지의 알림 텍스트를 가져와 보자.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line">driver.get(<span class="string">'https://nid.naver.com/nidlogin.login'</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">'id'</span>).send_keys(<span class="string">'naver_id'</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">'pw'</span>).send_keys(<span class="string">'mypassword1234'</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">'//*[@id="frmNIDLogin"]/fieldset/input'</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Naver 페이 들어가기</span></span><br><span class="line">driver.get(<span class="string">'https://order.pay.naver.com/home'</span>)</span><br><span class="line">html = driver.page_source</span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>)</span><br><span class="line">notices = soup.select(<span class="string">'div.p_inr &gt; div.p_info &gt; a &gt; span'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> notices:</span><br><span class="line">    print(n.text.strip())</span><br></pre></td></tr></table></figure>

<p>로그인이 잘 되고, 성공적으로 리스트를 받아오는 것을 확인해 볼 수 있다.</p>
<p><img src="https://d1sr4ybm5bj1wl.cloudfront.net/img/dropbox/2017-02-27%2022.41.46.png" alt="Result"></p>
<h2 id="정리하기"><a href="#정리하기" class="headerlink" title="정리하기"></a>정리하기</h2><p>Selenium은 웹 테스트 자동화 도구이지만, 멋진 크롤링 도구로 사용할 수 있다.</p>
<p>또한, BeautifulSoup와 함께 사용도 가능하기 때문에 크롤링을 하는데 제약도 줄어 훨씬 쉽게 크롤링을 할 수 있다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># setup Driver|Chrome : 크롬드라이버를 사용하는 driver 생성</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'/Users/beomi/Downloads/chromedriver'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">3</span>) <span class="comment"># 암묵적으로 웹 자원을 (최대) 3초 기다리기</span></span><br><span class="line"><span class="comment"># Login</span></span><br><span class="line">driver.get(<span class="string">'https://nid.naver.com/nidlogin.login'</span>) <span class="comment"># 네이버 로그인 URL로 이동하기</span></span><br><span class="line">driver.find_element_by_name(<span class="string">'id'</span>).send_keys(<span class="string">'naver_id'</span>) <span class="comment"># 값 입력</span></span><br><span class="line">driver.find_element_by_name(<span class="string">'pw'</span>).send_keys(<span class="string">'mypassword1234'</span>)</span><br><span class="line">driver.find_element_by_xpath(</span><br><span class="line">    <span class="string">'//*[@id="frmNIDLogin"]/fieldset/input'</span></span><br><span class="line">).click() <span class="comment"># 버튼클릭하기</span></span><br><span class="line">driver.get(<span class="string">'https://order.pay.naver.com/home'</span>) <span class="comment"># Naver 페이 들어가기</span></span><br><span class="line">html = driver.page_source <span class="comment"># 페이지의 elements모두 가져오기</span></span><br><span class="line">soup = BeautifulSoup(html, <span class="string">'html.parser'</span>) <span class="comment"># BeautifulSoup사용하기</span></span><br><span class="line">notices = soup.select(<span class="string">'div.p_inr &gt; div.p_info &gt; a &gt; span'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> notices:</span><br><span class="line">    print(n.text.strip())</span><br></pre></td></tr></table></figure>

<h2 id="다음-가이드"><a href="#다음-가이드" class="headerlink" title="다음 가이드"></a>다음 가이드</h2><p>Selenium으로 많은 사이트에서 여러 정보를 가져와 볼 수 있게 되었습니다. </p>
<p>하지만 가져온 데이터를 DB에 저장하려면 약간의 어려움이 따르게 됩니다.</p>
<p>다음 시간에는 Django의 ORM을 이용해 sqlite3 DB에 데이터를 저장해보는 방법에 대해 알아보겠습니다.</p>
<p>다음 가이드: <a href="/2017/03/01/HowToMakeWebCrawler-Save-with-Django/">나만의 웹 크롤러 만들기(4): Django로 크롤링한 데이터 저장하기</a></p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/page/6/">이전</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/8/">다음</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/">1</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/6/">6</a></li>
            
            <li><a class="pagination-link is-current" href="/page/7/">7</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/8/">8</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/9/">9</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/10/">10</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/profile_beomi.jpg" alt="Junbum Lee">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Junbum Lee
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Beomi&#39;s tech blog
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Seoul, KR</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/beomi">
                
                <i class="fab fa-github"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                카테고리
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/DataCollection/">
            <span class="level-start">
                <span class="level-item">DataCollection</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DataCollection/Twitter/">
            <span class="level-start">
                <span class="level-item">Twitter</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/">
            <span class="level-start">
                <span class="level-item">DevEnv</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DevEnv/DataScience/">
            <span class="level-start">
                <span class="level-item">DataScience</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/DeepLearning/">
            <span class="level-start">
                <span class="level-item">DeepLearning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/Git/">
            <span class="level-start">
                <span class="level-item">Git</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/DevEnv/Ubuntu/">
            <span class="level-start">
                <span class="level-item">Ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Django/">
            <span class="level-start">
                <span class="level-item">Django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Django/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/DjangoTDDStudy/">
            <span class="level-start">
                <span class="level-item">DjangoTDDStudy</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/DjangoTDDStudy/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/MacOS/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/NLP/">
            <span class="level-start">
                <span class="level-item">NLP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/NLP/LanguageModel/">
            <span class="level-start">
                <span class="level-item">LanguageModel</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/NLP/Unsupervised/">
            <span class="level-start">
                <span class="level-item">Unsupervised</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Postmortem/">
            <span class="level-start">
                <span class="level-item">Postmortem</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/Python/Celery/">
            <span class="level-start">
                <span class="level-item">Celery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/Fabric/">
            <span class="level-start">
                <span class="level-item">Fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/MacOS/">
            <span class="level-start">
                <span class="level-item">MacOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/Tech/">
            <span class="level-start">
                <span class="level-item">Tech</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Translation/">
            <span class="level-start">
                <span class="level-item">Translation</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/aws/">
            <span class="level-start">
                <span class="level-item">aws</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/aws/python/">
            <span class="level-start">
                <span class="level-item">python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/azure/">
            <span class="level-start">
                <span class="level-item">azure</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/blog/">
            <span class="level-start">
                <span class="level-item">blog</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/blog/github/">
            <span class="level-start">
                <span class="level-item">github</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/django/">
            <span class="level-start">
                <span class="level-item">django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/django/fabric/">
            <span class="level-start">
                <span class="level-item">fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/django/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/flask/">
            <span class="level-start">
                <span class="level-item">flask</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/flask/sqlalchemy/">
            <span class="level-start">
                <span class="level-item">sqlalchemy</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/howtomakewebcrawler/">
            <span class="level-start">
                <span class="level-item">howtomakewebcrawler</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/javascript/">
            <span class="level-start">
                <span class="level-item">javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/javascript/webpack/">
            <span class="level-start">
                <span class="level-item">webpack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/life/">
            <span class="level-start">
                <span class="level-item">life</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/machinelearning/">
            <span class="level-start">
                <span class="level-item">machinelearning</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/machinelearning/seminar/">
            <span class="level-start">
                <span class="level-item">seminar</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/macos/">
            <span class="level-start">
                <span class="level-item">macos</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/macos/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/nlp/">
            <span class="level-start">
                <span class="level-item">nlp</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/nlp/languagemodel/">
            <span class="level-start">
                <span class="level-item">languagemodel</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/postmortem/">
            <span class="level-start">
                <span class="level-item">postmortem</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/">
            <span class="level-start">
                <span class="level-item">python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">25</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/python/aws/">
            <span class="level-start">
                <span class="level-item">aws</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/celery/">
            <span class="level-start">
                <span class="level-item">celery</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/dataanalysis/">
            <span class="level-start">
                <span class="level-item">dataanalysis</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/django/">
            <span class="level-start">
                <span class="level-item">django</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/fabric/">
            <span class="level-start">
                <span class="level-item">fabric</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/flask/">
            <span class="level-start">
                <span class="level-item">flask</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/howtomakewebcrawler/">
            <span class="level-start">
                <span class="level-item">howtomakewebcrawler</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/pyspark/">
            <span class="level-start">
                <span class="level-item">pyspark</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/python/ubuntu/">
            <span class="level-start">
                <span class="level-item">ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/react/">
            <span class="level-start">
                <span class="level-item">react</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/react/javascript/">
            <span class="level-start">
                <span class="level-item">javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/tips/githubpages/">
            <span class="level-start">
                <span class="level-item">githubpages</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/ubuntu/">
            <span class="level-start">
                <span class="level-item">ubuntu</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/ubuntu/tips/">
            <span class="level-start">
                <span class="level-item">tips</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/vlang/">
            <span class="level-start">
                <span class="level-item">vlang</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            최근 글
        </h3>
        
        <article class="media">
            
            <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/16/1*VZpuai6qP4iNLc7opAkQxA.jpeg" alt="KcBERT Finetune with PyTorch-Lightning v1.3.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-15T15:00:00.000Z">2021-03-16</time></div>
                    <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT Finetune with PyTorch-Lightning v1.3.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/15/fine-tuning_methods-20210315151211294.png" alt="KcBERT MLM Finetune으로 Domain adaptation하기">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-14T15:00:00.000Z">2021-03-15</time></div>
                    <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT MLM Finetune으로 Domain adaptation하기</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/12/04/Transformers4/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/image-20201204002610609.277ab6.png" alt="BertForSequenceClassification on Transformers v4.0.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-12-03T15:00:00.000Z">2020-12-04</time></div>
                    <a href="/2020/12/04/Transformers4/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BertForSequenceClassification on Transformers v4.0.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/NLP/">NLP</a> / <a class="has-link-grey -link" href="/categories/NLP/LanguageModel/">LanguageModel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/07/01/Review-the-Interview/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/typora/headway-5QgIuuBxKwM-unsplash.74d0f8.jpg" alt="면접에서 나온 통계 질문 리뷰">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-30T15:00:00.000Z">2020-07-01</time></div>
                    <a href="/2020/07/01/Review-the-Interview/" class="title has-link-black-ter is-size-6 has-text-weight-normal">면접에서 나온 통계 질문 리뷰</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/postmortem/">postmortem</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/Gitlab-for-LFS/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2020-05-27-12-22-58-KDTi9H.jpg" alt="딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-28T15:00:00.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/Gitlab-for-LFS/" class="title has-link-black-ter is-size-6 has-text-weight-normal">딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/DevEnv/">DevEnv</a> / <a class="has-link-grey -link" href="/categories/DevEnv/Git/">Git</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            아카이브
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/03/">
                <span class="level-start">
                    <span class="level-item">3월 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/12/">
                <span class="level-start">
                    <span class="level-item">12월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">7월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">5월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">2월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">1월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">12월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">10월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">7월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">6월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">11월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">3월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">2월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">1월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">12월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">11월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">10월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">9월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">8월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">7월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">6월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">4월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">3월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">2월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">1월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">12월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">11월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">9월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">8월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">7월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">6월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">5월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            최근 글
        </h3>
        
        <article class="media">
            
            <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/16/1*VZpuai6qP4iNLc7opAkQxA.jpeg" alt="KcBERT Finetune with PyTorch-Lightning v1.3.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-15T15:00:00.000Z">2021-03-16</time></div>
                    <a href="/2021/03/16/KcBERT-Downstream-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT Finetune with PyTorch-Lightning v1.3.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://cdn.jsdelivr.net/gh/beomi/blog-img@master/2021/03/15/fine-tuning_methods-20210315151211294.png" alt="KcBERT MLM Finetune으로 Domain adaptation하기">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-03-14T15:00:00.000Z">2021-03-15</time></div>
                    <a href="/2021/03/15/KcBERT-MLM-Finetune/" class="title has-link-black-ter is-size-6 has-text-weight-normal">KcBERT MLM Finetune으로 Domain adaptation하기</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/nlp/">nlp</a> / <a class="has-link-grey -link" href="/categories/nlp/languagemodel/">languagemodel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/12/04/Transformers4/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/image-20201204002610609.277ab6.png" alt="BertForSequenceClassification on Transformers v4.0.0">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-12-03T15:00:00.000Z">2020-12-04</time></div>
                    <a href="/2020/12/04/Transformers4/" class="title has-link-black-ter is-size-6 has-text-weight-normal">BertForSequenceClassification on Transformers v4.0.0</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/NLP/">NLP</a> / <a class="has-link-grey -link" href="/categories/NLP/LanguageModel/">LanguageModel</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/07/01/Review-the-Interview/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/typora/headway-5QgIuuBxKwM-unsplash.74d0f8.jpg" alt="면접에서 나온 통계 질문 리뷰">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-06-30T15:00:00.000Z">2020-07-01</time></div>
                    <a href="/2020/07/01/Review-the-Interview/" class="title has-link-black-ter is-size-6 has-text-weight-normal">면접에서 나온 통계 질문 리뷰</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/postmortem/">postmortem</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/05/29/Gitlab-for-LFS/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="https://d1sr4ybm5bj1wl.cloudfront.net/img/2020-05-27-12-22-58-KDTi9H.jpg" alt="딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-05-28T15:00:00.000Z">2020-05-29</time></div>
                    <a href="/2020/05/29/Gitlab-for-LFS/" class="title has-link-black-ter is-size-6 has-text-weight-normal">딥러닝 프로젝트 100% 재현을 위한 Git-LFS와 Gitlab</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/DevEnv/">DevEnv</a> / <a class="has-link-grey -link" href="/categories/DevEnv/Git/">Git</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            아카이브
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/03/">
                <span class="level-start">
                    <span class="level-item">3월 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/12/">
                <span class="level-start">
                    <span class="level-item">12월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">7월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/05/">
                <span class="level-start">
                    <span class="level-item">5월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">2월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">1월 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">12월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">10월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">7월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">6월 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/11/">
                <span class="level-start">
                    <span class="level-item">11월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/03/">
                <span class="level-start">
                    <span class="level-item">3월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/02/">
                <span class="level-start">
                    <span class="level-item">2월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/01/">
                <span class="level-start">
                    <span class="level-item">1월 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/12/">
                <span class="level-start">
                    <span class="level-item">12월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">11월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">10월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">9월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/08/">
                <span class="level-start">
                    <span class="level-item">8월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/07/">
                <span class="level-start">
                    <span class="level-item">7월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">7</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/06/">
                <span class="level-start">
                    <span class="level-item">6월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">4월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/03/">
                <span class="level-start">
                    <span class="level-item">3월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/02/">
                <span class="level-start">
                    <span class="level-item">2월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/01/">
                <span class="level-start">
                    <span class="level-item">1월 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/12/">
                <span class="level-start">
                    <span class="level-item">12월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">8</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/11/">
                <span class="level-start">
                    <span class="level-item">11월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/09/">
                <span class="level-start">
                    <span class="level-item">9월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">8월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/07/">
                <span class="level-start">
                    <span class="level-item">7월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/06/">
                <span class="level-start">
                    <span class="level-item">6월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/05/">
                <span class="level-start">
                    <span class="level-item">5월 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    Beomi&#39;s Tech Blog
                
                </a>
                <p class="is-size-7">
                &copy; 2021 Junbum Lee&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("ko");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://beomi.github.io',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Kembali ke atas" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>








<script src="/js/main.js" defer></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

    
</body>
</html>